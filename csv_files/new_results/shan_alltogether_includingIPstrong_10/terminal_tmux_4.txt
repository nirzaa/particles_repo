tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)





























tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
This is the 4 run
==================================================
rm: cannot remove './saved/models/new_model/*': No such file or directory
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)


























tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  4076
INFO:train:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
2024-02-14 00:24:33.794436: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Libra
ry (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-14 00:24:33.869265: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to f
loating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-02-14 00:24:33.885743: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plu
gin cuBLAS when one has already been registered
2024-02-14 00:24:35.529168: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: lib
nvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-1
1.7/lib64:/usr/local/cuda-11.8/lib64:/usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64::/home/student1/
anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/
2024-02-14 00:24:35.529214: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerr
or: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/us
r/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64:/usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64::/
home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/
2024-02-14 00:24:35.529218: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would li
ke to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
DEBUG:trainer:Train Epoch: 1 [1/40 (2%)] Loss: 377741.125000
DEBUG:trainer:Train Epoch: 1 [1/40 (2%)] Loss: 28916.302734
DEBUG:trainer:Train Epoch: 1 [1/40 (2%)] Loss: 3291.825928
INFO:trainer:    epoch          : 1
INFO:trainer:    loss           : 82654.7655829068
INFO:trainer:    bias_avg       : 7.642303475018205
INFO:trainer:    bias_std       : 209.36103518255825
INFO:trainer:    val_loss       : 1987.017506566541
INFO:trainer:    val_bias_avg   : 14.272421573770457
INFO:trainer:    val_bias_std   : 42.16279207426926
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch1.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 2 [2/40 (5%)] Loss: 1859.409058
DEBUG:trainer:Train Epoch: 2 [2/40 (5%)] Loss: 1474.553711
DEBUG:trainer:Train Epoch: 2 [2/40 (5%)] Loss: 807.640625
INFO:trainer:    epoch          : 2
INFO:trainer:    loss           : 1391.0035168877964
INFO:trainer:    bias_avg       : 4.562339355205667
INFO:trainer:    bias_std       : 35.62538877026788
INFO:trainer:    val_loss       : 673.043892695986
INFO:trainer:    val_bias_avg   : 0.8744036322780724
INFO:trainer:    val_bias_std   : 25.896849994001716
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch2.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 3 [3/40 (8%)] Loss: 674.701172
DEBUG:trainer:Train Epoch: 3 [3/40 (8%)] Loss: 345.040710
DEBUG:trainer:Train Epoch: 3 [3/40 (8%)] Loss: 261.212860
INFO:trainer:    epoch          : 3
INFO:trainer:    loss           : 359.135900037042
INFO:trainer:    bias_avg       : -0.13933261464638957
INFO:trainer:    bias_std       : 18.550091250189418
INFO:trainer:    val_loss       : 234.98590403589708
INFO:trainer:    val_bias_avg   : -0.010916883125901222
INFO:trainer:    val_bias_std   : 15.2693290381596
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch3.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 4 [4/40 (10%)] Loss: 197.695175
DEBUG:trainer:Train Epoch: 4 [4/40 (10%)] Loss: 235.586426
DEBUG:trainer:Train Epoch: 4 [4/40 (10%)] Loss: 203.472534
INFO:trainer:    epoch          : 4
INFO:trainer:    loss           : 236.1829597210062
INFO:trainer:    bias_avg       : -0.18218252885996883
INFO:trainer:    bias_std       : 15.293546676635742
INFO:trainer:    val_loss       : 235.9351859257139
INFO:trainer:    val_bias_avg   : -0.598068079044079
INFO:trainer:    val_bias_std   : 15.28829262174409
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch4.pth ...
DEBUG:trainer:Train Epoch: 5 [5/40 (12%)] Loss: 299.820404
DEBUG:trainer:Train Epoch: 5 [5/40 (12%)] Loss: 226.798630
DEBUG:trainer:Train Epoch: 5 [5/40 (12%)] Loss: 307.111755
INFO:trainer:    epoch          : 5
INFO:trainer:    loss           : 236.03263881288726
INFO:trainer:    bias_avg       : -0.03657854590886112
INFO:trainer:    bias_std       : 15.27510800854913
INFO:trainer:    val_loss       : 231.651908085264
INFO:trainer:    val_bias_avg   : -0.13633616959098085
INFO:trainer:    val_bias_std   : 15.166835324517612
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch5.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 6 [6/40 (15%)] Loss: 151.108307
DEBUG:trainer:Train Epoch: 6 [6/40 (15%)] Loss: 283.065369
DEBUG:trainer:Train Epoch: 6 [6/40 (15%)] Loss: 218.149231
INFO:trainer:    epoch          : 6
INFO:trainer:    loss           : 238.45062098009834
INFO:trainer:    bias_avg       : 0.001734602811007664
INFO:trainer:    bias_std       : 15.301334709956729
INFO:trainer:    val_loss       : 258.1841593775256
INFO:trainer:    val_bias_avg   : 2.155192884905585
INFO:trainer:    val_bias_std   : 15.855230232764935
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch6.pth ...
DEBUG:trainer:Train Epoch: 7 [7/40 (18%)] Loss: 326.476501
DEBUG:trainer:Train Epoch: 7 [7/40 (18%)] Loss: 361.921234
DEBUG:trainer:Train Epoch: 7 [7/40 (18%)] Loss: 186.785690
INFO:trainer:    epoch          : 7
INFO:trainer:    loss           : 247.12556352286504
INFO:trainer:    bias_avg       : 0.0660306638235162
INFO:trainer:    bias_std       : 15.54433589146055
INFO:trainer:    val_loss       : 259.4006042480469
INFO:trainer:    val_bias_avg   : -1.6242817558091263
INFO:trainer:    val_bias_std   : 15.966635112104745
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch7.pth ...
DEBUG:trainer:Train Epoch: 8 [8/40 (20%)] Loss: 278.376953
DEBUG:trainer:Train Epoch: 8 [8/40 (20%)] Loss: 212.853363
DEBUG:trainer:Train Epoch: 8 [8/40 (20%)] Loss: 177.815521
INFO:trainer:    epoch          : 8
INFO:trainer:    loss           : 232.46170727959995
INFO:trainer:    bias_avg       : 0.00815525060069972
INFO:trainer:    bias_std       : 15.144794595652613
INFO:trainer:    val_loss       : 222.54808623215249
INFO:trainer:    val_bias_avg   : 0.5757193570506984
INFO:trainer:    val_bias_std   : 14.820827352589575
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch8.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 9 [9/40 (22%)] Loss: 239.438202
DEBUG:trainer:Train Epoch: 9 [9/40 (22%)] Loss: 203.543457
DEBUG:trainer:Train Epoch: 9 [9/40 (22%)] Loss: 261.567444
INFO:trainer:    epoch          : 9
INFO:trainer:    loss           : 239.15210013554014
INFO:trainer:    bias_avg       : 0.06251042259150538
INFO:trainer:    bias_std       : 15.313254191957672
INFO:trainer:    val_loss       : 221.75197101461475
INFO:trainer:    val_bias_avg   : 0.7647129400023098
INFO:trainer:    val_bias_std   : 14.812105639227505
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch9.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 10 [10/40 (25%)] Loss: 230.034149
DEBUG:trainer:Train Epoch: 10 [10/40 (25%)] Loss: 180.193527
DEBUG:trainer:Train Epoch: 10 [10/40 (25%)] Loss: 463.388428
INFO:trainer:    epoch          : 10
INFO:trainer:    loss           : 310.8700708849677
INFO:trainer:    bias_avg       : 0.12678068927649794
INFO:trainer:    bias_std       : 17.142831868138806
INFO:trainer:    val_loss       : 325.5234227673761
INFO:trainer:    val_bias_avg   : -2.5969667763545594
INFO:trainer:    val_bias_std   : 17.76289647201012
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch10.pth ...
DEBUG:trainer:Train Epoch: 11 [11/40 (28%)] Loss: 388.382904
DEBUG:trainer:Train Epoch: 11 [11/40 (28%)] Loss: 335.851868
DEBUG:trainer:Train Epoch: 11 [11/40 (28%)] Loss: 278.826050
INFO:trainer:    epoch          : 11
INFO:trainer:    loss           : 290.34711693073143
INFO:trainer:    bias_avg       : -0.06387111441842441
INFO:trainer:    bias_std       : 16.713592299099627
INFO:trainer:    val_loss       : 236.09474339978448
INFO:trainer:    val_bias_avg   : -0.2816418509063279
INFO:trainer:    val_bias_std   : 15.298013259624613
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch11.pth ...
DEBUG:trainer:Train Epoch: 12 [12/40 (30%)] Loss: 223.728928
DEBUG:trainer:Train Epoch: 12 [12/40 (30%)] Loss: 270.618958
DEBUG:trainer:Train Epoch: 12 [12/40 (30%)] Loss: 218.460693
INFO:trainer:    epoch          : 12
INFO:trainer:    loss           : 243.05032243399785
INFO:trainer:    bias_avg       : 0.05622606865804771
INFO:trainer:    bias_std       : 15.454770745902225
INFO:trainer:    val_loss       : 238.53479582687905
INFO:trainer:    val_bias_avg   : -1.463818872797078
INFO:trainer:    val_bias_std   : 15.280917726714035
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch12.pth ...
DEBUG:trainer:Train Epoch: 13 [13/40 (32%)] Loss: 252.835938
DEBUG:trainer:Train Epoch: 13 [13/40 (32%)] Loss: 133.078461
DEBUG:trainer:Train Epoch: 13 [13/40 (32%)] Loss: 203.920776
INFO:trainer:    epoch          : 13
INFO:trainer:    loss           : 240.53476215231007
INFO:trainer:    bias_avg       : -0.06592278426577305
INFO:trainer:    bias_std       : 15.37071813386062
INFO:trainer:    val_loss       : 230.7979394320784
INFO:trainer:    val_bias_avg   : 0.044041686049052356
INFO:trainer:    val_bias_std   : 15.118363183120202
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch13.pth ...
DEBUG:trainer:Train Epoch: 14 [14/40 (35%)] Loss: 204.680954
DEBUG:trainer:Train Epoch: 14 [14/40 (35%)] Loss: 253.604218
DEBUG:trainer:Train Epoch: 14 [14/40 (35%)] Loss: 183.267563
INFO:trainer:    epoch          : 14
INFO:trainer:    loss           : 234.97594846528153
INFO:trainer:    bias_avg       : 0.09482132348007169
INFO:trainer:    bias_std       : 15.22689987051076
INFO:trainer:    val_loss       : 246.70173855485587
INFO:trainer:    val_bias_avg   : -1.762792706489563
INFO:trainer:    val_bias_std   : 15.546821923091494
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch14.pth ...
DEBUG:trainer:Train Epoch: 15 [15/40 (38%)] Loss: 225.098740
DEBUG:trainer:Train Epoch: 15 [15/40 (38%)] Loss: 512.084473
DEBUG:trainer:Train Epoch: 15 [15/40 (38%)] Loss: 239.360962
INFO:trainer:    epoch          : 15
INFO:trainer:    loss           : 276.65198490537443
INFO:trainer:    bias_avg       : -0.01198611177247146
INFO:trainer:    bias_std       : 16.280401887564825
INFO:trainer:    val_loss       : 222.30945823932515
INFO:trainer:    val_bias_avg   : 0.16781909205019474
INFO:trainer:    val_bias_std   : 14.867500897111563
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch15.pth ...
DEBUG:trainer:Train Epoch: 16 [16/40 (40%)] Loss: 194.256454
DEBUG:trainer:Train Epoch: 16 [16/40 (40%)] Loss: 171.354843
DEBUG:trainer:Train Epoch: 16 [16/40 (40%)] Loss: 223.491989
INFO:trainer:    epoch          : 16
INFO:trainer:    loss           : 210.02284240722656
INFO:trainer:    bias_avg       : -0.03360314402881817
INFO:trainer:    bias_std       : 14.426638471669165
INFO:trainer:    val_loss       : 209.65582433240166
INFO:trainer:    val_bias_avg   : -0.22162631001516148
INFO:trainer:    val_bias_std   : 14.429048702634613
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch16.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 17 [17/40 (42%)] Loss: 200.371399
DEBUG:trainer:Train Epoch: 17 [17/40 (42%)] Loss: 161.530685
DEBUG:trainer:Train Epoch: 17 [17/40 (42%)] Loss: 191.156052
INFO:trainer:    epoch          : 17
INFO:trainer:    loss           : 210.21657693797144
INFO:trainer:    bias_avg       : 0.017758129533894104
INFO:trainer:    bias_std       : 14.430884065299198
INFO:trainer:    val_loss       : 208.49872983735185
INFO:trainer:    val_bias_avg   : 0.29036501392818476
INFO:trainer:    val_bias_std   : 14.377977765839676
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch17.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 18 [18/40 (45%)] Loss: 187.150574
DEBUG:trainer:Train Epoch: 18 [18/40 (45%)] Loss: 159.324326
DEBUG:trainer:Train Epoch: 18 [18/40 (45%)] Loss: 173.249756
INFO:trainer:    epoch          : 18
INFO:trainer:    loss           : 208.1742706298828
INFO:trainer:    bias_avg       : 0.02707935657737584
INFO:trainer:    bias_std       : 14.377222751748972
INFO:trainer:    val_loss       : 208.49332454286773
INFO:trainer:    val_bias_avg   : -0.24401703701707825
INFO:trainer:    val_bias_std   : 14.385147818203631
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch18.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 19 [19/40 (48%)] Loss: 260.806122
DEBUG:trainer:Train Epoch: 19 [19/40 (48%)] Loss: 229.631454
DEBUG:trainer:Train Epoch: 19 [19/40 (48%)] Loss: 155.779343
INFO:trainer:    epoch          : 19
INFO:trainer:    loss           : 207.42974590433056
INFO:trainer:    bias_avg       : 0.030399672818020917
INFO:trainer:    bias_std       : 14.354479723963244
INFO:trainer:    val_loss       : 208.92707877323545
INFO:trainer:    val_bias_avg   : -0.22581308707594872
INFO:trainer:    val_bias_std   : 14.391150934942837
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch19.pth ...
DEBUG:trainer:Train Epoch: 20 [20/40 (50%)] Loss: 249.454208
DEBUG:trainer:Train Epoch: 20 [20/40 (50%)] Loss: 168.180511
DEBUG:trainer:Train Epoch: 20 [20/40 (50%)] Loss: 237.609558
INFO:trainer:    epoch          : 20
INFO:trainer:    loss           : 209.39534470130658
INFO:trainer:    bias_avg       : 0.0037387073810758262
INFO:trainer:    bias_std       : 14.426226747447046
INFO:trainer:    val_loss       : 209.08230643436826
INFO:trainer:    val_bias_avg   : -0.41607100490866034
INFO:trainer:    val_bias_std   : 14.403532159739527
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch20.pth ...
DEBUG:trainer:Train Epoch: 21 [21/40 (52%)] Loss: 255.529175
DEBUG:trainer:Train Epoch: 21 [21/40 (52%)] Loss: 200.289474
DEBUG:trainer:Train Epoch: 21 [21/40 (52%)] Loss: 187.833420
INFO:trainer:    epoch          : 21
INFO:trainer:    loss           : 208.22294037917564
INFO:trainer:    bias_avg       : 0.004546058781701943
INFO:trainer:    bias_std       : 14.373666697535022
INFO:trainer:    val_loss       : 209.50789879108297
INFO:trainer:    val_bias_avg   : -0.4854629634526269
INFO:trainer:    val_bias_std   : 14.414697120929587
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch21.pth ...
DEBUG:trainer:Train Epoch: 22 [22/40 (55%)] Loss: 121.039299
DEBUG:trainer:Train Epoch: 22 [22/40 (55%)] Loss: 155.057373
DEBUG:trainer:Train Epoch: 22 [22/40 (55%)] Loss: 213.235947
INFO:trainer:    epoch          : 22
INFO:trainer:    loss           : 210.10841922102304
INFO:trainer:    bias_avg       : -0.01400437058302863
INFO:trainer:    bias_std       : 14.41594281689874
INFO:trainer:    val_loss       : 207.37997304982153
INFO:trainer:    val_bias_avg   : 0.2160460667986752
INFO:trainer:    val_bias_std   : 14.344083292730923
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch22.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 23 [23/40 (58%)] Loss: 226.751160
DEBUG:trainer:Train Epoch: 23 [23/40 (58%)] Loss: 181.061127
DEBUG:trainer:Train Epoch: 23 [23/40 (58%)] Loss: 212.609619
INFO:trainer:    epoch          : 23
INFO:trainer:    loss           : 210.0738983154297
INFO:trainer:    bias_avg       : 0.028312346287842453
INFO:trainer:    bias_std       : 14.427384343640558
INFO:trainer:    val_loss       : 211.77799566860855
INFO:trainer:    val_bias_avg   : 0.7112672041202414
INFO:trainer:    val_bias_std   : 14.483375812398977
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch23.pth ...
DEBUG:trainer:Train Epoch: 24 [24/40 (60%)] Loss: 208.004059
DEBUG:trainer:Train Epoch: 24 [24/40 (60%)] Loss: 195.317200
DEBUG:trainer:Train Epoch: 24 [24/40 (60%)] Loss: 160.700836
INFO:trainer:    epoch          : 24
INFO:trainer:    loss           : 209.68549741547685
INFO:trainer:    bias_avg       : -0.028860759632340794
INFO:trainer:    bias_std       : 14.443674613689554
INFO:trainer:    val_loss       : 206.02867652629985
INFO:trainer:    val_bias_avg   : -0.2741079194920844
INFO:trainer:    val_bias_std   : 14.269125543791672
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch24.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 25 [25/40 (62%)] Loss: 224.407928
DEBUG:trainer:Train Epoch: 25 [25/40 (62%)] Loss: 204.209396
DEBUG:trainer:Train Epoch: 25 [25/40 (62%)] Loss: 233.889008
INFO:trainer:    epoch          : 25
INFO:trainer:    loss           : 208.74579278353988
INFO:trainer:    bias_avg       : 0.006642385755248111
INFO:trainer:    bias_std       : 14.396455929197113
INFO:trainer:    val_loss       : 207.0441657756937
INFO:trainer:    val_bias_avg   : 0.060293497325017535
INFO:trainer:    val_bias_std   : 14.345496407870588
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch25.pth ...
DEBUG:trainer:Train Epoch: 26 [26/40 (65%)] Loss: 192.368027
DEBUG:trainer:Train Epoch: 26 [26/40 (65%)] Loss: 178.541672
DEBUG:trainer:Train Epoch: 26 [26/40 (65%)] Loss: 195.817963
INFO:trainer:    epoch          : 26
INFO:trainer:    loss           : 208.80909886853448
INFO:trainer:    bias_avg       : 0.04622936450298233
INFO:trainer:    bias_std       : 14.402507781982422
INFO:trainer:    val_loss       : 209.2452182112069
INFO:trainer:    val_bias_avg   : 0.16297644420510865
INFO:trainer:    val_bias_std   : 14.400731514240134
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch26.pth ...
DEBUG:trainer:Train Epoch: 27 [27/40 (68%)] Loss: 150.818329
DEBUG:trainer:Train Epoch: 27 [27/40 (68%)] Loss: 262.205566
DEBUG:trainer:Train Epoch: 27 [27/40 (68%)] Loss: 214.373260
INFO:trainer:    epoch          : 27
INFO:trainer:    loss           : 212.08692142881196
INFO:trainer:    bias_avg       : -0.07781850315373519
INFO:trainer:    bias_std       : 14.5057818642978
INFO:trainer:    val_loss       : 216.51696987809805
INFO:trainer:    val_bias_avg   : 0.8848994754511734
INFO:trainer:    val_bias_std   : 14.649844531355233
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch27.pth ...
DEBUG:trainer:Train Epoch: 28 [28/40 (70%)] Loss: 239.924362
DEBUG:trainer:Train Epoch: 28 [28/40 (70%)] Loss: 172.780243
DEBUG:trainer:Train Epoch: 28 [28/40 (70%)] Loss: 229.905807
INFO:trainer:    epoch          : 28
INFO:trainer:    loss           : 211.43326226596176
INFO:trainer:    bias_avg       : 0.0831077409715488
INFO:trainer:    bias_std       : 14.478671172569538
INFO:trainer:    val_loss       : 205.06108935125943
INFO:trainer:    val_bias_avg   : -0.20061955485364485
INFO:trainer:    val_bias_std   : 14.263437534200735
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch28.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 29 [29/40 (72%)] Loss: 178.410767
DEBUG:trainer:Train Epoch: 29 [29/40 (72%)] Loss: 239.783356
DEBUG:trainer:Train Epoch: 29 [29/40 (72%)] Loss: 243.931030
INFO:trainer:    epoch          : 29
INFO:trainer:    loss           : 208.2199759647764
INFO:trainer:    bias_avg       : -0.03295280476068628
INFO:trainer:    bias_std       : 14.392159100236563
INFO:trainer:    val_loss       : 212.2258811161436
INFO:trainer:    val_bias_avg   : 0.9025830914234293
INFO:trainer:    val_bias_std   : 14.483405869582604
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch29.pth ...
DEBUG:trainer:Train Epoch: 30 [30/40 (75%)] Loss: 259.005219
DEBUG:trainer:Train Epoch: 30 [30/40 (75%)] Loss: 176.093552
DEBUG:trainer:Train Epoch: 30 [30/40 (75%)] Loss: 275.380096
INFO:trainer:    epoch          : 30
INFO:trainer:    loss           : 208.3656111092403
INFO:trainer:    bias_avg       : 0.05655790613321909
INFO:trainer:    bias_std       : 14.376074199018808
INFO:trainer:    val_loss       : 206.6805191040039
INFO:trainer:    val_bias_avg   : -0.33339233844187754
INFO:trainer:    val_bias_std   : 14.299041550734948
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch30.pth ...
DEBUG:trainer:Train Epoch: 31 [31/40 (78%)] Loss: 224.797531
DEBUG:trainer:Train Epoch: 31 [31/40 (78%)] Loss: 190.516754
DEBUG:trainer:Train Epoch: 31 [31/40 (78%)] Loss: 185.519562
INFO:trainer:    epoch          : 31
INFO:trainer:    loss           : 204.31366387728988
INFO:trainer:    bias_avg       : -0.030438030636387652
INFO:trainer:    bias_std       : 14.232786441671438
INFO:trainer:    val_loss       : 204.3571698418979
INFO:trainer:    val_bias_avg   : 0.0896438674294743
INFO:trainer:    val_bias_std   : 14.217609076664365
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch31.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 32 [32/40 (80%)] Loss: 231.125854
DEBUG:trainer:Train Epoch: 32 [32/40 (80%)] Loss: 226.685898
DEBUG:trainer:Train Epoch: 32 [32/40 (80%)] Loss: 164.701813
INFO:trainer:    epoch          : 32
INFO:trainer:    loss           : 203.81289409768993
INFO:trainer:    bias_avg       : 0.011208707450664249
INFO:trainer:    bias_std       : 14.243889874425427
INFO:trainer:    val_loss       : 203.6107601297313
INFO:trainer:    val_bias_avg   : -0.025076474303957718
INFO:trainer:    val_bias_std   : 14.206283733762543
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch32.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 33 [33/40 (82%)] Loss: 202.810455
DEBUG:trainer:Train Epoch: 33 [33/40 (82%)] Loss: 139.807129
DEBUG:trainer:Train Epoch: 33 [33/40 (82%)] Loss: 225.622650
INFO:trainer:    epoch          : 33
INFO:trainer:    loss           : 203.42849731445312
INFO:trainer:    bias_avg       : -0.017551692652291263
INFO:trainer:    bias_std       : 14.205165567069217
INFO:trainer:    val_loss       : 203.34112075279498
INFO:trainer:    val_bias_avg   : 0.024345485365082478
INFO:trainer:    val_bias_std   : 14.195435589757459
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch33.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 34 [34/40 (85%)] Loss: 187.406662
DEBUG:trainer:Train Epoch: 34 [34/40 (85%)] Loss: 190.326141
DEBUG:trainer:Train Epoch: 34 [34/40 (85%)] Loss: 245.554611
INFO:trainer:    epoch          : 34
INFO:trainer:    loss           : 203.91317065008755
INFO:trainer:    bias_avg       : 0.04480621008330892
INFO:trainer:    bias_std       : 14.231266942517511
INFO:trainer:    val_loss       : 203.19543141332167
INFO:trainer:    val_bias_avg   : -0.2021639592485685
INFO:trainer:    val_bias_std   : 14.211686726274161
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch34.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 35 [35/40 (88%)] Loss: 194.419968
DEBUG:trainer:Train Epoch: 35 [35/40 (88%)] Loss: 192.567795
DEBUG:trainer:Train Epoch: 35 [35/40 (88%)] Loss: 255.041565
INFO:trainer:    epoch          : 35
INFO:trainer:    loss           : 203.78039866480333
INFO:trainer:    bias_avg       : -0.03237965659655888
INFO:trainer:    bias_std       : 14.213991559784988
INFO:trainer:    val_loss       : 204.07166421824488
INFO:trainer:    val_bias_avg   : 0.009779480671317413
INFO:trainer:    val_bias_std   : 14.217672939958243
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch35.pth ...
DEBUG:trainer:Train Epoch: 36 [36/40 (90%)] Loss: 255.242661
DEBUG:trainer:Train Epoch: 36 [36/40 (90%)] Loss: 179.413986
DEBUG:trainer:Train Epoch: 36 [36/40 (90%)] Loss: 152.885452
INFO:trainer:    epoch          : 36
INFO:trainer:    loss           : 203.8728369351091
INFO:trainer:    bias_avg       : 0.05755190255826917
INFO:trainer:    bias_std       : 14.239023964980554
INFO:trainer:    val_loss       : 203.21198983028017
INFO:trainer:    val_bias_avg   : -0.25174784037316666
INFO:trainer:    val_bias_std   : 14.199789639176993
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch36.pth ...
DEBUG:trainer:Train Epoch: 37 [37/40 (92%)] Loss: 178.593842
DEBUG:trainer:Train Epoch: 37 [37/40 (92%)] Loss: 207.525482
DEBUG:trainer:Train Epoch: 37 [37/40 (92%)] Loss: 183.267624
INFO:trainer:    epoch          : 37
INFO:trainer:    loss           : 203.90895027949892
INFO:trainer:    bias_avg       : -0.007737865559114465
INFO:trainer:    bias_std       : 14.252519245805411
INFO:trainer:    val_loss       : 203.1740449050377
INFO:trainer:    val_bias_avg   : 0.12717312255649474
INFO:trainer:    val_bias_std   : 14.207499931598532
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch37.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 38 [38/40 (95%)] Loss: 194.466599
DEBUG:trainer:Train Epoch: 38 [38/40 (95%)] Loss: 178.493210
DEBUG:trainer:Train Epoch: 38 [38/40 (95%)] Loss: 239.064438
INFO:trainer:    epoch          : 38
INFO:trainer:    loss           : 203.53869155357623
INFO:trainer:    bias_avg       : -0.027080266190500094
INFO:trainer:    bias_std       : 14.22819186901224
INFO:trainer:    val_loss       : 203.57511533539872
INFO:trainer:    val_bias_avg   : -0.04646549874852444
INFO:trainer:    val_bias_std   : 14.239553747505978
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch38.pth ...
DEBUG:trainer:Train Epoch: 39 [39/40 (98%)] Loss: 228.629456
DEBUG:trainer:Train Epoch: 39 [39/40 (98%)] Loss: 233.616501
DEBUG:trainer:Train Epoch: 39 [39/40 (98%)] Loss: 215.319580
INFO:trainer:    epoch          : 39
INFO:trainer:    loss           : 202.68261613516972
INFO:trainer:    bias_avg       : 0.036632584151009034
INFO:trainer:    bias_std       : 14.161352881069842
INFO:trainer:    val_loss       : 201.99468310125943
INFO:trainer:    val_bias_avg   : 0.04106898823399739
INFO:trainer:    val_bias_std   : 14.117347059578732
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch39.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 40 [40/40 (100%)] Loss: 184.431198
DEBUG:trainer:Train Epoch: 40 [40/40 (100%)] Loss: 177.928894
DEBUG:trainer:Train Epoch: 40 [40/40 (100%)] Loss: 226.820068
INFO:trainer:    epoch          : 40
INFO:trainer:    loss           : 203.3576854837352
INFO:trainer:    bias_avg       : -0.028252479180709684
INFO:trainer:    bias_std       : 14.220299589222876
INFO:trainer:    val_loss       : 203.69785782386518
INFO:trainer:    val_bias_avg   : -0.041311846363583
INFO:trainer:    val_bias_std   : 14.201563604946795
INFO:trainer:Saving checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch40.pth ...
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)

tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
Working on epoch num: 1...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch1.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.05s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.32s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -96762197.032, Bias: 9686886.732
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16054.388', '68606.508', '126810.201', '227165.625', '339566.067', '446434.325', '501129.111', '527469.791', '534503.274', '522490.918', '518
042.234', '504123.228', '469109.874', '424330.707', '375419.386', '311673.273', '273140.773', '236028.253', '198812.789', '163685.482', '135640.069', '121
256.316', '106430.498', '102261.861', '85681.210', '76754.612', '55313.870', '23512.685', '30076.554', '26800.582', '17728.940', '15024.279', '7313.167',
'6080.418', '-2090.518', '4525.688', '2444.705', '-3136.712', '-1280.164', '5938.709', '4571.047', '-857.402', '5759.247', '-5385.143', '-2321.542', '6006
.685', '2264.833', '1833.535']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 7612744.236047627, target N: 8329784.0
Mean E: 4.263259276099101, target E: 4.311618393706248
INFO:test:{'loss': 1977.5228156481921, 'bias_avg': 14.659792075564278, 'bias_std': 41.98294130274779}
Working on epoch num: 10...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch10.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.15s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.36s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -108178578.187, Bias: -1729494.423
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15960.088', '58095.535', '138454.426', '252112.341', '365727.765', '458132.249', '528133.248', '565255.198', '587449.195', '586096.176', '570
258.985', '540351.270', '506674.697', '459402.578', '425797.128', '376615.510', '329268.568', '290689.418', '250296.686', '214783.370', '182868.307', '154
600.930', '125459.962', '103095.777', '82969.900', '67053.747', '54341.709', '42729.580', '32809.428', '24375.194', '19612.750', '18058.100', '5255.069',
'7001.401', '2774.867', '4211.754', '2038.810', '1225.105', '2114.652', '643.219', '339.925', '-6837.601', '269.543', '-37.351', '26.563', '-13.593', '-74
44.031', '1839.553']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8440937.701462988, target N: 8329784.0
Mean E: 4.294727226269883, target E: 4.311618393706248
INFO:test:{'loss': 293.64579241362355, 'bias_avg': -2.272524188849362, 'bias_std': 16.983861322374878}
Working on epoch num: 11...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch11.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.13s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.35s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106699588.649, Bias: -250504.885
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['10522.747', '54916.913', '133274.172', '248406.261', '356074.749', '455125.946', '518547.540', '555755.837', '579028.583', '578451.098', '559
444.862', '539009.110', '501257.357', '461278.677', '421929.733', '375681.508', '329807.254', '287638.824', '252031.269', '213801.474', '178974.523', '147
489.873', '126175.975', '99025.416', '82945.171', '67245.119', '51265.489', '40772.522', '31835.422', '25315.331', '18770.273', '11623.418', '6654.351', '
6615.430', '3869.390', '1355.370', '2307.343', '1259.261', '3668.366', '966.000', '233.346', '3174.771', '213.000', '-50.712', '-66.613', '88.020', '-8140
.462', '2274.002']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8337843.307669709, target N: 8329784.0
Mean E: 4.305488150081713, target E: 4.311618393706248
INFO:test:{'loss': 218.24424424700226, 'bias_avg': -0.1647715919502116, 'bias_std': 14.768893944737489}
Working on epoch num: 12...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch12.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.08s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.34s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -107272190.572, Bias: -823106.808
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['17478.391', '55453.444', '135601.059', '246258.048', '360850.180', '455406.468', '518694.155', '562234.583', '578405.797', '575715.752', '568
377.150', '535595.223', '499588.869', '461343.513', '417568.578', '370369.118', '332470.709', '293177.415', '249049.313', '213162.876', '182410.688', '153
521.199', '125823.209', '104237.668', '86080.276', '71323.800', '54066.072', '43826.880', '33253.579', '24367.894', '20675.887', '12846.723', '7767.268',
'8072.559', '5263.830', '2663.591', '2452.909', '513.896', '1261.749', '361.817', '330.089', '-1262.195', '128.991', '24.017', '-69.843', '93.930', '3417.
403', '915.965']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8391170.490738261, target N: 8329784.0
Mean E: 4.321570068315992, target E: 4.311618393706248
INFO:test:{'loss': 213.84896344455348, 'bias_avg': -1.2550393835485156, 'bias_std': 14.56749493989205}
Working on epoch num: 13...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch13.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.08s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.32s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106311999.470, Bias: 137084.294
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['13957.699', '52110.649', '133597.280', '244918.041', '357329.954', '457449.919', '518434.451', '554170.325', '574139.985', '577374.660', '557
869.471', '536259.569', '500449.642', '457425.887', '414245.588', '372456.980', '330444.084', '284761.222', '246278.839', '211099.857', '179892.271', '152
810.373', '122797.537', '99480.311', '80670.968', '64994.828', '51194.632', '38887.911', '32130.610', '26554.102', '20231.979', '14035.312', '10975.358',
'6626.590', '6313.404', '2698.324', '2174.595', '1847.368', '8879.957', '-39.701', '413.419', '343.700', '60.543', '62.368', '39.489', '79.880', '234.638'
, '2915.620']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8322080.486940297, target N: 8329784.0
Mean E: 4.319479204257783, target E: 4.311618393706248
INFO:test:{'loss': 214.5240470429515, 'bias_avg': 0.1574974172365677, 'bias_std': 14.64302855127576}
Working on epoch num: 14...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch14.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.20s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.38s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -107465305.361, Bias: -1016221.597
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14522.509', '52579.438', '135735.092', '248290.559', '360759.036', '461353.068', '517216.697', '557965.831', '577248.082', '576512.391', '565
009.211', '543578.176', '503480.303', '461259.358', '418718.370', '380782.580', '333340.121', '289759.352', '253241.539', '212754.774', '182264.205', '154
575.024', '124620.131', '105225.482', '84521.681', '65186.855', '53688.080', '45327.814', '35746.715', '22231.609', '19153.605', '14907.494', '10365.273',
 '4896.681', '5604.170', '3413.747', '1855.695', '1856.247', '1906.666', '442.255', '243.808', '309.569', '91.343', '84.754', '-24.340', '122.016', '-67.8
57', '2141.544']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8404796.75723962, target N: 8329784.0
Mean E: 4.320993718154447, target E: 4.311618393706248
INFO:test:{'loss': 226.05956716790166, 'bias_avg': -1.5336268371641928, 'bias_std': 14.953213168547595}
Working on epoch num: 15...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch15.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.07s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.33s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106238308.028, Bias: 210775.737
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15495.844', '54747.695', '136435.473', '245466.588', '359892.024', '448664.117', '514590.472', '552762.688', '573660.102', '574429.724', '554
078.853', '531734.961', '498416.368', '461066.218', '414798.836', '372929.700', '326140.899', '287180.578', '248232.580', '211631.653', '180768.593', '152
605.886', '125589.792', '103003.357', '84336.077', '66515.236', '53404.051', '42490.729', '32208.859', '25721.942', '17344.004', '17679.730', '3372.320',
'6687.420', '5084.724', '6315.917', '2396.157', '1980.749', '4116.149', '1125.455', '-145.993', '125.841', '112.477', '-198.213', '10.104', '-107.554', '-
47.024', '2275.041']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8317127.199407333, target N: 8329784.0
Mean E: 4.320715157133589, target E: 4.311618393706248
INFO:test:{'loss': 208.40631750404424, 'bias_avg': 0.25876678077465654, 'bias_std': 14.430361222706084}
Working on epoch num: 16...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch16.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.07s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.33s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106536544.798, Bias: -87461.034
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15020.246', '54389.075', '135560.076', '247027.029', '360779.965', '452947.715', '517447.186', '557106.238', '577797.422', '576763.095', '561
413.997', '533900.740', '500089.336', '461376.160', '416280.928', '374544.231', '328624.017', '285587.575', '247918.651', '212173.625', '178417.565', '148
802.759', '125446.802', '101108.351', '83923.691', '67212.998', '53301.221', '41712.540', '31835.881', '23593.203', '18753.522', '14402.271', '8332.765',
'7051.017', '4586.359', '2957.500', '2113.893', '1327.595', '1174.962', '174.628', '-3.941', '133.112', '42.163', '-90.258', '-6.818', '10.675', '3.328',
'1796.720']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8334861.810445303, target N: 8329784.0
Mean E: 4.310157618269467, target E: 4.311618393706248
INFO:test:{'loss': 193.31644182888402, 'bias_avg': -0.10381523034991413, 'bias_std': 13.9008525515211}
Working on epoch num: 17...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch17.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.11s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.34s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106211275.703, Bias: 237808.062
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['13972.126', '54698.917', '136560.557', '247477.026', '360533.689', '452007.070', '515391.776', '553702.654', '572200.684', '575112.564', '558
850.104', '531735.585', '497081.008', '455933.061', '415156.050', '373506.671', '328765.453', '288213.185', '247892.363', '213803.320', '178498.274', '150
525.830', '124104.119', '102354.333', '83462.825', '67162.842', '53365.036', '42356.315', '31983.202', '23772.227', '18401.478', '13450.346', '9349.643',
'6608.583', '4708.288', '2973.686', '1846.943', '1159.010', '723.729', '403.572', '183.809', '147.328', '-0.340', '-57.048', '5.454', '-1.534', '16.404',
'2029.621']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8312127.836773861, target N: 8329784.0
Mean E: 4.312434720440883, target E: 4.311618393706248
INFO:test:{'loss': 194.3987292139055, 'bias_avg': 0.3609781461796185, 'bias_std': 13.934923945044162}
Working on epoch num: 18...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch18.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.01s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.29s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106548028.342, Bias: -98944.577
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14419.720', '55416.782', '137017.202', '246848.906', '360470.354', '453610.513', '514889.129', '559022.060', '576772.597', '576404.397', '559
938.218', '533741.816', '502029.942', '458619.693', '416684.283', '370746.598', '328482.098', '287533.603', '249783.598', '212760.859', '181380.024', '149
695.240', '125687.159', '102341.924', '82440.410', '66844.947', '53011.425', '41610.605', '31705.311', '24583.170', '18307.462', '12726.532', '9841.346',
'6015.932', '4837.525', '3120.355', '1970.500', '1088.470', '664.787', '596.138', '154.101', '139.876', '33.198', '-27.221', '9.060', '-1.757', '-6.392',
'2159.320']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8336121.814330642, target N: 8329784.0
Mean E: 4.310376717660244, target E: 4.311618393706248
INFO:test:{'loss': 192.06249540289673, 'bias_avg': -0.12957585477969363, 'bias_std': 13.855002990063788}
Working on epoch num: 19...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch19.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.22s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.40s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106534940.213, Bias: -85856.448
KL dist - KL1(q=target): 6425.207, KL2(q=output): -5496.478, Symmetric: 928.730
total out: ['13941.982', '54675.738', '137657.063', '245779.965', '361848.160', '452818.020', '515171.330', '558239.524', '576006.743', '574128.727', '558
197.058', '533599.888', '501516.207', '458527.377', '415708.601', '371873.788', '330628.395', '287661.965', '248870.450', '212795.298', '179682.826', '150
677.957', '126609.695', '102333.307', '84585.539', '67237.875', '54539.956', '41506.958', '33631.346', '24458.809', '18057.717', '12903.426', '9469.958',
'6704.051', '4273.495', '3012.068', '1869.826', '1184.596', '819.860', '471.098', '70.049', '13.498', '66.808', '16.626', '29.936', '1.674', '0.938', '187
6.877']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8335753.0482867425, target N: 8329784.0
Mean E: 4.313753802463463, target E: 4.311618393706248
INFO:test:{'loss': 192.68994886344035, 'bias_avg': -0.12203647811934572, 'bias_std': 13.877401634568205}
Working on epoch num: 2...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch2.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.13s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.36s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -105754231.209, Bias: 694852.556
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15445.829', '57623.730', '139287.537', '246495.618', '363188.518', '453500.814', '510612.484', '551370.109', '575160.605', '574935.858', '556
965.992', '529881.436', '496417.650', '462325.937', '422040.145', '364866.517', '324082.038', '282689.025', '250742.774', '207220.629', '176076.049', '146
410.208', '125361.941', '105523.929', '85032.772', '66073.679', '47737.968', '34068.956', '30718.269', '20459.306', '12620.885', '14811.725', '7272.738',
'3961.794', '3332.852', '2224.907', '1229.318', '2198.918', '523.776', '-747.694', '642.797', '1328.415', '-1310.089', '-31.288', '-1691.780', '-263.004',
 '-476.760', '1473.019']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8269416.847132545, target N: 8329784.0
Mean E: 4.28907266453432, target E: 4.311618393706248
INFO:test:{'loss': 677.1177069876449, 'bias_avg': 1.2341993816701422, 'bias_std': 25.99201499631992}
Working on epoch num: 20...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch20.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.02s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.31s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106640039.023, Bias: -190955.259
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14948.357', '54497.767', '136529.419', '248212.875', '361033.888', '453385.007', '518792.924', '557023.610', '576344.185', '576700.274', '559
687.621', '534052.770', '500744.211', '460273.730', '415370.993', '372649.805', '330011.819', '287877.395', '248578.235', '212326.861', '180087.511', '149
602.245', '126587.572', '102874.997', '83588.565', '66548.651', '52824.039', '42295.057', '31852.057', '24433.831', '17891.778', '14296.567', '9891.604',
'6455.314', '4898.753', '3073.786', '2373.108', '1395.229', '817.454', '603.878', '258.638', '146.147', '64.248', '-6.984', '0.578', '-10.055', '-9.706',
'1791.046']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8343667.651958974, target N: 8329784.0
Mean E: 4.312585691893959, target E: 4.311618393706248
INFO:test:{'loss': 191.50455869425736, 'bias_avg': -0.28384959452051645, 'bias_std': 13.832946477858194}
Working on epoch num: 21...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch21.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.07s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.33s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106679357.727, Bias: -230273.963
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['13384.237', '55597.505', '137477.926', '247518.988', '364200.664', '452764.959', '516078.148', '556526.218', '575025.168', '576399.768', '561
985.669', '535605.973', '497473.798', '459417.574', '414927.437', '373211.880', '329268.877', '286902.462', '249123.804', '211796.041', '180799.944', '152
726.760', '125827.078', '103536.229', '84346.713', '67250.862', '54056.333', '42790.812', '32338.893', '24715.132', '18477.191', '14616.558', '9408.404',
'6920.253', '4939.357', '2932.758', '1988.600', '1298.827', '516.669', '307.014', '227.914', '159.325', '38.442', '-1.781', '-16.437', '2.017', '-14.215',
 '2192.061']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8347068.8082361715, target N: 8329784.0
Mean E: 4.314476217767685, target E: 4.311618393706248
INFO:test:{'loss': 192.39876989901828, 'bias_avg': -0.35338585790871874, 'bias_std': 13.863647341143277}
Working on epoch num: 22...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch22.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.03s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.30s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106240295.096, Bias: 208788.668
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14725.098', '55226.609', '136630.132', '244654.669', '359423.014', '452015.769', '516424.824', '554920.410', '574255.688', '574345.632', '559
373.966', '534459.753', '497106.434', '457613.754', '415018.313', '371650.012', '326424.989', '287309.821', '247528.743', '211445.312', '178719.154', '150
862.136', '124924.407', '102870.847', '82576.135', '66687.593', '53361.581', '41766.166', '32889.324', '24800.972', '18809.126', '13216.141', '9795.910',
'6929.265', '5207.966', '3943.802', '2043.203', '1503.019', '942.254', '425.516', '135.320', '93.793', '56.660', '6.177', '11.437', '-1.020', '26.603', '2
381.930']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8315538.358338453, target N: 8329784.0
Mean E: 4.31405864048515, target E: 4.311618393706248
INFO:test:{'loss': 192.91724155414795, 'bias_avg': 0.291250451624218, 'bias_std': 13.882431075196271}
Working on epoch num: 23...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch23.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.05s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in multiply
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.31s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -105943022.263, Bias: 506061.501
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14317.479', '54607.936', '134400.374', '246518.789', '359576.500', '448545.000', '514001.504', '551313.236', '571242.730', '572147.936', '558
413.777', '530942.966', '497551.770', '455380.139', '416043.009', '372422.893', '327739.398', '286561.821', '248514.432', '211899.918', '179189.230', '149
095.032', '124803.699', '103217.627', '83682.803', '67939.168', '53473.468', '41456.744', '31537.059', '23937.656', '17992.575', '13773.781', '10160.881',
 '6644.393', '4869.340', '2799.082', '1984.767', '1243.690', '635.987', '261.861', '273.807', '70.286', '18.718', '12.730', '10.969', '-4.937', '-15.868',
 '1750.369']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8292956.525433862, target N: 8329784.0
Mean E: 4.315173441850609, target E: 4.311618393706248
INFO:test:{'loss': 197.51183890360494, 'bias_avg': 0.7529332813266683, 'bias_std': 14.030363522755152}
Working on epoch num: 24...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch24.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:11<00:11, 11.91s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.24s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106556025.971, Bias: -106942.207
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15436.112', '54526.547', '136027.436', '247821.741', '361879.227', '452329.630', '517131.282', '556304.844', '577685.564', '575590.159', '561
277.197', '534338.578', '498901.826', '458473.673', '417910.815', '373292.067', '328782.595', '287341.754', '248454.171', '210450.799', '180158.331', '151
105.269', '124153.695', '103044.913', '83361.001', '66482.788', '52321.434', '41495.423', '31883.605', '25289.153', '18882.657', '13948.092', '9133.246',
'7186.925', '4489.770', '3173.619', '2415.130', '1518.377', '715.559', '518.949', '186.176', '151.137', '52.430', '14.084', '-5.726', '-29.496', '-4.193',
 '1925.605']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8337523.967857425, target N: 8329784.0
Mean E: 4.311837821125358, target E: 4.311618393706248
INFO:test:{'loss': 190.3987828068457, 'bias_avg': -0.15824271699046247, 'bias_std': 13.794708162107458}
Working on epoch num: 25...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch25.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.10s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.34s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106342278.690, Bias: 106805.075
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14882.669', '55385.095', '137493.204', '247900.293', '361497.413', '452662.223', '517345.124', '556354.304', '574856.365', '574090.330', '557
391.734', '534324.405', '498493.536', '457519.814', '413908.325', '372278.416', '326742.593', '285570.350', '248310.264', '212483.319', '179674.996', '149
818.429', '124369.877', '102925.388', '84187.763', '68047.037', '52910.419', '40636.974', '32112.311', '24188.500', '18119.461', '13576.749', '10049.317',
 '6807.562', '4637.486', '3206.636', '2379.533', '1381.888', '782.832', '454.673', '337.078', '-0.888', '35.413', '14.897', '3.320', '10.932', '2.592', '2
315.660']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8322476.6133276485, target N: 8329784.0
Mean E: 4.310697525988789, target E: 4.311618393706248
INFO:test:{'loss': 191.08233485348208, 'bias_avg': 0.14939863899388187, 'bias_std': 13.8188213015211}
Working on epoch num: 26...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch26.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in multiply
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.04s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.31s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106338937.448, Bias: 110146.317
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14077.123', '55753.735', '137451.922', '247749.017', '362389.727', '453170.434', '517006.589', '556443.308', '579003.564', '574812.720', '559
831.208', '534387.978', '499927.759', '457236.704', '415654.080', '372700.868', '327514.160', '286090.997', '247701.481', '211214.985', '179195.123', '150
165.268', '125114.874', '100128.884', '82019.134', '66381.419', '51922.691', '40776.068', '32556.372', '23255.732', '18072.827', '12298.583', '8190.260',
'6058.614', '3927.974', '2326.662', '1595.774', '1140.259', '271.085', '311.605', '-310.382', '173.109', '76.858', '-307.447', '99.059', '-301.595', '324.
060', '2246.697']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8317827.921621957, target N: 8329784.0
Mean E: 4.301648891344816, target E: 4.311618393706248
INFO:test:{'loss': 192.0536017450664, 'bias_avg': 0.24444058973258095, 'bias_std': 13.853485916032875}
Working on epoch num: 27...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch27.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.14s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.36s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -105806688.722, Bias: 642395.042
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14011.623', '55246.242', '135753.949', '245566.019', '358107.885', '447165.864', '513293.598', '553104.618', '572902.449', '571365.187', '556
709.995', '530210.772', '496360.289', '456485.959', '412565.941', '369617.104', '326181.547', '286077.226', '246491.610', '211011.292', '178248.478', '150
144.408', '125147.524', '103120.867', '84260.789', '67202.421', '53316.293', '41247.976', '31529.789', '23726.194', '18411.051', '14528.955', '10738.381',
 '7940.258', '4922.191', '3881.261', '2799.601', '1175.048', '1218.912', '407.069', '805.013', '56.585', '6.391', '343.318', '-115.057', '286.264', '-137.
024', '1683.810']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8285125.934555316, target N: 8329784.0
Mean E: 4.318475536808082, target E: 4.311618393706248
INFO:test:{'loss': 200.6337160628958, 'bias_avg': 0.9130288555530851, 'bias_std': 14.131800478410206}
Working on epoch num: 28...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch28.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in multiply
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.15s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.37s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106517115.643, Bias: -68031.879
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14561.980', '55554.776', '135965.015', '247035.188', '359833.826', '451299.449', '518316.622', '555611.274', '574837.054', '576416.561', '560
563.211', '533682.047', '499068.233', '459063.552', '416120.879', '372501.285', '327630.313', '288071.004', '249263.783', '211694.205', '179907.270', '151
605.523', '125756.125', '103245.295', '84964.086', '67437.402', '54367.649', '41569.880', '31813.046', '24562.806', '18466.139', '12983.115', '9645.245',
'7364.156', '4748.606', '3025.128', '1931.970', '1120.215', '551.157', '575.306', '100.023', '168.829', '99.744', '-96.343', '14.965', '-148.768', '-114.7
61', '1762.899']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8334516.964740248, target N: 8329784.0
Mean E: 4.314000113487927, target E: 4.311618393706248
INFO:test:{'loss': 189.44063113645905, 'bias_avg': -0.09676489862773323, 'bias_std': 13.760631018461726}
Working on epoch num: 29...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch29.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in multiply
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.27s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.42s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -105820180.346, Bias: 628903.418
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['13365.024', '55196.217', '134931.699', '246020.828', '360102.671', '451404.125', '514678.383', '553452.728', '574217.439', '573095.088', '556
521.469', '529896.601', '495829.509', '456084.095', '413940.175', '370554.557', '326781.967', '284936.881', '245164.904', '209953.838', '178388.091', '149
308.622', '123027.346', '101023.484', '82444.807', '66751.945', '52304.008', '40914.480', '32068.260', '24444.573', '18753.828', '15235.207', '9978.869',
'7326.164', '5275.003', '3366.077', '2084.549', '1564.619', '1097.257', '496.905', '533.752', '115.366', '-45.723', '231.558', '-76.339', '177.632', '-186
.231', '1711.238']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8284443.547350384, target N: 8329784.0
Mean E: 4.312940687969758, target E: 4.311618393706248
INFO:test:{'loss': 197.5807869474132, 'bias_avg': 0.9269801505765456, 'bias_std': 14.022765694001473}
Working on epoch num: 3...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch3.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.01s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.30s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106437341.006, Bias: 11742.759
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['12942.437', '53591.594', '136483.763', '251515.597', '362645.293', '453272.559', '514989.127', '555709.798', '574913.230', '576436.839', '561
069.100', '532624.942', '494715.744', '456027.045', '416057.094', '371264.373', '329070.030', '286164.653', '249739.161', '212639.435', '179806.666', '152
101.951', '126235.912', '101386.557', '85830.810', '67169.909', '52492.538', '41598.336', '29727.610', '24492.016', '18296.653', '13228.867', '10545.469',
 '8563.406', '5198.459', '3738.197', '2142.422', '756.033', '133.617', '672.181', '-187.739', '290.021', '197.705', '-1690.381', '1194.363', '510.612', '1
89.762', '1368.625']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8327862.395990299, target N: 8329784.0
Mean E: 4.313808292940613, target E: 4.311618393706248
INFO:test:{'loss': 215.1362996798619, 'bias_avg': 0.039286964423991044, 'bias_std': 14.666503427073112}
Working on epoch num: 30...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch30.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.15s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.36s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106603369.936, Bias: -154286.172
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15029.000', '55040.959', '137494.324', '245290.315', '362430.630', '453766.025', '515066.161', '555711.379', '576246.872', '575293.521', '561
809.004', '534871.048', '502085.486', '456926.965', '418935.540', '374752.728', '329092.280', '288023.892', '249150.296', '211066.998', '179645.633', '152
324.809', '124221.409', '102701.264', '82966.378', '66836.037', '52626.623', '41864.832', '32436.416', '23346.775', '18485.106', '13542.591', '9881.960',
'6780.295', '5152.534', '2958.644', '2095.592', '1184.005', '747.307', '534.140', '366.491', '81.982', '86.400', '-50.757', '7.705', '-29.596', '-38.548',
 '1769.167']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8340608.615595399, target N: 8329784.0
Mean E: 4.312210748271828, target E: 4.311618393706248
INFO:test:{'loss': 192.87346443273603, 'bias_avg': -0.22130799597683085, 'bias_std': 13.88295816977429}
Working on epoch num: 31...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch31.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.17s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.38s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106335242.779, Bias: 113840.986
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14135.831', '55332.772', '135964.254', '246919.784', '360174.510', '451255.040', '515885.253', '555545.960', '574778.784', '575226.286', '559
304.997', '532978.960', '498472.152', '459305.877', '414922.044', '371343.275', '328741.052', '287125.281', '248171.850', '212322.791', '179709.147', '150
381.569', '125639.363', '102519.911', '84443.261', '67030.389', '52587.013', '41494.419', '32531.663', '24296.694', '18570.201', '13492.223', '9566.031',
'6671.332', '4495.015', '3211.483', '2076.276', '1261.090', '744.098', '408.320', '189.400', '119.080', '-5.672', '-8.293', '-2.377', '1.152', '0.563', '2
017.396']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8321347.499476626, target N: 8329784.0
Mean E: 4.313040287008119, target E: 4.311618393706248
INFO:test:{'loss': 187.9981002732746, 'bias_avg': 0.17248324018933237, 'bias_std': 13.70742800846418}
Working on epoch num: 32...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch32.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.01s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.30s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106400089.447, Bias: 48994.318
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14467.729', '55288.156', '135813.948', '247234.201', '361083.507', '452338.133', '516219.605', '556095.217', '575068.043', '574945.994', '559
726.272', '533602.131', '499078.194', '457929.528', '416405.386', '372480.737', '328043.524', '286892.911', '247867.766', '211820.161', '179259.753', '150
938.687', '124887.532', '102655.863', '83428.949', '66960.716', '53011.633', '42111.968', '32598.219', '24413.331', '18479.524', '13818.530', '9484.850',
'7034.446', '4747.743', '3316.531', '2064.297', '1202.472', '664.262', '421.487', '273.211', '122.106', '41.137', '-14.099', '-0.494', '-10.083', '-14.330
', '1974.917']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8326274.303475594, target N: 8329784.0
Mean E: 4.312751700868477, target E: 4.311618393706248
INFO:test:{'loss': 187.7633428152457, 'bias_avg': 0.07175533156165664, 'bias_std': 13.69952925662414}
Working on epoch num: 33...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch33.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.13s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.36s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106372222.729, Bias: 76861.035
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14186.394', '54899.111', '136875.606', '247624.856', '360491.076', '451932.795', '515898.535', '555046.888', '575398.409', '575034.393', '559
789.248', '533448.507', '499411.464', '457909.798', '415667.083', '371739.220', '328510.509', '287134.296', '248470.528', '211842.364', '179652.355', '150
141.623', '125494.459', '102395.901', '83556.077', '66583.071', '53353.915', '41600.071', '32405.043', '24298.000', '18657.469', '13500.501', '9716.515',
'6720.360', '4842.352', '3252.582', '1879.046', '1267.717', '809.997', '434.730', '249.959', '112.063', '47.975', '-16.955', '2.114', '-1.481', '9.993', '
1797.671']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8324074.200224466, target N: 8329784.0
Mean E: 4.31267302211338, target E: 4.311618393706248
INFO:test:{'loss': 187.47925243433838, 'bias_avg': 0.11673617526757238, 'bias_std': 13.689102367517174}
Working on epoch num: 34...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch34.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.04s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.31s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106515545.080, Bias: -66461.316
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14588.800', '55217.105', '136198.062', '247131.350', '361099.357', '452507.636', '516521.215', '556408.580', '575553.979', '575477.945', '560
111.795', '533985.355', '499592.443', '458986.407', '417138.111', '372618.133', '329382.303', '287087.299', '248912.873', '212853.400', '179248.620', '150
881.482', '125547.247', '102554.127', '83714.569', '66837.062', '52934.106', '41878.417', '32399.585', '24365.224', '18261.485', '13262.263', '9625.096',
'6969.751', '4709.772', '3013.571', '2105.989', '1288.809', '682.519', '391.796', '254.014', '116.183', '22.366', '-18.999', '4.990', '-21.875', '5.120',
'1941.256']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8334346.6963754, target N: 8329784.0
Mean E: 4.312528825944957, target E: 4.311618393706248
INFO:test:{'loss': 187.60093533232356, 'bias_avg': -0.0932837758611767, 'bias_std': 13.693647839487243}
Working on epoch num: 35...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch35.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.04s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.31s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106391755.997, Bias: 57327.768
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14180.807', '54995.414', '136594.360', '246980.361', '360990.407', '452227.592', '515819.520', '555042.854', '575183.642', '575139.400', '559
990.719', '533368.232', '499516.512', '458799.015', '415987.578', '372848.310', '328880.390', '286717.919', '248297.837', '212184.624', '179657.469', '150
535.268', '125884.091', '102379.344', '83536.286', '66619.203', '52776.531', '41255.828', '32420.175', '24363.071', '18619.570', '13369.875', '9400.824',
'6499.226', '4493.992', '2903.192', '2024.645', '1135.833', '744.178', '336.447', '192.885', '83.609', '54.777', '-30.217', '0.575', '-21.739', '4.331', '
1828.988']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8324813.747541244, target N: 8329784.0
Mean E: 4.311622104402721, target E: 4.311618393706248
INFO:test:{'loss': 187.77572100249077, 'bias_avg': 0.10161621273441333, 'bias_std': 13.700060184617271}
Working on epoch num: 36...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch36.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.06s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.32s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106544191.825, Bias: -95108.060
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14054.493', '54887.709', '136877.773', '247782.197', '361410.518', '453080.274', '516542.867', '556200.554', '576072.139', '576112.006', '560
155.166', '534107.562', '499545.794', '458514.597', '416240.562', '372370.085', '328631.374', '288129.323', '248531.278', '212312.992', '179861.023', '151
138.922', '125226.876', '102725.197', '84060.129', '66881.144', '53596.400', '41415.937', '32363.138', '24448.027', '18516.413', '13783.509', '9691.292',
'6894.235', '4645.096', '3068.677', '2017.238', '1298.752', '638.232', '405.043', '199.434', '110.850', '44.193', '-36.913', '10.983', '-28.353', '5.942',
 '1930.736']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8336471.414802479, target N: 8329784.0
Mean E: 4.312692936824775, target E: 4.311618393706248
INFO:test:{'loss': 187.8168330618397, 'bias_avg': -0.136723407000391, 'bias_std': 13.701320419835623}
Working on epoch num: 37...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch37.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in multiply
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.04s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.31s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106302200.424, Bias: 146883.340
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14489.616', '55718.115', '136286.979', '247188.436', '360483.885', '451420.131', '515307.034', '554672.805', '574293.759', '574551.250', '558
834.645', '533457.670', '499017.830', '457358.187', '415205.982', '372900.641', '328120.869', '286981.694', '248481.535', '211718.839', '179415.054', '150
184.059', '124827.541', '102905.626', '83422.833', '67313.351', '53160.524', '41150.660', '32626.091', '24358.579', '18354.982', '13509.766', '9908.279',
'6876.675', '4756.924', '3108.498', '2018.205', '1355.947', '815.699', '498.514', '230.431', '78.187', '24.172', '-8.962', '1.702', '0.831', '-5.519', '19
96.130']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8319374.682108549, target N: 8329784.0
Mean E: 4.3129692690101935, target E: 4.311618393706248
INFO:test:{'loss': 188.37392312481313, 'bias_avg': 0.2128172510388555, 'bias_std': 13.720093611997056}
Working on epoch num: 38...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch38.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.06s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.32s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106421113.241, Bias: 27970.523
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14454.535', '55608.800', '136680.410', '247742.447', '360614.331', '452828.134', '517227.100', '555628.100', '575578.426', '575695.681', '560
241.059', '533339.896', '499402.988', '458231.351', '415518.554', '372560.740', '327759.462', '286866.399', '247714.778', '211808.646', '179112.492', '150
531.258', '125044.087', '102773.617', '83663.529', '66845.762', '53016.542', '41558.009', '32369.085', '24228.037', '18528.812', '13211.081', '9955.216',
'6939.267', '4663.317', '3008.548', '1955.658', '1174.055', '824.498', '340.586', '273.806', '88.956', '18.529', '18.845', '-3.770', '7.105', '-9.746', '1
775.011']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8327414.031240785, target N: 8329784.0
Mean E: 4.311100761789712, target E: 4.311618393706248
INFO:test:{'loss': 187.36367588211672, 'bias_avg': 0.04845373810682961, 'bias_std': 13.68530536984789}
Working on epoch num: 39...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch39.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:11<00:11, 11.96s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.27s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106364056.654, Bias: 85027.111
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14122.498', '54913.993', '136603.149', '247017.553', '360581.381', '452123.883', '515552.372', '556064.465', '574641.688', '575311.703', '559
654.814', '533475.563', '499046.778', '458080.271', '415846.247', '372019.534', '328799.904', '286934.658', '248323.325', '211699.528', '178836.380', '150
200.197', '125706.971', '102468.767', '83881.032', '66633.662', '52695.819', '41910.653', '32405.352', '24603.445', '18345.093', '14028.696', '9309.281',
'7073.847', '4753.179', '3138.953', '1966.338', '1267.010', '684.487', '391.699', '250.393', '112.917', '32.374', '-16.668', '-3.383', '-2.071', '-11.356'
, '1949.072']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8323425.4432905475, target N: 8329784.0
Mean E: 4.312687791987253, target E: 4.311618393706248
INFO:test:{'loss': 187.45149281869575, 'bias_avg': 0.12999995627510888, 'bias_std': 13.687667711911187}
Working on epoch num: 4...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch4.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.16s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.37s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106789547.868, Bias: -340464.104
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['12512.205', '52561.323', '136866.215', '248774.682', '358104.165', '454060.666', '520149.550', '557652.603', '576475.644', '575566.825', '559
893.764', '538288.772', '498992.750', '455856.795', '416655.856', '376797.610', '329746.277', '289017.295', '251759.866', '215549.049', '182422.642', '149
675.356', '124651.224', '107203.932', '85182.770', '68501.267', '52977.063', '39573.568', '32170.277', '24239.895', '19306.618', '10734.068', '10373.945',
 '7391.299', '5076.702', '1853.497', '2566.294', '1804.312', '528.627', '55.828', '116.575', '-298.399', '101.846', '-294.026', '39.770', '-137.628', '-21
6.528', '1413.982']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8352296.685750197, target N: 8329784.0
Mean E: 4.315360254403774, target E: 4.311618393706248
INFO:test:{'loss': 216.8854086654109, 'bias_avg': -0.4602691979824736, 'bias_std': 14.717208967124632}
Working on epoch num: 40...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch40.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.12s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.35s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106421880.456, Bias: 27203.309
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14937.905', '55278.438', '136395.138', '247505.217', '361985.298', '452665.193', '516991.215', '556745.610', '576077.424', '575942.473', '560
373.316', '533753.756', '499940.443', '457582.340', '415730.844', '372154.299', '327629.579', '286074.674', '247940.911', '212456.981', '179360.297', '150
614.050', '124169.967', '102741.787', '82951.809', '66460.001', '52784.299', '41495.611', '32022.773', '24046.874', '18253.949', '13256.009', '9598.056',
'6577.979', '4838.178', '2976.531', '2043.341', '1162.199', '723.221', '402.815', '226.005', '91.007', '16.486', '-10.023', '-1.553', '-1.195', '8.122', '
2051.915']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8327021.562580463, target N: 8329784.0
Mean E: 4.3089845776719, target E: 4.311618393706248
INFO:test:{'loss': 187.76156569790678, 'bias_avg': 0.056477704857703634, 'bias_std': 13.699968182654564}
Working on epoch num: 5...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch5.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.15s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.37s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106549227.832, Bias: -100144.067
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['11717.443', '54673.754', '137226.241', '246078.389', '361247.291', '446925.305', '518502.058', '552443.504', '577690.541', '575693.402', '560
595.686', '533579.412', '500984.868', '460189.414', '417873.401', '373677.732', '331765.451', '285883.767', '249610.777', '212569.210', '178808.030', '150
497.983', '129436.685', '103744.538', '84641.487', '67555.350', '52829.470', '41201.358', '33096.642', '25818.435', '19426.708', '9313.668', '7797.291', '
6662.263', '4706.059', '3357.574', '2741.760', '948.278', '-3198.203', '1023.297', '-307.133', '204.261', '-114.044', '-194.642', '357.186', '-416.751', '
581.813', '2763.416']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8332210.42559509, target N: 8329784.0
Mean E: 4.312243796505322, target E: 4.311618393706248
INFO:test:{'loss': 212.5479478171576, 'bias_avg': -0.049607989130591036, 'bias_std': 14.577348733439647}
Working on epoch num: 6...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch6.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.08s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.34s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -105083101.494, Bias: 1365982.271
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14967.861', '55230.615', '133778.615', '242696.118', '353977.696', '450360.510', '511322.984', '549987.740', '568668.559', '571099.284', '554
761.724', '529276.004', '494828.561', '455293.690', '413917.903', '366685.629', '321545.685', '286741.589', '242182.501', '207474.037', '173985.396', '149
271.525', '124013.740', '101364.303', '84375.895', '67942.916', '53448.315', '40800.961', '31845.991', '22805.892', '16406.124', '7292.844', '9257.492', '
5864.830', '4072.795', '1369.792', '2199.476', '1454.183', '-897.196', '445.135', '925.884', '2174.003', '-8.012', '330.443', '-582.477', '276.105', '193.
191', '1314.596']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8226741.445385108, target N: 8329784.0
Mean E: 4.306203042706396, target E: 4.311618393706248
INFO:test:{'loss': 240.48735341379992, 'bias_avg': 2.106692567774779, 'bias_std': 15.359806259200196}
Working on epoch num: 7...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch7.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.01s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.30s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -107432080.228, Bias: -982996.464
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['13801.422', '56197.001', '136730.888', '252484.088', '365729.184', '458622.411', '521896.269', '560418.299', '580924.949', '586054.026', '565
262.072', '537299.637', '501789.411', '464961.422', '417505.922', '375857.000', '330978.260', '288952.378', '250378.259', '210928.560', '178750.367', '148
370.545', '124781.726', '103007.092', '84513.092', '65355.140', '52991.007', '41237.303', '33838.504', '25411.152', '19337.289', '15231.537', '10212.145',
 '7704.932', '3265.477', '3349.354', '1982.487', '845.207', '19.231', '192.264', '318.398', '-1842.063', '-460.059', '49.859', '1.733', '-424.943', '8.195
', '2198.031']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8397016.459387917, target N: 8329784.0
Mean E: 4.304316481313649, target E: 4.311618393706248
INFO:test:{'loss': 235.17947257419095, 'bias_avg': -1.3745595166446885, 'bias_std': 15.27299282384691}
Working on epoch num: 8...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch8.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.01s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.30s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -106018488.562, Bias: 430595.202
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['14260.854', '55603.135', '137440.266', '246332.053', '358218.783', '450286.376', '514936.899', '557731.911', '574250.155', '571077.650', '557
998.460', '529678.697', '499691.740', '456860.405', '413130.945', '369532.936', '328087.242', '282459.672', '248200.272', '212068.937', '180247.886', '148
335.548', '126670.680', '102988.439', '85432.594', '64736.323', '53662.930', '42526.980', '31500.999', '22477.279', '18617.810', '11256.573', '10797.870',
 '6806.392', '3633.200', '3827.522', '1807.255', '976.973', '693.753', '752.023', '237.683', '897.738', '190.779', '32.829', '-12.463', '4.363', '-145.630
', '1368.770']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8298170.486781803, target N: 8329784.0
Mean E: 4.311650669728818, target E: 4.311618393706248
INFO:test:{'loss': 205.04725155816345, 'bias_avg': 0.6463345124279318, 'bias_std': 14.301657185353287}
Working on epoch num: 9...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  1019
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0214_002313/checkpoint-epoch9.pth ...
  0%|                                                                                                                               | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████▌                                                           | 1/2 [00:12<00:12, 12.15s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:12<00:00,  6.37s/it]
Entopies: True distribution: -106449083.764, Predicted distribution: -105864507.587, Bias: 584576.177
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15719.341', '54866.545', '136916.828', '244763.039', '358554.417', '450384.625', '511579.742', '553021.163', '572009.451', '570284.047', '558
652.224', '533035.751', '499325.978', '456378.215', '411263.032', '369262.399', '326250.806', '285204.914', '246808.090', '207767.861', '176039.920', '150
148.807', '125568.279', '102129.920', '83501.659', '68892.700', '54640.985', '42941.997', '31185.276', '25125.853', '18446.442', '14336.806', '9629.310',
'6337.532', '5880.177', '4446.638', '1001.871', '1244.045', '816.298', '578.480', '61.537', '1703.555', '208.470', '-6.527', '23.147', '-58.566', '141.637
', '2845.907']
total target: ['14345.000', '55604.000', '136876.000', '248306.000', '360682.000', '452802.000', '516852.000', '556460.000', '576198.000', '574862.000', '
561202.000', '532933.000', '498543.000', '458734.000', '415807.000', '370880.000', '328859.000', '286075.000', '248680.000', '212153.000', '179170.000', '
150293.000', '124512.000', '102967.000', '83356.000', '67755.000', '52860.000', '41940.000', '32230.000', '24313.000', '18623.000', '13401.000', '9919.000
', '6887.000', '4916.000', '3151.000', '2047.000', '1233.000', '732.000', '423.000', '218.000', '90.000', '49.000', '19.000', '3.000', '0.000', '0.000', '
1824.000']
total N: 8289860.624735998, target N: 8329784.0
Mean E: 4.316022892963564, target E: 4.311618393706248
INFO:test:{'loss': 205.64418886313845, 'bias_avg': 0.8162286550654747, 'bias_std': 14.313087470866044}
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)

tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)





























