tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)










tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
This is the 4 run
==================================================
rm: cannot remove './saved/models/new_model/*': No such file or directory
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)







tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  2621
INFO:train:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
2024-02-13 00:16:38.858976: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the f
ollowing CPU instructions in performance-critical operations:  AVX2 AVX_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-02-13 00:16:38.933203: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off
errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-02-13 00:16:38.949906: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has
already been registered
2024-02-13 00:16:40.326851: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot ope
n shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64:/usr/local/
cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64::/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student1/anaconda3/li
b/:/home/student1/anaconda3/lib/
2024-02-13 00:16:40.326896: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so
.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib
64:/usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64::/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student
1/anaconda3/lib/:/home/student1/anaconda3/lib/
2024-02-13 00:16:40.326900: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU wit
h TensorRT, please make sure the missing libraries mentioned above are installed properly.
DEBUG:trainer:Train Epoch: 1 [1/40 (2%)] Loss: 564603.812500
DEBUG:trainer:Train Epoch: 1 [1/40 (2%)] Loss: 115304.203125
INFO:trainer:    epoch          : 1
INFO:trainer:    loss           : 225591.18698601975
INFO:trainer:    bias_avg       : 85.56173550455193
INFO:trainer:    bias_std       : 390.57219013414885
INFO:trainer:    val_loss       : 42751.21546052631
INFO:trainer:    val_bias_avg   : 78.41243663587068
INFO:trainer:    val_bias_std   : 190.8181545859889
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch1.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 2 [2/40 (5%)] Loss: 45644.476562
DEBUG:trainer:Train Epoch: 2 [2/40 (5%)] Loss: 9756.374023
INFO:trainer:    epoch          : 2
INFO:trainer:    loss           : 16552.846576891447
INFO:trainer:    bias_avg       : 5.454615379634657
INFO:trainer:    bias_std       : 116.91930630332546
INFO:trainer:    val_loss       : 3845.6389417146383
INFO:trainer:    val_bias_avg   : -5.012060290888736
INFO:trainer:    val_bias_std   : 61.677392859207956
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch2.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 3 [3/40 (8%)] Loss: 3706.288086
DEBUG:trainer:Train Epoch: 3 [3/40 (8%)] Loss: 1378.008545
INFO:trainer:    epoch          : 3
INFO:trainer:    loss           : 2098.6758069490133
INFO:trainer:    bias_avg       : 5.853994005604794
INFO:trainer:    bias_std       : 43.99051164325915
INFO:trainer:    val_loss       : 1205.5760048314144
INFO:trainer:    val_bias_avg   : -3.902677372882241
INFO:trainer:    val_bias_std   : 34.4416110390111
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch3.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 4 [4/40 (10%)] Loss: 1165.479980
DEBUG:trainer:Train Epoch: 4 [4/40 (10%)] Loss: 866.472900
INFO:trainer:    epoch          : 4
INFO:trainer:    loss           : 794.9852648283306
INFO:trainer:    bias_avg       : 0.9888977000587865
INFO:trainer:    bias_std       : 27.87731893439042
INFO:trainer:    val_loss       : 569.3727224249589
INFO:trainer:    val_bias_avg   : 0.8872131807239432
INFO:trainer:    val_bias_std   : 23.82678343120374
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch4.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 5 [5/40 (12%)] Loss: 622.897827
DEBUG:trainer:Train Epoch: 5 [5/40 (12%)] Loss: 475.815674
INFO:trainer:    epoch          : 5
INFO:trainer:    loss           : 500.4376798930921
INFO:trainer:    bias_avg       : 0.27317439235354724
INFO:trainer:    bias_std       : 22.31000398334704
INFO:trainer:    val_loss       : 444.3648890445107
INFO:trainer:    val_bias_avg   : -0.02446452841946953
INFO:trainer:    val_bias_std   : 21.064917413811933
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch5.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 6 [6/40 (15%)] Loss: 450.688965
DEBUG:trainer:Train Epoch: 6 [6/40 (15%)] Loss: 426.419037
INFO:trainer:    epoch          : 6
INFO:trainer:    loss           : 413.42815359015214
INFO:trainer:    bias_avg       : 0.07799113992797702
INFO:trainer:    bias_std       : 20.279977497301605
INFO:trainer:    val_loss       : 369.5789200632196
INFO:trainer:    val_bias_avg   : 0.11673033786447425
INFO:trainer:    val_bias_std   : 19.200111790707236
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch6.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 7 [7/40 (18%)] Loss: 365.285248
DEBUG:trainer:Train Epoch: 7 [7/40 (18%)] Loss: 332.343872
INFO:trainer:    epoch          : 7
INFO:trainer:    loss           : 338.20398431075245
INFO:trainer:    bias_avg       : 0.3026275166163319
INFO:trainer:    bias_std       : 18.35323509417082
INFO:trainer:    val_loss       : 310.6271603232936
INFO:trainer:    val_bias_avg   : 0.07906284222477361
INFO:trainer:    val_bias_std   : 17.588843998156097
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch7.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 8 [8/40 (20%)] Loss: 284.476318
DEBUG:trainer:Train Epoch: 8 [8/40 (20%)] Loss: 206.302979
INFO:trainer:    epoch          : 8
INFO:trainer:    loss           : 301.7789266485917
INFO:trainer:    bias_avg       : 0.028516447318619804
INFO:trainer:    bias_std       : 17.30182557356985
INFO:trainer:    val_loss       : 294.9869175961143
INFO:trainer:    val_bias_avg   : -0.15451579009133734
INFO:trainer:    val_bias_std   : 17.136540613676374
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch8.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 9 [9/40 (22%)] Loss: 287.735413
DEBUG:trainer:Train Epoch: 9 [9/40 (22%)] Loss: 319.044800
INFO:trainer:    epoch          : 9
INFO:trainer:    loss           : 297.9895902934827
INFO:trainer:    bias_avg       : -0.06783818531977504
INFO:trainer:    bias_std       : 17.233260255110892
INFO:trainer:    val_loss       : 298.99786136024875
INFO:trainer:    val_bias_avg   : -0.36651207781151723
INFO:trainer:    val_bias_std   : 17.260052931936162
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch9.pth ...
DEBUG:trainer:Train Epoch: 10 [10/40 (25%)] Loss: 410.585541
DEBUG:trainer:Train Epoch: 10 [10/40 (25%)] Loss: 223.688843
INFO:trainer:    epoch          : 10
INFO:trainer:    loss           : 296.2174674586246
INFO:trainer:    bias_avg       : 0.06506415574174178
INFO:trainer:    bias_std       : 17.153817728946084
INFO:trainer:    val_loss       : 296.19726642809417
INFO:trainer:    val_bias_avg   : -0.39625700680833115
INFO:trainer:    val_bias_std   : 17.172117634823447
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch10.pth ...
DEBUG:trainer:Train Epoch: 11 [11/40 (28%)] Loss: 353.905518
DEBUG:trainer:Train Epoch: 11 [11/40 (28%)] Loss: 305.830444
INFO:trainer:    epoch          : 11
INFO:trainer:    loss           : 297.36795525801807
INFO:trainer:    bias_avg       : 0.024057300197646805
INFO:trainer:    bias_std       : 17.209862960012334
INFO:trainer:    val_loss       : 299.22959016498766
INFO:trainer:    val_bias_avg   : -0.6429956147545263
INFO:trainer:    val_bias_std   : 17.25758055636757
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch11.pth ...
DEBUG:trainer:Train Epoch: 12 [12/40 (30%)] Loss: 290.113800
DEBUG:trainer:Train Epoch: 12 [12/40 (30%)] Loss: 338.037506
INFO:trainer:    epoch          : 12
INFO:trainer:    loss           : 300.45643856650906
INFO:trainer:    bias_avg       : -0.09564142904587482
INFO:trainer:    bias_std       : 17.281575002168353
INFO:trainer:    val_loss       : 294.08473848041734
INFO:trainer:    val_bias_avg   : -0.19904881107964015
INFO:trainer:    val_bias_std   : 17.111427909449528
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch12.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 13 [13/40 (32%)] Loss: 317.734497
DEBUG:trainer:Train Epoch: 13 [13/40 (32%)] Loss: 271.980652
INFO:trainer:    epoch          : 13
INFO:trainer:    loss           : 298.37916966488484
INFO:trainer:    bias_avg       : 0.04847314345993494
INFO:trainer:    bias_std       : 17.232920847441022
INFO:trainer:    val_loss       : 299.8755115709807
INFO:trainer:    val_bias_avg   : 0.6690864421819386
INFO:trainer:    val_bias_std   : 17.27270056072034
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch13.pth ...
DEBUG:trainer:Train Epoch: 14 [14/40 (35%)] Loss: 273.923492
DEBUG:trainer:Train Epoch: 14 [14/40 (35%)] Loss: 355.834900
INFO:trainer:    epoch          : 14
INFO:trainer:    loss           : 301.19289759585735
INFO:trainer:    bias_avg       : -0.030131752749806957
INFO:trainer:    bias_std       : 17.310099802519147
INFO:trainer:    val_loss       : 298.0433654785156
INFO:trainer:    val_bias_avg   : -0.6611558057759938
INFO:trainer:    val_bias_std   : 17.22632132078472
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch14.pth ...
DEBUG:trainer:Train Epoch: 15 [15/40 (38%)] Loss: 276.218689
DEBUG:trainer:Train Epoch: 15 [15/40 (38%)] Loss: 276.448792
INFO:trainer:    epoch          : 15
INFO:trainer:    loss           : 300.5084116082442
INFO:trainer:    bias_avg       : 0.005939580500125885
INFO:trainer:    bias_std       : 17.288078609265778
INFO:trainer:    val_loss       : 295.4829719945004
INFO:trainer:    val_bias_avg   : 0.09457181987205618
INFO:trainer:    val_bias_std   : 17.15879339920847
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch15.pth ...
DEBUG:trainer:Train Epoch: 16 [16/40 (40%)] Loss: 303.449646
DEBUG:trainer:Train Epoch: 16 [16/40 (40%)] Loss: 323.402649
INFO:trainer:    epoch          : 16
INFO:trainer:    loss           : 293.0906693307977
INFO:trainer:    bias_avg       : 0.03442753248504902
INFO:trainer:    bias_std       : 17.08157137820595
INFO:trainer:    val_loss       : 294.79981753700656
INFO:trainer:    val_bias_avg   : -0.07112962942923523
INFO:trainer:    val_bias_std   : 17.13073810778166
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch16.pth ...
DEBUG:trainer:Train Epoch: 17 [17/40 (42%)] Loss: 341.579224
DEBUG:trainer:Train Epoch: 17 [17/40 (42%)] Loss: 262.503784
INFO:trainer:    epoch          : 17
INFO:trainer:    loss           : 294.6451664974815
INFO:trainer:    bias_avg       : -0.06842200644314289
INFO:trainer:    bias_std       : 17.120951451753314
INFO:trainer:    val_loss       : 294.4696848016036
INFO:trainer:    val_bias_avg   : 0.13191170941450095
INFO:trainer:    val_bias_std   : 17.1229214417307
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch17.pth ...
DEBUG:trainer:Train Epoch: 18 [18/40 (45%)] Loss: 301.321869
DEBUG:trainer:Train Epoch: 18 [18/40 (45%)] Loss: 296.757507
INFO:trainer:    epoch          : 18
INFO:trainer:    loss           : 292.3224953099301
INFO:trainer:    bias_avg       : 0.04949928317096477
INFO:trainer:    bias_std       : 17.05496140530235
INFO:trainer:    val_loss       : 293.37331028988484
INFO:trainer:    val_bias_avg   : 0.2505003410930696
INFO:trainer:    val_bias_std   : 17.095658151726973
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch18.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 19 [19/40 (48%)] Loss: 340.990051
DEBUG:trainer:Train Epoch: 19 [19/40 (48%)] Loss: 400.026550
INFO:trainer:    epoch          : 19
INFO:trainer:    loss           : 291.544697811729
INFO:trainer:    bias_avg       : -0.016907023462025744
INFO:trainer:    bias_std       : 17.01296585484555
INFO:trainer:    val_loss       : 293.7119204872533
INFO:trainer:    val_bias_avg   : 0.390423878243095
INFO:trainer:    val_bias_std   : 17.107209406400983
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch19.pth ...
DEBUG:trainer:Train Epoch: 20 [20/40 (50%)] Loss: 312.588898
DEBUG:trainer:Train Epoch: 20 [20/40 (50%)] Loss: 268.232849
INFO:trainer:    epoch          : 20
INFO:trainer:    loss           : 295.2268371582031
INFO:trainer:    bias_avg       : 0.0071652065472383245
INFO:trainer:    bias_std       : 17.137444496154785
INFO:trainer:    val_loss       : 290.9977240311472
INFO:trainer:    val_bias_avg   : 0.11329600444112561
INFO:trainer:    val_bias_std   : 17.002220454968903
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch20.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 21 [21/40 (52%)] Loss: 311.711914
DEBUG:trainer:Train Epoch: 21 [21/40 (52%)] Loss: 334.103638
INFO:trainer:    epoch          : 21
INFO:trainer:    loss           : 292.69711624948604
INFO:trainer:    bias_avg       : 0.012494265101850033
INFO:trainer:    bias_std       : 17.079462754098994
INFO:trainer:    val_loss       : 295.09019470214844
INFO:trainer:    val_bias_avg   : 0.10029891138210108
INFO:trainer:    val_bias_std   : 17.132878002367523
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch21.pth ...
DEBUG:trainer:Train Epoch: 22 [22/40 (55%)] Loss: 330.803741
DEBUG:trainer:Train Epoch: 22 [22/40 (55%)] Loss: 305.585938
INFO:trainer:    epoch          : 22
INFO:trainer:    loss           : 293.20363496479234
INFO:trainer:    bias_avg       : 0.022046921211049744
INFO:trainer:    bias_std       : 17.085743151212995
INFO:trainer:    val_loss       : 293.81016540527344
INFO:trainer:    val_bias_avg   : 0.11167761134473901
INFO:trainer:    val_bias_std   : 17.113709449768066
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch22.pth ...
DEBUG:trainer:Train Epoch: 23 [23/40 (58%)] Loss: 280.043976
DEBUG:trainer:Train Epoch: 23 [23/40 (58%)] Loss: 293.677704
INFO:trainer:    epoch          : 23
INFO:trainer:    loss           : 292.76319885253906
INFO:trainer:    bias_avg       : -0.01157693002421997
INFO:trainer:    bias_std       : 17.082183235570003
INFO:trainer:    val_loss       : 295.6168750963713
INFO:trainer:    val_bias_avg   : 0.028283217584861343
INFO:trainer:    val_bias_std   : 17.15279147499486
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch23.pth ...
DEBUG:trainer:Train Epoch: 24 [24/40 (60%)] Loss: 313.252167
DEBUG:trainer:Train Epoch: 24 [24/40 (60%)] Loss: 273.959808
INFO:trainer:    epoch          : 24
INFO:trainer:    loss           : 292.0000642475329
INFO:trainer:    bias_avg       : 0.006503765030126823
INFO:trainer:    bias_std       : 17.055831808792917
INFO:trainer:    val_loss       : 294.02607084575453
INFO:trainer:    val_bias_avg   : -0.31611574127485875
INFO:trainer:    val_bias_std   : 17.1222707346866
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch24.pth ...
DEBUG:trainer:Train Epoch: 25 [25/40 (62%)] Loss: 269.989319
DEBUG:trainer:Train Epoch: 25 [25/40 (62%)] Loss: 285.238098
INFO:trainer:    epoch          : 25
INFO:trainer:    loss           : 294.6066292210629
INFO:trainer:    bias_avg       : -0.05423512858779807
INFO:trainer:    bias_std       : 17.140077942296077
INFO:trainer:    val_loss       : 289.78790042274875
INFO:trainer:    val_bias_avg   : -0.0699496265304716
INFO:trainer:    val_bias_std   : 16.955905763726484
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch25.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 26 [26/40 (65%)] Loss: 283.416260
DEBUG:trainer:Train Epoch: 26 [26/40 (65%)] Loss: 269.402710
INFO:trainer:    epoch          : 26
INFO:trainer:    loss           : 292.0143031070107
INFO:trainer:    bias_avg       : 0.050733902271052726
INFO:trainer:    bias_std       : 17.03024703577945
INFO:trainer:    val_loss       : 293.26640962299547
INFO:trainer:    val_bias_avg   : 0.21346737085351428
INFO:trainer:    val_bias_std   : 17.093027416028473
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch26.pth ...
DEBUG:trainer:Train Epoch: 27 [27/40 (68%)] Loss: 324.544678
DEBUG:trainer:Train Epoch: 27 [27/40 (68%)] Loss: 270.312561
INFO:trainer:    epoch          : 27
INFO:trainer:    loss           : 295.20376265676396
INFO:trainer:    bias_avg       : -0.06266399874891106
INFO:trainer:    bias_std       : 17.15809460690147
INFO:trainer:    val_loss       : 294.9068458958676
INFO:trainer:    val_bias_avg   : -0.014207086219501338
INFO:trainer:    val_bias_std   : 17.142385683561628
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch27.pth ...
DEBUG:trainer:Train Epoch: 28 [28/40 (70%)] Loss: 327.197601
DEBUG:trainer:Train Epoch: 28 [28/40 (70%)] Loss: 207.611176
INFO:trainer:    epoch          : 28
INFO:trainer:    loss           : 296.1446870502673
INFO:trainer:    bias_avg       : -0.008895088722439189
INFO:trainer:    bias_std       : 17.155050127129805
INFO:trainer:    val_loss       : 293.1962376644737
INFO:trainer:    val_bias_avg   : 0.4469381508074309
INFO:trainer:    val_bias_std   : 17.076162840190687
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch28.pth ...
DEBUG:trainer:Train Epoch: 29 [29/40 (72%)] Loss: 329.717255
DEBUG:trainer:Train Epoch: 29 [29/40 (72%)] Loss: 257.920837
INFO:trainer:    epoch          : 29
INFO:trainer:    loss           : 293.7733901174445
INFO:trainer:    bias_avg       : 0.029526974417661365
INFO:trainer:    bias_std       : 17.0628335852372
INFO:trainer:    val_loss       : 293.5154467130962
INFO:trainer:    val_bias_avg   : 0.2188871347002293
INFO:trainer:    val_bias_std   : 17.11147443871749
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch29.pth ...
DEBUG:trainer:Train Epoch: 30 [30/40 (75%)] Loss: 299.720825
DEBUG:trainer:Train Epoch: 30 [30/40 (75%)] Loss: 299.541870
INFO:trainer:    epoch          : 30
INFO:trainer:    loss           : 293.7749103746916
INFO:trainer:    bias_avg       : -0.0171184778967137
INFO:trainer:    bias_std       : 17.120155886599893
INFO:trainer:    val_loss       : 292.09937005293995
INFO:trainer:    val_bias_avg   : 0.22750385380104968
INFO:trainer:    val_bias_std   : 17.05143602270829
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch30.pth ...
DEBUG:trainer:Train Epoch: 31 [31/40 (78%)] Loss: 333.667206
DEBUG:trainer:Train Epoch: 31 [31/40 (78%)] Loss: 246.005661
INFO:trainer:    epoch          : 31
INFO:trainer:    loss           : 293.5643061587685
INFO:trainer:    bias_avg       : 0.09602561740106658
INFO:trainer:    bias_std       : 17.101357158861664
INFO:trainer:    val_loss       : 293.83098481830797
INFO:trainer:    val_bias_avg   : -0.04329344746656716
INFO:trainer:    val_bias_std   : 17.08841027711567
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch31.pth ...
DEBUG:trainer:Train Epoch: 32 [32/40 (80%)] Loss: 319.707764
DEBUG:trainer:Train Epoch: 32 [32/40 (80%)] Loss: 334.393402
INFO:trainer:    epoch          : 32
INFO:trainer:    loss           : 292.4358616879112
INFO:trainer:    bias_avg       : -0.024493859982804247
INFO:trainer:    bias_std       : 17.069497158652858
INFO:trainer:    val_loss       : 296.4378124036287
INFO:trainer:    val_bias_avg   : 0.11404124533414449
INFO:trainer:    val_bias_std   : 17.168272871720163
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch32.pth ...
DEBUG:trainer:Train Epoch: 33 [33/40 (82%)] Loss: 233.516113
DEBUG:trainer:Train Epoch: 33 [33/40 (82%)] Loss: 335.385376
INFO:trainer:    epoch          : 33
INFO:trainer:    loss           : 296.8426224557977
INFO:trainer:    bias_avg       : 0.07272124052733968
INFO:trainer:    bias_std       : 17.151715328818874
INFO:trainer:    val_loss       : 293.7624455502159
INFO:trainer:    val_bias_avg   : -0.06738570342330556
INFO:trainer:    val_bias_std   : 17.09987103311639
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch33.pth ...
DEBUG:trainer:Train Epoch: 34 [34/40 (85%)] Loss: 299.036530
DEBUG:trainer:Train Epoch: 34 [34/40 (85%)] Loss: 235.026169
INFO:trainer:    epoch          : 34
INFO:trainer:    loss           : 293.5761285079153
INFO:trainer:    bias_avg       : -0.10208009803471596
INFO:trainer:    bias_std       : 17.085464477539062
INFO:trainer:    val_loss       : 295.3998148064864
INFO:trainer:    val_bias_avg   : 0.06540029510659606
INFO:trainer:    val_bias_std   : 17.133224888851768
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch34.pth ...
DEBUG:trainer:Train Epoch: 35 [35/40 (88%)] Loss: 246.098984
DEBUG:trainer:Train Epoch: 35 [35/40 (88%)] Loss: 296.977844
INFO:trainer:    epoch          : 35
INFO:trainer:    loss           : 294.01702077765214
INFO:trainer:    bias_avg       : 0.06937223601179492
INFO:trainer:    bias_std       : 17.119619871440687
INFO:trainer:    val_loss       : 291.02650451660156
INFO:trainer:    val_bias_avg   : -0.01798150092240815
INFO:trainer:    val_bias_std   : 17.030546238547878
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch35.pth ...
DEBUG:trainer:Train Epoch: 36 [36/40 (90%)] Loss: 306.404968
DEBUG:trainer:Train Epoch: 36 [36/40 (90%)] Loss: 287.550812
INFO:trainer:    epoch          : 36
INFO:trainer:    loss           : 290.2076472232216
INFO:trainer:    bias_avg       : 0.04598205894427864
INFO:trainer:    bias_std       : 16.975790776704486
INFO:trainer:    val_loss       : 293.29050806949016
INFO:trainer:    val_bias_avg   : -0.04670502721503573
INFO:trainer:    val_bias_std   : 17.09451053017064
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch36.pth ...
DEBUG:trainer:Train Epoch: 37 [37/40 (92%)] Loss: 349.589355
DEBUG:trainer:Train Epoch: 37 [37/40 (92%)] Loss: 267.680725
INFO:trainer:    epoch          : 37
INFO:trainer:    loss           : 291.21381418328536
INFO:trainer:    bias_avg       : -0.07443373184651136
INFO:trainer:    bias_std       : 17.016877375150983
INFO:trainer:    val_loss       : 291.4758260626542
INFO:trainer:    val_bias_avg   : 0.08777664703513055
INFO:trainer:    val_bias_std   : 17.024553600110504
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch37.pth ...
DEBUG:trainer:Train Epoch: 38 [38/40 (95%)] Loss: 297.143829
DEBUG:trainer:Train Epoch: 38 [38/40 (95%)] Loss: 270.148132
INFO:trainer:    epoch          : 38
INFO:trainer:    loss           : 293.718037655479
INFO:trainer:    bias_avg       : -0.00560365135683433
INFO:trainer:    bias_std       : 17.08807699303878
INFO:trainer:    val_loss       : 293.2283533999794
INFO:trainer:    val_bias_avg   : 0.07072696654971591
INFO:trainer:    val_bias_std   : 17.08872810162996
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch38.pth ...
DEBUG:trainer:Train Epoch: 39 [39/40 (98%)] Loss: 338.097412
DEBUG:trainer:Train Epoch: 39 [39/40 (98%)] Loss: 267.097961
INFO:trainer:    epoch          : 39
INFO:trainer:    loss           : 294.4352682013261
INFO:trainer:    bias_avg       : -0.00278077343184697
INFO:trainer:    bias_std       : 17.11490861993087
INFO:trainer:    val_loss       : 292.9497295178865
INFO:trainer:    val_bias_avg   : -0.0015768142613141161
INFO:trainer:    val_bias_std   : 17.072819559197676
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch39.pth ...
DEBUG:trainer:Train Epoch: 40 [40/40 (100%)] Loss: 259.920715
DEBUG:trainer:Train Epoch: 40 [40/40 (100%)] Loss: 276.547882
INFO:trainer:    epoch          : 40
INFO:trainer:    loss           : 289.1042906108655
INFO:trainer:    bias_avg       : 0.045286898501217365
INFO:trainer:    bias_std       : 16.94408466941432
INFO:trainer:    val_loss       : 292.2644781815378
INFO:trainer:    val_bias_avg   : -0.07785176412251435
INFO:trainer:    val_bias_std   : 17.066685074254085
INFO:trainer:Saving checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch40.pth ...
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)

tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
Working on epoch num: 1...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch1.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.91s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -88060430.152, Bias: 29749799.144
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['30614.719', '-52417.851', '19019.846', '156826.566', '316424.779', '439975.407', '551743.122', '594688.507', '629251.004', '634346.559', '574993.905', '527152.719',
'463494.796', '414410.547', '365130.067', '284798.871', '213495.286', '167113.679', '134647.871', '75389.109', '39479.458', '7448.076', '-13433.253', '-32119.368', '-42480.321',
'-42147.594', '-62692.255', '-7588.656', '27259.135', '41666.452', '64011.659', '5563.011', '-952.895', '15975.899', '56.965', '-4087.644', '-9657.409', '-7079.760', '8053.008',
'2091.171', '-13566.875', '8946.932', '1258.075', '13947.942', '8674.383', '-5093.083', '7910.655', '118.545']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 6552661.760458725, target N: 9146934.0
Mean E: 3.8952832700908324, target E: 4.284735279602979
INFO:test:{'loss': 45374.058516221376, 'bias_avg': 82.51502266221374, 'bias_std': 196.00093034351144}
Working on epoch num: 10...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch10.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:15<00:15, 15.08s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.76s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117962095.491, Bias: -151866.194
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16099.171', '62350.584', '153664.994', '280262.835', '406353.884', '505885.221', '577319.132', '619604.921', '639182.467', '638439.615', '617115.838', '586488.429',
'546846.819', '501155.048', '453572.815', '405141.588', '357974.271', '309928.356', '268552.463', '227812.068', '192975.677', '160752.520', '133756.872', '109874.674', '89334.649
', '71245.387', '55974.788', '43874.690', '34612.318', '25919.592', '19806.056', '14092.081', '9603.615', '7028.334', '5544.556', '3344.531', '2265.056', '691.124', '793.962', '3
58.962', '170.973', '221.262', '180.856', '27.276', '-26.370', '1.608', '2.337', '1644.383']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9157822.287723985, target N: 9146934.0
Mean E: 4.287116005794196, target E: 4.284735279602979
INFO:test:{'loss': 326.09072451991887, 'bias_avg': -0.34631960337398615, 'bias_std': 18.0243320610687}
Working on epoch num: 11...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch11.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.85s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.65s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -118070592.059, Bias: -260362.763
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16917.566', '63123.361', '154122.085', '279239.743', '406442.350', '508543.764', '577392.444', '620800.913', '639859.923', '636663.444', '619334.726', '588538.566',
'546933.540', '501597.240', '453447.052', '404574.401', '355674.224', '309723.402', '267113.522', '228472.729', '193309.724', '161750.089', '133746.461', '110685.030', '89131.032
', '72155.847', '56584.212', '44376.329', '34106.838', '25889.913', '19692.381', '14007.470', '10559.671', '6637.952', '5195.799', '3644.426', '1836.886', '1275.912', '614.307',
'320.311', '88.594', '67.802', '-25.846', '-9.186', '24.820', '5.947', '-8.031', '1660.224']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9165839.90917183, target N: 9146934.0
Mean E: 4.286402182675659, target E: 4.284735279602979
INFO:test:{'loss': 324.5333508673515, 'bias_avg': -0.601332989175811, 'bias_std': 17.9759974355916}
Working on epoch num: 12...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch12.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.85s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.64s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117870670.074, Bias: -60440.778
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16987.072', '63278.467', '154909.462', '278278.046', '405907.007', '506980.169', '577413.610', '619361.951', '638522.465', '637765.869', '616962.586', '585337.736',
'547814.470', '499685.232', '453517.464', '403473.629', '356933.563', '310188.582', '266308.639', '228581.159', '192644.939', '159970.164', '133617.147', '110174.000', '88594.857
', '71736.813', '56203.534', '44939.195', '34158.122', '26336.029', '19236.684', '14814.197', '10177.336', '6820.103', '4226.168', '3222.316', '1736.108', '1499.253', '485.214',
'511.639', '164.030', '49.440', '144.197', '21.067', '-9.024', '6.952', '-10.109', '1784.107']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9151461.65495013, target N: 9146934.0
Mean E: 4.285690634769003, target E: 4.284735279602979
INFO:test:{'loss': 324.3267278074308, 'bias_avg': -0.14400937611820133, 'bias_std': 17.977296040076336}
Working on epoch num: 13...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch13.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:15<00:15, 15.03s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.73s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117459229.450, Bias: 350999.847
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16361.722', '62454.339', '153462.478', '277655.495', '405434.852', '507929.570', '575996.938', '616704.616', '639561.532', '633208.894', '616787.847', '582954.047',
'544179.983', '498839.349', '451212.443', '402256.488', '354093.490', '308849.700', '265877.476', '226426.038', '191876.032', '159693.184', '132583.871', '107922.860', '88790.938
', '72148.580', '56198.264', '44369.105', '33971.227', '26381.613', '19707.859', '14912.829', '10795.579', '7937.912', '5093.390', '3187.281', '2263.916', '557.982', '799.228', '
358.883', '243.266', '244.552', '161.437', '32.468', '5.194', '3.744', '-5.833', '1814.306']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9122296.96497072, target N: 9146934.0
Mean E: 4.28646814528769, target E: 4.284735279602979
INFO:test:{'loss': 329.0282139435979, 'bias_avg': 0.7836207731989504, 'bias_std': 18.088410961354963}
Working on epoch num: 14...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch14.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:15<00:15, 15.08s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.76s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -118073957.997, Bias: -263728.700
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16582.754', '62219.186', '154074.631', '279725.582', '407603.307', '510357.580', '577063.538', '620302.672', '640792.040', '639519.558', '619091.126', '585947.935',
'547680.186', '501105.244', '452939.646', '403348.378', '355085.735', '309971.161', '267654.825', '229034.625', '192719.482', '161571.146', '133516.856', '109706.006', '89161.367
', '71441.734', '56428.771', '44899.798', '34425.246', '25437.008', '19603.251', '12995.334', '10749.135', '7624.957', '5494.182', '3860.923', '2232.008', '749.034', '987.784', '
-14.784', '82.171', '31.123', '22.318', '18.740', '5.856', '-0.333', '1.216', '2155.386']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9166005.42225512, target N: 9146934.0
Mean E: 4.285379369533113, target E: 4.284735279602979
INFO:test:{'loss': 325.00172366076754, 'bias_avg': -0.6065973878816794, 'bias_std': 17.988220121660305}
Working on epoch num: 15...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch15.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.90s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117733927.938, Bias: 76301.358
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15626.059', '62142.281', '154192.485', '281189.409', '404917.913', '507985.997', '574103.541', '619314.786', '639103.135', '636831.337', '617374.586', '586051.627',
'544264.142', '499231.791', '453773.791', '403053.418', '356438.903', '309922.652', '266734.765', '228171.562', '191843.399', '161641.139', '133104.741', '108841.813', '88165.395
', '70995.107', '55942.164', '45535.594', '33875.750', '25630.775', '19269.136', '14068.324', '9821.622', '6781.230', '4466.000', '3245.318', '1714.504', '1857.877', '907.570', '
152.570', '111.668', '65.028', '313.819', '-9.561', '56.962', '-0.633', '9.547', '2396.979']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9141228.016510732, target N: 9146934.0
Mean E: 4.28490198100596, target E: 4.284735279602979
INFO:test:{'loss': 326.16983978038525, 'bias_avg': 0.18148801381351384, 'bias_std': 18.030228709446565}
Working on epoch num: 16...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch16.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:15<00:15, 15.00s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.72s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117796095.034, Bias: 14134.262
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16631.158', '62835.197', '154281.868', '278929.462', '405984.957', '506532.665', '577413.891', '618980.931', '639436.789', '637057.643', '617463.886', '585470.093',
'546884.849', '500076.194', '451992.217', '403250.107', '355020.047', '309181.889', '267598.657', '227808.916', '192333.155', '160519.085', '133523.169', '109560.047', '88986.672
', '71307.440', '56592.582', '43865.065', '34845.151', '26027.822', '19435.417', '14262.478', '10436.261', '7198.329', '4677.804', '3322.454', '1991.265', '1021.260', '738.673',
'192.331', '188.862', '74.631', '198.134', '6.430', '-16.702', '3.871', '-3.627', '1918.207']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9146037.684240494, target N: 9146934.0
Mean E: 4.285541033550416, target E: 4.284735279602979
INFO:test:{'loss': 321.6182595988266, 'bias_avg': 0.02850876145690452, 'bias_std': 17.902600190839696}
Working on epoch num: 17...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch17.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.88s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.66s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117713928.200, Bias: 96301.097
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16564.493', '62676.336', '154371.044', '279289.176', '405966.902', '506872.101', '576862.806', '618612.139', '639043.786', '636308.297', '616903.085', '585871.498',
'545710.131', '499526.239', '452372.829', '403340.430', '355151.088', '308815.975', '266666.776', '227333.547', '191935.454', '160529.662', '133113.866', '109298.086', '88592.572
', '71238.206', '56234.376', '44515.060', '34199.732', '25740.970', '19405.305', '14052.691', '10261.063', '7317.631', '4775.038', '3297.855', '2409.062', '1339.300', '753.682',
'490.647', '255.313', '77.729', '88.716', '33.530', '-1.774', '3.199', '-3.015', '2216.878']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9140429.512748694, target N: 9146934.0
Mean E: 4.285106763874806, target E: 4.284735279602979
INFO:test:{'loss': 321.86568892384304, 'bias_avg': 0.20688572075530773, 'bias_std': 17.9091901240458}
Working on epoch num: 18...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch18.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.90s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117650609.061, Bias: 159620.235
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16700.341', '62523.990', '153964.638', '279147.073', '405249.988', '505953.512', '576179.067', '618313.774', '638389.431', '635937.331', '616701.565', '585439.882',
'545399.852', '499715.700', '452096.394', '402716.410', '355240.536', '309007.861', '267033.411', '227503.974', '192160.767', '160588.449', '133402.118', '109111.429', '88816.758
', '70827.738', '56308.004', '44250.193', '34190.666', '25842.279', '19556.607', '14776.883', '10560.021', '6919.502', '5263.735', '3297.417', '2114.822', '1332.359', '755.295',
'233.543', '232.727', '152.134', '53.381', '1.022', '2.080', '3.911', '-0.215', '1972.498']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9135940.851302207, target N: 9146934.0
Mean E: 4.286272434775675, target E: 4.284735279602979
INFO:test:{'loss': 322.5251031074815, 'bias_avg': 0.3496548718168535, 'bias_std': 17.924563156011452}
Working on epoch num: 19...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch19.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.92s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.68s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117590434.426, Bias: 219794.871
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16331.664', '62363.704', '153993.474', '278881.855', '405505.713', '506357.559', '576104.263', '618077.557', '638459.397', '635730.112', '616251.951', '584893.696',
'545068.072', '499127.759', '452331.804', '402909.435', '354855.365', '308903.986', '266826.153', '227084.215', '191706.973', '160418.468', '132972.284', '109318.745', '88630.309
', '71107.037', '56018.751', '44249.013', '34149.615', '25674.308', '19239.000', '14519.156', '10563.931', '7225.129', '5203.717', '3266.705', '2142.007', '1258.515', '786.802',
'373.409', '256.687', '83.085', '56.298', '15.506', '-2.499', '2.775', '-3.882', '2160.360']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9131449.939544639, target N: 9146934.0
Mean E: 4.285666394664998, target E: 4.284735279602979
INFO:test:{'loss': 323.30508299383496, 'bias_avg': 0.49249556446803433, 'bias_std': 17.943105916030536}
Working on epoch num: 2...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch2.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.99s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.71s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -120266927.355, Bias: -2456698.059
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['8277.813', '69879.008', '198362.694', '316137.018', '426097.219', '515201.678', '558273.108', '592425.429', '595191.964', '590423.173', '585398.471', '564668.688', '
537128.344', '494588.428', '450337.426', '408855.301', '382575.149', '333418.823', '284279.435', '265314.868', '234655.297', '206044.528', '171336.826', '141002.308', '109709.498
', '70376.342', '60535.307', '30533.223', '39675.471', '37316.007', '21950.374', '9389.888', '4472.018', '3689.544', '2849.553', '7893.136', '-2820.439', '-193.409', '6435.239',
'528.996', '-3505.060', '-1188.620', '-134.716', '4449.678', '695.270', '-4191.814', '1581.449', '7257.190']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9337177.120010208, target N: 9146934.0
Mean E: 4.336901156996866, target E: 4.284735279602979
INFO:test:{'loss': 4068.630362520873, 'bias_avg': -6.050989980916031, 'bias_std': 63.40690601145038}
Working on epoch num: 20...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch20.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.90s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117723756.815, Bias: 86472.482
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16262.983', '62637.141', '154503.907', '279464.336', '405850.633', '506581.089', '576346.966', '618636.463', '638753.766', '636369.141', '617189.067', '585513.058',
'546119.468', '499653.450', '452338.689', '403438.688', '355466.380', '309219.150', '267080.152', '227827.369', '191994.799', '160784.390', '133569.561', '109278.166', '88880.759
', '71198.336', '56434.322', '44074.721', '34303.954', '26012.736', '19247.456', '13894.083', '10008.125', '7105.405', '4684.600', '3122.078', '1971.644', '1413.397', '702.873',
'282.074', '187.528', '35.383', '33.772', '1.344', '-3.482', '1.125', '-0.302', '2027.006']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9140497.750423476, target N: 9146934.0
Mean E: 4.284840642015388, target E: 4.284735279602979
INFO:test:{'loss': 321.49581701846523, 'bias_avg': 0.2047152919623688, 'bias_std': 17.898316734255726}
Working on epoch num: 21...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch21.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:15<00:15, 15.08s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.77s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117724571.010, Bias: 85658.286
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16046.124', '62387.142', '153932.757', '279066.937', '405727.464', '506508.531', '576861.563', '618889.805', '638917.959', '637025.232', '617213.825', '585540.146',
'545551.527', '499771.679', '452369.515', '403479.919', '355413.103', '308861.401', '267083.882', '227463.440', '191927.684', '160456.458', '133343.258', '109378.375', '88716.670
', '71054.272', '56085.232', '44421.966', '34229.011', '25744.808', '19540.521', '14554.940', '10764.305', '7801.633', '4285.043', '3496.998', '2043.851', '1431.005', '751.746',
'455.212', '218.635', '43.294', '53.875', '20.585', '-7.396', '-1.626', '1.012', '2176.387']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9141099.703527872, target N: 9146934.0
Mean E: 4.28613419612978, target E: 4.284735279602979
INFO:test:{'loss': 322.0425837625984, 'bias_avg': 0.18556921573085638, 'bias_std': 17.913786677003817}
Working on epoch num: 22...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch22.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.90s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117718631.175, Bias: 91598.121
KL dist - KL1(q=target): -5910.075, KL2(q=output): 6174.728, Symmetric: 264.653
total out: ['16040.454', '62615.201', '154483.851', '279611.685', '405859.513', '506382.324', '576317.167', '618487.277', '638915.977', '635818.285', '616987.776', '585855.736',
'545888.383', '499447.128', '452120.525', '403006.917', '355065.283', '309119.403', '267099.270', '227511.470', '192031.741', '160855.638', '133357.864', '109427.185', '88972.822
', '71400.353', '56533.412', '44393.814', '34353.366', '25746.061', '19604.218', '14865.477', '10482.154', '7047.814', '4814.793', '3160.340', '2150.762', '1452.183', '809.411',
'485.559', '205.823', '62.361', '41.499', '4.120', '11.691', '2.613', '0.170', '1980.652']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9140887.52409089, target N: 9146934.0
Mean E: 4.286492472839537, target E: 4.284735279602979
INFO:test:{'loss': 321.7945293164435, 'bias_avg': 0.1923179568225191, 'bias_std': 17.90737267414122}
Working on epoch num: 23...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch23.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.92s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.68s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117759910.622, Bias: 50318.675
KL dist - KL1(q=target): -3089.055, KL2(q=output): 3476.855, Symmetric: 387.800
total out: ['15928.439', '62570.178', '154320.074', '279406.202', '405956.477', '506618.549', '577145.644', '618994.405', '638870.090', '636661.846', '617200.618', '585831.824',
'545678.303', '499819.951', '452431.200', '403573.092', '355584.958', '309237.059', '267032.115', '227758.263', '192057.867', '160555.940', '133454.152', '109293.366', '88779.266
', '71127.456', '56322.488', '44435.882', '34132.176', '26058.626', '19742.328', '13952.350', '10545.420', '7220.966', '4654.305', '3328.301', '2066.929', '1340.950', '639.160',
'598.430', '196.685', '150.990', '71.542', '10.631', '14.059', '1.646', '1.290', '2256.248']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9143628.737187546, target N: 9146934.0
Mean E: 4.285773327348866, target E: 4.284735279602979
INFO:test:{'loss': 321.53958008744337, 'bias_avg': 0.1051292244714635, 'bias_std': 17.900411498091604}
Working on epoch num: 24...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch24.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.82s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.63s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117915841.249, Bias: -105611.952
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16079.328', '62637.129', '154349.151', '279906.361', '406166.113', '507109.159', '577471.478', '619363.053', '639722.189', '637370.457', '618252.144', '586554.643',
'546891.025', '500633.862', '453326.335', '403858.310', '355621.891', '309604.458', '267708.778', '227906.023', '192471.295', '160862.603', '133437.901', '109363.855', '88990.256
', '71368.799', '56315.768', '44133.550', '34586.942', '26117.217', '19134.328', '14422.044', '10599.611', '7187.912', '4995.996', '3299.963', '2273.757', '1145.269', '850.270',
'399.445', '275.665', '76.477', '38.321', '-2.889', '9.315', '2.903', '-3.320', '1928.811']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9154813.94980783, target N: 9146934.0
Mean E: 4.286246202918133, target E: 4.284735279602979
INFO:test:{'loss': 321.75467359237086, 'bias_avg': -0.25063455596224954, 'bias_std': 17.90545234971374}
Working on epoch num: 25...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch25.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.91s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117801214.491, Bias: 9014.805
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16079.176', '62564.734', '154447.127', '279464.030', '405983.875', '506879.714', '576878.929', '619265.108', '639357.940', '636660.538', '617138.306', '586254.621',
'546212.204', '499721.308', '452888.174', '403443.904', '355800.061', '309033.866', '267042.536', '227664.036', '192064.319', '160682.317', '133236.526', '109388.716', '88810.944
', '71240.273', '56426.771', '44523.131', '34206.851', '25847.411', '19721.377', '14427.384', '10332.313', '7265.430', '5071.996', '3308.615', '2251.814', '1531.532', '732.215',
'515.590', '231.197', '107.956', '41.823', '19.268', '6.137', '3.358', '-1.990', '2091.159']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9146864.619659107, target N: 9146934.0
Mean E: 4.286361121120218, target E: 4.284735279602979
INFO:test:{'loss': 321.500956761018, 'bias_avg': 0.0022067568684352263, 'bias_std': 17.900638120229008}
Working on epoch num: 26...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch26.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.98s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.70s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117679590.613, Bias: 130638.684
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15987.758', '62716.851', '154087.137', '279238.283', '405743.117', '506391.955', '576626.359', '618220.540', '638936.007', '636194.899', '617194.993', '585572.526',
'545170.652', '499864.454', '451770.727', '403151.003', '354936.826', '308886.849', '266990.507', '227437.901', '192127.379', '160426.301', '133383.076', '109351.010', '88760.982
', '71436.000', '56329.816', '44457.808', '34709.063', '25771.942', '19878.284', '13993.511', '10153.673', '7172.918', '4331.920', '3303.677', '1961.310', '1452.358', '769.720',
'499.482', '167.422', '129.070', '63.633', '11.843', '7.598', '2.424', '-0.748', '1867.722']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9137638.535997195, target N: 9146934.0
Mean E: 4.285807461551029, target E: 4.284735279602979
INFO:test:{'loss': 322.1329770386674, 'bias_avg': 0.2956572321535067, 'bias_std': 17.914389014790075}
Working on epoch num: 27...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch27.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.87s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.66s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117784000.528, Bias: 26228.768
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15765.518', '62576.244', '154411.400', '279260.574', '405910.210', '506941.421', '576979.675', '618907.535', '639027.520', '637049.690', '616953.219', '586391.285',
'546389.093', '499734.299', '453086.387', '403476.900', '355681.551', '309527.647', '267269.819', '227677.186', '192166.374', '160692.272', '133286.957', '109390.313', '88744.670
', '70915.236', '56097.377', '44196.464', '33847.042', '25790.081', '19221.200', '14472.206', '10083.409', '7463.666', '5173.196', '3361.790', '2277.161', '1342.823', '809.898',
'226.799', '250.103', '100.288', '-3.975', '17.957', '5.582', '3.096', '-2.445', '2171.711']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9145118.426277908, target N: 9146934.0
Mean E: 4.285603434534097, target E: 4.284735279602979
INFO:test:{'loss': 321.4363553578617, 'bias_avg': 0.05774724829287929, 'bias_std': 17.898829615935114}
Working on epoch num: 28...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch28.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.86s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.66s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117571074.808, Bias: 239154.488
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15995.637', '62643.056', '153914.300', '279268.897', '405573.668', '505938.904', '575786.586', '618137.439', '638489.495', '635564.407', '616571.148', '584615.916',
'545569.641', '499440.577', '451782.809', '402880.817', '354881.186', '308417.218', '266800.965', '227289.367', '191761.255', '160293.924', '133179.220', '109038.853', '88763.697
', '71177.386', '56186.266', '43784.118', '34241.380', '25778.006', '19499.973', '14214.740', '10111.801', '7453.357', '4920.734', '2981.348', '2024.360', '1285.962', '625.912',
'337.324', '151.945', '138.896', '62.320', '7.047', '8.793', '0.656', '-1.301', '1950.766']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9129540.770841708, target N: 9146934.0
Mean E: 4.284996312827878, target E: 4.284735279602979
INFO:test:{'loss': 322.5752593295265, 'bias_avg': 0.5532197675632157, 'bias_std': 17.92049439408397}
Working on epoch num: 29...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch29.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.96s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.70s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117668821.740, Bias: 141407.557
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15969.757', '62703.224', '154267.981', '279112.626', '405393.746', '506436.982', '576689.243', '618562.938', '638652.124', '636151.659', '616552.164', '585473.747',
'545223.228', '499272.110', '452117.535', '402827.174', '355128.346', '309045.963', '266887.559', '227303.521', '192029.010', '160458.204', '133394.877', '109386.703', '88698.760
', '71077.390', '56343.885', '44618.436', '34157.090', '25955.388', '19373.674', '14329.018', '10172.107', '7477.394', '5253.574', '3624.482', '2332.051', '1065.188', '813.627',
'456.687', '282.929', '74.700', '28.504', '11.558', '1.799', '4.724', '-3.567', '2180.077']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9137369.89415954, target N: 9146934.0
Mean E: 4.28634163472562, target E: 4.284735279602979
INFO:test:{'loss': 322.1617532977621, 'bias_avg': 0.3042018511823115, 'bias_std': 17.915460997137405}
Working on epoch num: 3...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch3.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:15<00:15, 15.14s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.80s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -119946486.444, Bias: -2136257.148
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['21319.945', '80917.049', '156700.183', '289349.109', '424321.218', '526641.079', '602064.356', '647978.870', '673883.390', '666363.943', '637410.288', '596949.362',
'550178.713', '500266.625', '449849.784', '402912.224', '342939.635', '298266.881', '265284.347', '208584.979', '171094.076', '139596.355', '122937.271', '106706.245', '94282.296
', '83680.219', '69709.498', '39246.285', '33967.273', '28730.503', '16880.673', '13255.890', '11307.103', '5315.612', '4602.461', '4213.078', '831.514', '2511.980', '2284.774',
'-407.604', '-670.993', '-323.096', '-412.964', '1580.243', '-1024.630', '-1281.301', '-609.278', '3142.699']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9293328.164701402, target N: 9146934.0
Mean E: 4.238994637516632, target E: 4.284735279602979
INFO:test:{'loss': 1235.4145515267176, 'bias_avg': -4.656302928196565, 'bias_std': 34.81577409351145}
Working on epoch num: 30...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch30.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.83s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.64s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117669373.170, Bias: 140856.127
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16361.877', '62526.567', '154076.290', '279091.158', '405577.637', '506356.331', '576458.485', '618816.299', '638642.825', '636339.164', '616955.649', '585423.826',
'545635.147', '499944.246', '452140.379', '403193.209', '354970.054', '308608.706', '266481.208', '227625.776', '191999.574', '160418.185', '133243.704', '109053.902', '88574.834
', '71007.475', '56104.513', '43811.224', '34036.075', '25806.491', '19526.611', '13925.422', '10553.230', '7427.469', '5606.644', '3658.413', '2296.049', '1304.324', '785.105',
'473.742', '170.848', '112.052', '19.348', '-1.500', '-3.654', '3.648', '-2.292', '2152.943']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9137289.212186953, target N: 9146934.0
Mean E: 4.285798778158458, target E: 4.284735279602979
INFO:test:{'loss': 321.4845472728933, 'bias_avg': 0.3067680766564289, 'bias_std': 17.896382991412214}
Working on epoch num: 31...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch31.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.97s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.70s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117800706.731, Bias: 9522.566
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16398.647', '62696.807', '154169.539', '279389.434', '405968.389', '506890.020', '577018.250', '619280.135', '639455.036', '636905.540', '617565.596', '586125.032',
'546005.040', '500350.090', '452860.349', '403770.714', '355477.313', '309081.048', '267166.318', '227720.194', '192095.585', '160572.529', '133473.773', '109180.072', '88731.256
', '71150.285', '56197.730', '44213.146', '34270.770', '25879.192', '19515.148', '14417.123', '10215.798', '7028.207', '5046.825', '3133.029', '2020.525', '1280.098', '743.903',
'394.765', '240.958', '88.613', '32.615', '23.785', '0.971', '0.829', '-1.474', '2054.305']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9146293.856637247, target N: 9146934.0
Mean E: 4.285163414470766, target E: 4.284735279602979
INFO:test:{'loss': 321.11392402940123, 'bias_avg': 0.020360814160063065, 'bias_std': 17.889351741412213}
Working on epoch num: 32...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch32.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.87s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.65s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117722868.069, Bias: 87361.227
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16455.377', '62670.618', '154120.296', '279242.182', '405634.700', '506598.297', '576821.226', '618732.433', '638875.890', '636419.593', '617002.916', '585859.622',
'545766.456', '499678.420', '452232.375', '403320.999', '355252.527', '309018.605', '266973.677', '227530.088', '191971.804', '160614.474', '133410.095', '109260.128', '88726.861
', '71242.137', '56260.904', '44433.407', '34382.965', '25909.717', '19485.371', '14405.768', '10280.524', '7303.032', '4729.240', '3264.580', '2193.762', '1379.389', '727.168',
'366.393', '235.246', '94.526', '28.590', '4.768', '0.315', '2.965', '-1.521', '2050.480']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9140969.384347912, target N: 9146934.0
Mean E: 4.285723445235299, target E: 4.284735279602979
INFO:test:{'loss': 321.1939020054941, 'bias_avg': 0.18971427160364981, 'bias_std': 17.89033128578244}
Working on epoch num: 33...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch33.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.87s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.65s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117810827.778, Bias: -598.482
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16364.157', '62739.038', '154309.221', '279514.710', '405961.929', '506857.823', '577081.383', '618991.460', '639394.694', '636856.491', '617399.009', '585971.359',
'546184.907', '500062.464', '452653.992', '403547.049', '355592.326', '309263.528', '267232.662', '227728.677', '192249.222', '160709.077', '133474.140', '109364.865', '88932.814
', '71340.983', '56363.664', '44393.431', '34327.631', '25875.230', '19585.601', '14202.999', '10402.537', '7140.997', '4779.065', '3322.752', '2141.851', '1334.196', '751.610',
'402.319', '215.232', '105.915', '36.324', '12.318', '5.217', '1.884', '-0.428', '2166.673']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9147344.998230813, target N: 9146934.0
Mean E: 4.285725794510384, target E: 4.284735279602979
INFO:test:{'loss': 321.0870869410857, 'bias_avg': -0.013072456476342587, 'bias_std': 17.888399033874045}
Working on epoch num: 34...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch34.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.97s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.71s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117746064.678, Bias: 64164.619
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16442.663', '62634.399', '154287.085', '279529.753', '405849.994', '506546.140', '576899.432', '618782.643', '639007.623', '636508.288', '616951.583', '585814.689',
'545848.084', '499896.980', '452282.435', '403437.884', '355440.002', '309015.697', '267132.147', '227620.733', '192089.471', '160619.221', '133423.558', '109334.530', '88753.075
', '71222.780', '56349.840', '44178.391', '34319.024', '25859.739', '19465.889', '14433.208', '10197.657', '7226.891', '4814.475', '3364.270', '2086.431', '1259.594', '743.981',
'404.056', '235.419', '98.600', '34.534', '12.488', '-0.165', '1.703', '-0.972', '2169.001']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9142624.94578044, target N: 9146934.0
Mean E: 4.285454516596082, target E: 4.284735279602979
INFO:test:{'loss': 321.2174590365577, 'bias_avg': 0.13705644680343512, 'bias_std': 17.89146886927481}
Working on epoch num: 35...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch35.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.80s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.62s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117782086.158, Bias: 28143.139
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16357.856', '62639.015', '154240.249', '279435.245', '405842.098', '506712.273', '576874.477', '619051.999', '639148.654', '636691.176', '617289.136', '585930.911',
'546095.899', '500069.418', '452540.042', '403314.315', '355589.397', '309242.493', '267268.907', '227757.363', '192196.483', '160703.394', '133472.086', '109394.112', '88931.845
', '71265.448', '56324.973', '44367.589', '34335.524', '25895.108', '19512.414', '14155.612', '10239.205', '7201.698', '4830.823', '3255.555', '2126.488', '1173.446', '769.392',
'405.571', '216.486', '91.050', '42.198', '14.767', '2.145', '1.180', '-1.324', '2103.974']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9145118.163697686, target N: 9146934.0
Mean E: 4.2856199275024345, target E: 4.284735279602979
INFO:test:{'loss': 320.9800938031146, 'bias_avg': 0.057755611507037216, 'bias_std': 17.88526508826336}
Working on epoch num: 36...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch36.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.87s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.66s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117797116.071, Bias: 13113.225
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16527.228', '62643.001', '154147.262', '279467.262', '406029.652', '506892.963', '576813.810', '618967.000', '639286.063', '636799.394', '617436.116', '586024.001',
'546050.176', '500071.898', '452640.741', '403494.056', '355530.047', '309388.232', '267029.219', '227738.481', '192208.888', '160774.798', '133391.610', '109304.672', '88884.153
', '71287.500', '56367.352', '44320.050', '34279.069', '25935.918', '19467.526', '14304.536', '10445.880', '7081.585', '4980.244', '3259.097', '2081.892', '1335.288', '733.456',
'394.004', '232.607', '82.282', '23.831', '12.461', '3.204', '5.244', '-2.797', '2164.491']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9146335.441625554, target N: 9146934.0
Mean E: 4.28565644071365, target E: 4.284735279602979
INFO:test:{'loss': 320.9186952081345, 'bias_avg': 0.01903811010695596, 'bias_std': 17.883790553435116}
Working on epoch num: 37...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch37.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.91s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.68s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117735207.622, Bias: 75021.675
KL dist - KL1(q=target): -4987.013, KL2(q=output): 5061.590, Symmetric: 74.577
total out: ['16403.771', '62654.300', '154325.648', '279221.358', '405710.651', '506640.810', '576691.860', '618817.418', '639058.183', '636374.209', '617120.891', '585720.053',
'545909.353', '499764.870', '452305.123', '403250.558', '355336.110', '309133.887', '266958.718', '227528.366', '192073.828', '160646.179', '133432.033', '109372.582', '88761.745
', '71243.005', '56286.328', '44207.114', '34318.930', '25889.516', '19534.607', '14310.208', '10196.492', '7207.891', '5097.700', '3302.827', '2143.659', '1313.395', '735.615',
'411.971', '227.765', '68.516', '26.126', '19.103', '3.398', '1.513', '1.004', '2143.243']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9141902.432952318, target N: 9146934.0
Mean E: 4.285681046487339, target E: 4.284735279602979
INFO:test:{'loss': 320.98787594860744, 'bias_avg': 0.16003714990979842, 'bias_std': 17.88473282442748}
Working on epoch num: 38...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch38.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.91s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117743157.921, Bias: 67071.375
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16359.253', '62604.257', '154268.778', '279417.496', '405874.373', '506707.456', '576852.351', '618926.802', '639037.450', '636426.126', '617081.428', '585818.734',
'545891.154', '499721.020', '452336.315', '403328.753', '355440.113', '309080.357', '267074.976', '227666.625', '192076.591', '160657.844', '133480.276', '109270.667', '88747.720
', '71251.306', '56336.285', '44322.263', '34326.212', '25888.285', '19546.779', '14092.293', '10355.380', '7090.025', '4854.744', '3220.858', '2025.226', '1297.421', '701.827',
'363.500', '193.641', '65.166', '19.593', '10.946', '-0.063', '2.607', '-2.061', '2064.698']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9142173.8453321, target N: 9146934.0
Mean E: 4.285247379654171, target E: 4.284735279602979
INFO:test:{'loss': 321.0402528020262, 'bias_avg': 0.15140441428614027, 'bias_std': 17.886395217080153}
Working on epoch num: 39...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch39.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.95s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.70s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117774357.017, Bias: 35872.280
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16350.154', '62678.009', '154201.556', '279360.276', '405718.938', '506973.395', '576835.169', '618949.137', '639248.120', '636735.456', '617417.915', '586065.653',
'545951.795', '499912.475', '452511.395', '403411.285', '355342.272', '309100.818', '267033.602', '227652.284', '192145.387', '160665.298', '133393.434', '109262.214', '88874.476
', '71218.149', '56270.886', '44279.576', '34271.308', '25914.384', '19382.603', '14522.556', '10363.190', '7382.249', '4906.829', '3243.887', '2183.716', '1264.547', '787.216',
'389.285', '238.927', '88.914', '33.703', '10.675', '-1.589', '2.506', '-2.993', '2184.467']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9144725.50146513, target N: 9146934.0
Mean E: 4.285712420334183, target E: 4.284735279602979
INFO:test:{'loss': 320.8845988266341, 'bias_avg': 0.0702448429952141, 'bias_std': 17.88274689885496}
Working on epoch num: 4...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch4.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.89s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117635533.561, Bias: 174695.736
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15173.947', '60315.980', '151065.032', '282572.876', '412007.158', '516240.088', '586242.451', '627812.338', '643625.014', '639343.583', '619685.511', '588331.421',
'545516.858', '497395.537', '448653.868', '396919.571', '352825.963', '303824.673', '260022.254', '227431.081', '193786.320', '159921.499', '126338.709', '100903.671', '80424.108
', '69585.692', '51778.533', '42546.101', '34817.273', '27848.485', '16167.475', '16317.850', '12498.250', '7206.549', '5390.952', '2514.649', '1022.141', '516.479', '1589.628',
'684.018', '619.033', '617.505', '144.781', '381.428', '396.747', '-151.420', '0.255', '952.283']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9129824.200257098, target N: 9146934.0
Mean E: 4.269279324830812, target E: 4.284735279602979
INFO:test:{'loss': 563.3784454112745, 'bias_avg': 0.5442048283933684, 'bias_std': 23.721066913167938}
Working on epoch num: 40...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch40.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:15<00:15, 15.08s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.76s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117815739.626, Bias: -5510.330
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16423.999', '62632.336', '154212.489', '279457.362', '406023.083', '507149.668', '577152.997', '619100.451', '639244.514', '636883.236', '617554.434', '586196.627',
'546284.922', '499980.641', '452678.739', '403604.974', '355545.214', '309235.045', '267281.691', '227733.105', '192193.445', '160690.720', '133480.530', '109402.218', '88849.254
', '71335.593', '56408.792', '44424.069', '34332.006', '25964.497', '19564.918', '13999.443', '10259.218', '7274.103', '4750.462', '3302.253', '2051.568', '1205.979', '756.808',
'328.048', '204.665', '100.625', '35.952', '14.774', '1.603', '0.735', '-1.177', '2190.906']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9147497.531661484, target N: 9146934.0
Mean E: 4.285347975875039, target E: 4.284735279602979
INFO:test:{'loss': 320.78347640874733, 'bias_avg': -0.0179240292265215, 'bias_std': 17.88005427003817}
Working on epoch num: 5...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch5.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.88s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.66s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117850101.353, Bias: -39872.057
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['17244.649', '61013.314', '156688.824', '278475.719', '402204.073', '504504.435', '572977.461', '615415.069', '634715.494', '633077.117', '614787.706', '585604.516',
'548823.556', '500302.301', '453782.336', '404721.590', '358449.030', '312233.940', '269518.642', '231027.344', '195116.811', '164400.038', '138193.660', '111309.522', '88611.014
', '69513.974', '53179.800', '43264.635', '36593.898', '27443.439', '19735.249', '15563.388', '11577.017', '7442.778', '4806.033', '3597.650', '1532.465', '901.876', '975.542', '
-190.638', '13.247', '82.603', '196.707', '37.750', '98.222', '2.917', '-257.227', '2582.975']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9151892.457929641, target N: 9146934.0
Mean E: 4.294224063175057, target E: 4.284735279602979
INFO:test:{'loss': 468.58326313513834, 'bias_avg': -0.15771181528804867, 'bias_std': 21.634773079675572}
Working on epoch num: 6...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch6.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.99s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.72s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117775431.985, Bias: 34797.312
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['17135.611', '61518.580', '155206.482', '278851.436', '407095.488', '506791.441', '577942.811', '619384.898', '640283.425', '638754.957', '618305.557', '587376.564',
'544788.379', '499921.869', '451328.404', '402370.385', '354118.084', '308319.875', '267069.385', '225693.718', '191229.545', '159974.161', '133110.506', '110010.507', '89507.006
', '70267.173', '55036.483', '44281.004', '35167.976', '26102.221', '19405.840', '14562.603', '10976.620', '7608.427', '4875.100', '3466.542', '2067.400', '1081.715', '350.861',
'750.391', '362.455', '177.966', '146.746', '-83.510', '-12.499', '91.840', '-22.070', '1968.495']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9144718.8500861, target N: 9146934.0
Mean E: 4.284356481958015, target E: 4.284735279602979
INFO:test:{'loss': 391.36651210639315, 'bias_avg': 0.07045639853441078, 'bias_std': 19.76541030534351}
Working on epoch num: 7...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch7.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in multiply
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:15<00:15, 15.06s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.74s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117730260.785, Bias: 79968.511
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16683.164', '63040.160', '155041.144', '280835.707', '409282.336', '509554.784', '579199.674', '619501.355', '640711.475', '638154.386', '616080.433', '585338.849',
'544450.681', '498046.287', '450082.337', '400441.102', '353352.565', '307802.649', '264979.782', '227318.142', '191644.886', '159586.773', '132041.822', '109631.132', '88597.106
', '70899.338', '55764.307', '45100.915', '34691.496', '26329.395', '19312.475', '14572.426', '11266.388', '7017.873', '5336.147', '2695.815', '2141.538', '1305.582', '1061.993',
 '677.390', '137.604', '162.459', '-84.168', '46.263', '-40.883', '-27.819', '-37.496', '1801.184']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9141528.952047354, target N: 9146934.0
Mean E: 4.281915026605319, target E: 4.284735279602979
INFO:test:{'loss': 340.07215995497376, 'bias_avg': 0.17191629191391342, 'bias_std': 18.41376133110687}
Working on epoch num: 8...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch8.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.94s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.69s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117826101.079, Bias: -15871.782
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['17423.162', '62727.970', '153242.395', '279354.734', '405746.739', '507023.335', '574859.467', '618791.382', '639553.595', '636806.203', '618677.187', '586610.374',
'546780.873', '501244.770', '453497.654', '404631.145', '357043.661', '308531.485', '266938.293', '228403.586', '192033.089', '160417.763', '132311.406', '108133.927', '88627.485
', '70127.098', '55630.780', '44734.562', '34459.047', '26674.538', '19235.759', '14844.884', '10528.187', '7419.689', '5354.952', '3584.917', '2040.069', '914.264', '655.801', '
613.223', '191.626', '94.977', '84.951', '5.967', '9.552', '-49.483', '-9.123', '1873.451']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9148431.364705648, target N: 9146934.0
Mean E: 4.286027226767536, target E: 4.284735279602979
INFO:test:{'loss': 324.67582518599414, 'bias_avg': -0.04762611680358421, 'bias_std': 17.98977516698473}
Working on epoch num: 9...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0213_001524/checkpoint-epoch9.pth ...
  0%|                                                                                                                                                       | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|███████████████████████████████████████████████████████████████████████▌                                                                       | 1/2 [00:14<00:14, 14.85s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.65s/it]
Entopies: True distribution: -117810229.296, Predicted distribution: -117948560.529, Bias: -138331.233
KL dist - KL1(q=target): 11046.433, KL2(q=output): -9419.288, Symmetric: 1627.145
total out: ['16321.061', '63095.309', '154752.621', '279044.783', '404635.717', '506104.481', '578809.690', '618492.801', '641297.422', '636894.984', '619556.545', '586720.748',
'548186.088', '500596.371', '453550.352', '402861.238', '355924.450', '309689.403', '268621.023', '227622.668', '192119.089', '161135.300', '134097.452', '109913.631', '89708.185
', '69966.270', '56092.625', '44545.470', '34486.518', '25285.430', '19700.989', '14788.457', '10210.378', '7504.714', '4089.654', '3613.860', '2183.558', '2036.849', '405.720',
'262.131', '110.143', '49.418', '37.277', '59.324', '30.253', '9.271', '11.702', '1815.855']
total target: ['16396.000', '62690.000', '154309.000', '278814.000', '406718.000', '507912.000', '576584.000', '619805.000', '637777.000', '635975.000', '618859.000', '586670.000
', '548003.000', '500837.000', '451438.000', '403483.000', '355625.000', '309395.000', '267119.000', '227076.000', '192112.000', '160766.000', '133145.000', '108596.000', '89125.
000', '70970.000', '56114.000', '44132.000', '34115.000', '25859.000', '19455.000', '14261.000', '10128.000', '7224.000', '5115.000', '3279.000', '2164.000', '1244.000', '742.000
', '386.000', '237.000', '89.000', '32.000', '18.000', '1.000', '2.000', '0.000', '2138.000']
total N: 9157047.276692128, target N: 9146934.0
Mean E: 4.286394720649305, target E: 4.284735279602979
INFO:test:{'loss': 327.64570433638477, 'bias_avg': -0.32166908788317033, 'bias_std': 18.067218809637403}
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)

tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)










