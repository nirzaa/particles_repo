tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
We are using NVIDIA GeForce RTX 3090 Ti
======================================================================
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)








tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
This is the 0 run
==================================================
rm: cannot remove './saved/models/new_model/*': No such file or directory
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)







tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  2621
INFO:train:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
2024-01-30 07:00:35.294663: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following C
PU instructions in performance-critical operations:  AVX2 AVX_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-01-30 07:00:35.369107: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors fro
m different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-01-30 07:00:35.385904: E tensorflow/stream_executor/cuda/cuda_blas.cc:2981] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already be
en registered
2024-01-30 07:00:36.766262: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared o
bject file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64:/usr/local/cuda/lib64:/usr/loca
l/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64::/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student1/anaconda3/li
b/
2024-01-30 07:00:36.766309: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot
 open shared object file: No such file or directory; LD_LIBRARY_PATH: /usr/local/cuda/lib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64:/usr/local/cuda/l
ib64:/usr/local/cuda-11/lib64:/usr/local/cuda-11.7/lib64:/usr/local/cuda-11.8/lib64::/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student1/anaconda3/lib/:/home/student
1/anaconda3/lib/
2024-01-30 07:00:36.766313: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT
, please make sure the missing libraries mentioned above are installed properly.
DEBUG:trainer:Train Epoch: 1 [1/40 (2%)] Loss: 552948.312500
DEBUG:trainer:Train Epoch: 1 [1/40 (2%)] Loss: 78658.906250
INFO:trainer:    epoch          : 1
INFO:trainer:    loss           : 221547.21062911185
INFO:trainer:    bias_avg       : 59.49922215311151
INFO:trainer:    bias_std       : 380.42034550717
INFO:trainer:    val_loss       : 32039.77847450658
INFO:trainer:    val_bias_avg   : 36.753518857454
INFO:trainer:    val_bias_std   : 174.8607860364412
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch1.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 2 [2/40 (5%)] Loss: 28606.099609
DEBUG:trainer:Train Epoch: 2 [2/40 (5%)] Loss: 8222.214844
INFO:trainer:    epoch          : 2
INFO:trainer:    loss           : 12089.335436369243
INFO:trainer:    bias_avg       : 10.558494674532037
INFO:trainer:    bias_std       : 99.29578359503495
INFO:trainer:    val_loss       : 2104.8793881064967
INFO:trainer:    val_bias_avg   : 15.132262681659899
INFO:trainer:    val_bias_std   : 43.2597252695184
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch2.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 3 [3/40 (8%)] Loss: 2108.273926
DEBUG:trainer:Train Epoch: 3 [3/40 (8%)] Loss: 1558.981689
INFO:trainer:    epoch          : 3
INFO:trainer:    loss           : 1778.7709896689967
INFO:trainer:    bias_avg       : 11.351507613533421
INFO:trainer:    bias_std       : 39.879348955656354
INFO:trainer:    val_loss       : 1339.0728759765625
INFO:trainer:    val_bias_avg   : 11.407895991676732
INFO:trainer:    val_bias_std   : 34.734275215550475
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch3.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 4 [4/40 (10%)] Loss: 1389.868530
DEBUG:trainer:Train Epoch: 4 [4/40 (10%)] Loss: 1074.697266
INFO:trainer:    epoch          : 4
INFO:trainer:    loss           : 1183.8366120990954
INFO:trainer:    bias_avg       : 8.866419754530254
INFO:trainer:    bias_std       : 33.07137880827251
INFO:trainer:    val_loss       : 1063.0803351151317
INFO:trainer:    val_bias_avg   : 11.017109971297415
INFO:trainer:    val_bias_std   : 30.64478894283897
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch4.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 5 [5/40 (12%)] Loss: 921.235962
DEBUG:trainer:Train Epoch: 5 [5/40 (12%)] Loss: 849.233093
INFO:trainer:    epoch          : 5
INFO:trainer:    loss           : 964.3240452816611
INFO:trainer:    bias_avg       : 7.928257741426167
INFO:trainer:    bias_std       : 29.970643896805612
INFO:trainer:    val_loss       : 860.3904611687911
INFO:trainer:    val_bias_avg   : 7.068064840216386
INFO:trainer:    val_bias_std   : 28.423001941881683
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch5.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 6 [6/40 (15%)] Loss: 799.323181
DEBUG:trainer:Train Epoch: 6 [6/40 (15%)] Loss: 746.426147
INFO:trainer:    epoch          : 6
INFO:trainer:    loss           : 792.3997224506579
INFO:trainer:    bias_avg       : 6.265755929444966
INFO:trainer:    bias_std       : 27.383634667647513
INFO:trainer:    val_loss       : 714.1676153885691
INFO:trainer:    val_bias_avg   : 5.094376614219264
INFO:trainer:    val_bias_std   : 26.205503162584808
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch6.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 7 [7/40 (18%)] Loss: 669.247925
DEBUG:trainer:Train Epoch: 7 [7/40 (18%)] Loss: 639.094482
INFO:trainer:    epoch          : 7
INFO:trainer:    loss           : 653.4096390573602
INFO:trainer:    bias_avg       : 4.280023016427693
INFO:trainer:    bias_std       : 25.1632080078125
INFO:trainer:    val_loss       : 561.8350283974096
INFO:trainer:    val_bias_avg   : 2.4934211592925224
INFO:trainer:    val_bias_std   : 23.550276505319697
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch7.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 8 [8/40 (20%)] Loss: 499.529968
DEBUG:trainer:Train Epoch: 8 [8/40 (20%)] Loss: 445.561279
INFO:trainer:    epoch          : 8
INFO:trainer:    loss           : 441.2903089021382
INFO:trainer:    bias_avg       : 0.6390217589704614
INFO:trainer:    bias_std       : 20.89516820405659
INFO:trainer:    val_loss       : 347.80177066200656
INFO:trainer:    val_bias_avg   : -1.9784412572258396
INFO:trainer:    val_bias_std   : 18.525856921547337
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch8.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 9 [9/40 (22%)] Loss: 278.763611
DEBUG:trainer:Train Epoch: 9 [9/40 (22%)] Loss: 363.193665
INFO:trainer:    epoch          : 9
INFO:trainer:    loss           : 330.0433606599507
INFO:trainer:    bias_avg       : -0.07437828418455626
INFO:trainer:    bias_std       : 18.102692051937705
INFO:trainer:    val_loss       : 308.74247581080385
INFO:trainer:    val_bias_avg   : 0.4966836471698786
INFO:trainer:    val_bias_std   : 17.533105749832956
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch9.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 10 [10/40 (25%)] Loss: 259.178833
DEBUG:trainer:Train Epoch: 10 [10/40 (25%)] Loss: 366.767181
INFO:trainer:    epoch          : 10
INFO:trainer:    loss           : 311.7555325156764
INFO:trainer:    bias_avg       : -0.06806024727656652
INFO:trainer:    bias_std       : 17.595571016010485
INFO:trainer:    val_loss       : 303.4735733835321
INFO:trainer:    val_bias_avg   : 0.38203614950180054
INFO:trainer:    val_bias_std   : 17.347897479408665
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch10.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 11 [11/40 (28%)] Loss: 324.441986
DEBUG:trainer:Train Epoch: 11 [11/40 (28%)] Loss: 298.691101
INFO:trainer:    epoch          : 11
INFO:trainer:    loss           : 307.75165437397203
INFO:trainer:    bias_avg       : 0.1704282023404774
INFO:trainer:    bias_std       : 17.498482603775827
INFO:trainer:    val_loss       : 304.25798516524463
INFO:trainer:    val_bias_avg   : -0.7316985742041939
INFO:trainer:    val_bias_std   : 17.396555649606807
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch11.pth ...
DEBUG:trainer:Train Epoch: 12 [12/40 (30%)] Loss: 368.590576
DEBUG:trainer:Train Epoch: 12 [12/40 (30%)] Loss: 264.842621
INFO:trainer:    epoch          : 12
INFO:trainer:    loss           : 303.8457657663446
INFO:trainer:    bias_avg       : -0.028544799081589047
INFO:trainer:    bias_std       : 17.3923618918971
INFO:trainer:    val_loss       : 300.6474986829256
INFO:trainer:    val_bias_avg   : 0.09818816714380917
INFO:trainer:    val_bias_std   : 17.295509639539215
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch12.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 13 [13/40 (32%)] Loss: 258.550110
DEBUG:trainer:Train Epoch: 13 [13/40 (32%)] Loss: 271.586975
INFO:trainer:    epoch          : 13
INFO:trainer:    loss           : 309.1359236867804
INFO:trainer:    bias_avg       : -0.05334358956468733
INFO:trainer:    bias_std       : 17.523740567659075
INFO:trainer:    val_loss       : 306.231002004523
INFO:trainer:    val_bias_avg   : 0.8474991854868437
INFO:trainer:    val_bias_std   : 17.435108485974762
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch13.pth ...
DEBUG:trainer:Train Epoch: 14 [14/40 (35%)] Loss: 362.482269
DEBUG:trainer:Train Epoch: 14 [14/40 (35%)] Loss: 311.804779
INFO:trainer:    epoch          : 14
INFO:trainer:    loss           : 302.5735457570929
INFO:trainer:    bias_avg       : 0.006199348129724201
INFO:trainer:    bias_std       : 17.35495968868858
INFO:trainer:    val_loss       : 302.4666788201583
INFO:trainer:    val_bias_avg   : 0.25327936510898563
INFO:trainer:    val_bias_std   : 17.350104733517295
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch14.pth ...
DEBUG:trainer:Train Epoch: 15 [15/40 (38%)] Loss: 347.682983
DEBUG:trainer:Train Epoch: 15 [15/40 (38%)] Loss: 301.780396
INFO:trainer:    epoch          : 15
INFO:trainer:    loss           : 306.27744413677016
INFO:trainer:    bias_avg       : -0.028057911090160672
INFO:trainer:    bias_std       : 17.4541237479762
INFO:trainer:    val_loss       : 298.56947728207234
INFO:trainer:    val_bias_avg   : 0.2301683671478378
INFO:trainer:    val_bias_std   : 17.256473641646537
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch15.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 16 [16/40 (40%)] Loss: 306.227509
DEBUG:trainer:Train Epoch: 16 [16/40 (40%)] Loss: 312.761658
INFO:trainer:    epoch          : 16
INFO:trainer:    loss           : 298.2567419754831
INFO:trainer:    bias_avg       : 0.08965099524510534
INFO:trainer:    bias_std       : 17.24657073773836
INFO:trainer:    val_loss       : 296.3002086438631
INFO:trainer:    val_bias_avg   : -0.27011223185170247
INFO:trainer:    val_bias_std   : 17.179585256074603
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch16.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 17 [17/40 (42%)] Loss: 323.866211
DEBUG:trainer:Train Epoch: 17 [17/40 (42%)] Loss: 316.023254
INFO:trainer:    epoch          : 17
INFO:trainer:    loss           : 300.0375663355777
INFO:trainer:    bias_avg       : -0.05381615817742912
INFO:trainer:    bias_std       : 17.26959062877454
INFO:trainer:    val_loss       : 298.3437973825555
INFO:trainer:    val_bias_avg   : 0.1721763010136783
INFO:trainer:    val_bias_std   : 17.22241015183298
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch17.pth ...
DEBUG:trainer:Train Epoch: 18 [18/40 (45%)] Loss: 305.293518
DEBUG:trainer:Train Epoch: 18 [18/40 (45%)] Loss: 296.538055
INFO:trainer:    epoch          : 18
INFO:trainer:    loss           : 296.48004150390625
INFO:trainer:    bias_avg       : 0.03911892408014912
INFO:trainer:    bias_std       : 17.19512487712659
INFO:trainer:    val_loss       : 298.89029091282896
INFO:trainer:    val_bias_avg   : 0.021630127963266875
INFO:trainer:    val_bias_std   : 17.247057914733887
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch18.pth ...
DEBUG:trainer:Train Epoch: 19 [19/40 (48%)] Loss: 330.224945
DEBUG:trainer:Train Epoch: 19 [19/40 (48%)] Loss: 279.910095
INFO:trainer:    epoch          : 19
INFO:trainer:    loss           : 296.70732437936886
INFO:trainer:    bias_avg       : 0.005977357688703035
INFO:trainer:    bias_std       : 17.190704546476667
INFO:trainer:    val_loss       : 295.79971233167146
INFO:trainer:    val_bias_avg   : -0.3451568417643246
INFO:trainer:    val_bias_std   : 17.173080845883018
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch19.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 20 [20/40 (50%)] Loss: 273.645813
DEBUG:trainer:Train Epoch: 20 [20/40 (50%)] Loss: 292.705933
INFO:trainer:    epoch          : 20
INFO:trainer:    loss           : 296.0077161287007
INFO:trainer:    bias_avg       : -0.08272724755500492
INFO:trainer:    bias_std       : 17.176494297228363
INFO:trainer:    val_loss       : 295.9687845330489
INFO:trainer:    val_bias_avg   : 0.2353405703447367
INFO:trainer:    val_bias_std   : 17.163117509139212
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch20.pth ...
DEBUG:trainer:Train Epoch: 21 [21/40 (52%)] Loss: 284.468384
DEBUG:trainer:Train Epoch: 21 [21/40 (52%)] Loss: 296.911743
INFO:trainer:    epoch          : 21
INFO:trainer:    loss           : 296.8004608154297
INFO:trainer:    bias_avg       : 0.10736138020691119
INFO:trainer:    bias_std       : 17.203180062143428
INFO:trainer:    val_loss       : 295.41276951840047
INFO:trainer:    val_bias_avg   : -0.11877125950138036
INFO:trainer:    val_bias_std   : 17.16454912486829
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch21.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 22 [22/40 (55%)] Loss: 314.454041
DEBUG:trainer:Train Epoch: 22 [22/40 (55%)] Loss: 266.046143
INFO:trainer:    epoch          : 22
INFO:trainer:    loss           : 296.16676651804073
INFO:trainer:    bias_avg       : -0.03754227177092904
INFO:trainer:    bias_std       : 17.17845354582134
INFO:trainer:    val_loss       : 296.1206134996916
INFO:trainer:    val_bias_avg   : 0.35471471977469166
INFO:trainer:    val_bias_std   : 17.15637698926424
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch22.pth ...
DEBUG:trainer:Train Epoch: 23 [23/40 (58%)] Loss: 344.871094
DEBUG:trainer:Train Epoch: 23 [23/40 (58%)] Loss: 377.778412
INFO:trainer:    epoch          : 23
INFO:trainer:    loss           : 300.60529608475537
INFO:trainer:    bias_avg       : -0.007461314726816981
INFO:trainer:    bias_std       : 17.28806053964715
INFO:trainer:    val_loss       : 296.2673685174239
INFO:trainer:    val_bias_avg   : 0.11646294789878946
INFO:trainer:    val_bias_std   : 17.191142182601126
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch23.pth ...
DEBUG:trainer:Train Epoch: 24 [24/40 (60%)] Loss: 304.074890
DEBUG:trainer:Train Epoch: 24 [24/40 (60%)] Loss: 301.544922
INFO:trainer:    epoch          : 24
INFO:trainer:    loss           : 300.46422617059005
INFO:trainer:    bias_avg       : -0.0050550115594983494
INFO:trainer:    bias_std       : 17.296610982794512
INFO:trainer:    val_loss       : 297.06875770970396
INFO:trainer:    val_bias_avg   : -0.09385068008774206
INFO:trainer:    val_bias_std   : 17.184713965968083
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch24.pth ...
DEBUG:trainer:Train Epoch: 25 [25/40 (62%)] Loss: 300.654388
DEBUG:trainer:Train Epoch: 25 [25/40 (62%)] Loss: 287.169281
INFO:trainer:    epoch          : 25
INFO:trainer:    loss           : 299.6807612368935
INFO:trainer:    bias_avg       : -0.06672033498455819
INFO:trainer:    bias_std       : 17.266742856878984
INFO:trainer:    val_loss       : 296.9430140445107
INFO:trainer:    val_bias_avg   : -0.18337741856904408
INFO:trainer:    val_bias_std   : 17.190406799316406
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch25.pth ...
DEBUG:trainer:Train Epoch: 26 [26/40 (65%)] Loss: 277.538422
DEBUG:trainer:Train Epoch: 26 [26/40 (65%)] Loss: 314.270966
INFO:trainer:    epoch          : 26
INFO:trainer:    loss           : 296.871846249229
INFO:trainer:    bias_avg       : 0.015173983417059245
INFO:trainer:    bias_std       : 17.152894421627646
INFO:trainer:    val_loss       : 304.3142009534334
INFO:trainer:    val_bias_avg   : 0.9917628388655814
INFO:trainer:    val_bias_std   : 17.363832323174726
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch26.pth ...
DEBUG:trainer:Train Epoch: 27 [27/40 (68%)] Loss: 314.872284
DEBUG:trainer:Train Epoch: 27 [27/40 (68%)] Loss: 303.426910
INFO:trainer:    epoch          : 27
INFO:trainer:    loss           : 298.52703857421875
INFO:trainer:    bias_avg       : 0.03901912156786574
INFO:trainer:    bias_std       : 17.205102117438067
INFO:trainer:    val_loss       : 297.56855934544615
INFO:trainer:    val_bias_avg   : -0.5263894623831699
INFO:trainer:    val_bias_std   : 17.19664935061806
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch27.pth ...
DEBUG:trainer:Train Epoch: 28 [28/40 (70%)] Loss: 281.798523
DEBUG:trainer:Train Epoch: 28 [28/40 (70%)] Loss: 291.542969
INFO:trainer:    epoch          : 28
INFO:trainer:    loss           : 297.39055352461963
INFO:trainer:    bias_avg       : -0.0730467683782703
INFO:trainer:    bias_std       : 17.214403604206286
INFO:trainer:    val_loss       : 295.99754333496094
INFO:trainer:    val_bias_avg   : 0.21775627646007037
INFO:trainer:    val_bias_std   : 17.156451978181536
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch28.pth ...
DEBUG:trainer:Train Epoch: 29 [29/40 (72%)] Loss: 255.353622
DEBUG:trainer:Train Epoch: 29 [29/40 (72%)] Loss: 259.527039
INFO:trainer:    epoch          : 29
INFO:trainer:    loss           : 294.3031142385382
INFO:trainer:    bias_avg       : 0.10407701615048082
INFO:trainer:    bias_std       : 17.07569694519043
INFO:trainer:    val_loss       : 298.41877345034953
INFO:trainer:    val_bias_avg   : 0.20376320085243174
INFO:trainer:    val_bias_std   : 17.226179524471885
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch29.pth ...
DEBUG:trainer:Train Epoch: 30 [30/40 (75%)] Loss: 247.933517
DEBUG:trainer:Train Epoch: 30 [30/40 (75%)] Loss: 293.985687
INFO:trainer:    epoch          : 30
INFO:trainer:    loss           : 297.28861035798724
INFO:trainer:    bias_avg       : -0.09035207679201114
INFO:trainer:    bias_std       : 17.210075027064274
INFO:trainer:    val_loss       : 298.83872744911594
INFO:trainer:    val_bias_avg   : -0.06498525335796569
INFO:trainer:    val_bias_std   : 17.24969828756232
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch30.pth ...
DEBUG:trainer:Train Epoch: 31 [31/40 (78%)] Loss: 386.775024
DEBUG:trainer:Train Epoch: 31 [31/40 (78%)] Loss: 316.596161
INFO:trainer:    epoch          : 31
INFO:trainer:    loss           : 298.8895922209087
INFO:trainer:    bias_avg       : -0.028210767691856938
INFO:trainer:    bias_std       : 17.234825234664115
INFO:trainer:    val_loss       : 295.054522865697
INFO:trainer:    val_bias_avg   : 0.13174747254111266
INFO:trainer:    val_bias_std   : 17.141663701910723
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch31.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 32 [32/40 (80%)] Loss: 312.946808
DEBUG:trainer:Train Epoch: 32 [32/40 (80%)] Loss: 268.036560
INFO:trainer:    epoch          : 32
INFO:trainer:    loss           : 293.5680268940173
INFO:trainer:    bias_avg       : 0.060570405220220745
INFO:trainer:    bias_std       : 17.09207871085719
INFO:trainer:    val_loss       : 292.80182125693875
INFO:trainer:    val_bias_avg   : -0.11453158584864516
INFO:trainer:    val_bias_std   : 17.057660956131784
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch32.pth ...
INFO:trainer:Saving current best: model_best.pth ...
DEBUG:trainer:Train Epoch: 33 [33/40 (82%)] Loss: 262.368774
DEBUG:trainer:Train Epoch: 33 [33/40 (82%)] Loss: 298.040466
INFO:trainer:    epoch          : 33
INFO:trainer:    loss           : 297.58758785850125
INFO:trainer:    bias_avg       : -0.03545859935203273
INFO:trainer:    bias_std       : 17.196161019174678
INFO:trainer:    val_loss       : 300.8471165707237
INFO:trainer:    val_bias_avg   : 0.013051316276878902
INFO:trainer:    val_bias_std   : 17.27741783543637
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch33.pth ...
DEBUG:trainer:Train Epoch: 34 [34/40 (85%)] Loss: 332.795959
DEBUG:trainer:Train Epoch: 34 [34/40 (85%)] Loss: 273.860046
INFO:trainer:    epoch          : 34
INFO:trainer:    loss           : 298.66265628212375
INFO:trainer:    bias_avg       : 0.007958886899838322
INFO:trainer:    bias_std       : 17.24031895085385
INFO:trainer:    val_loss       : 296.2448834870991
INFO:trainer:    val_bias_avg   : -0.05324448164748518
INFO:trainer:    val_bias_std   : 17.176238361157868
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch34.pth ...
DEBUG:trainer:Train Epoch: 35 [35/40 (88%)] Loss: 399.099365
DEBUG:trainer:Train Epoch: 35 [35/40 (88%)] Loss: 260.979553
INFO:trainer:    epoch          : 35
INFO:trainer:    loss           : 294.8744410464638
INFO:trainer:    bias_avg       : 0.007697607292548606
INFO:trainer:    bias_std       : 17.116534182899876
INFO:trainer:    val_loss       : 298.82962839226974
INFO:trainer:    val_bias_avg   : -0.08395968318769806
INFO:trainer:    val_bias_std   : 17.24826044785349
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch35.pth ...
DEBUG:trainer:Train Epoch: 36 [36/40 (90%)] Loss: 283.515717
DEBUG:trainer:Train Epoch: 36 [36/40 (90%)] Loss: 312.101501
INFO:trainer:    epoch          : 36
INFO:trainer:    loss           : 297.1918013723273
INFO:trainer:    bias_avg       : -0.06507692553446089
INFO:trainer:    bias_std       : 17.19616292652331
INFO:trainer:    val_loss       : 295.98855269582646
INFO:trainer:    val_bias_avg   : 0.0729877213996492
INFO:trainer:    val_bias_std   : 17.171196285047028
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch36.pth ...
DEBUG:trainer:Train Epoch: 37 [37/40 (92%)] Loss: 262.498230
DEBUG:trainer:Train Epoch: 37 [37/40 (92%)] Loss: 279.963226
INFO:trainer:    epoch          : 37
INFO:trainer:    loss           : 293.253741615697
INFO:trainer:    bias_avg       : 0.03698281924191274
INFO:trainer:    bias_std       : 17.06923118390535
INFO:trainer:    val_loss       : 294.11279457493833
INFO:trainer:    val_bias_avg   : -0.05070140805879706
INFO:trainer:    val_bias_std   : 17.089517844350713
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch37.pth ...
DEBUG:trainer:Train Epoch: 38 [38/40 (95%)] Loss: 207.178925
DEBUG:trainer:Train Epoch: 38 [38/40 (95%)] Loss: 252.323227
INFO:trainer:    epoch          : 38
INFO:trainer:    loss           : 296.6371612548828
INFO:trainer:    bias_avg       : -0.0715841884283643
INFO:trainer:    bias_std       : 17.169600135401677
INFO:trainer:    val_loss       : 296.5562101665296
INFO:trainer:    val_bias_avg   : 0.2225860003749595
INFO:trainer:    val_bias_std   : 17.176199109930742
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch38.pth ...
DEBUG:trainer:Train Epoch: 39 [39/40 (98%)] Loss: 299.771973
DEBUG:trainer:Train Epoch: 39 [39/40 (98%)] Loss: 261.008179
INFO:trainer:    epoch          : 39
INFO:trainer:    loss           : 294.0880247417249
INFO:trainer:    bias_avg       : 0.027087768564294828
INFO:trainer:    bias_std       : 17.101408356114437
INFO:trainer:    val_loss       : 296.1878991377981
INFO:trainer:    val_bias_avg   : -0.002348155175384722
INFO:trainer:    val_bias_std   : 17.187112155713532
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch39.pth ...
DEBUG:trainer:Train Epoch: 40 [40/40 (100%)] Loss: 269.908905
DEBUG:trainer:Train Epoch: 40 [40/40 (100%)] Loss: 336.742493
INFO:trainer:    epoch          : 40
INFO:trainer:    loss           : 299.68601588199016
INFO:trainer:    bias_avg       : 0.07458784627287011
INFO:trainer:    bias_std       : 17.268471968801396
INFO:trainer:    val_loss       : 294.500124479595
INFO:trainer:    val_bias_avg   : -0.06089154938480964
INFO:trainer:    val_bias_std   : 17.120313794989336
INFO:trainer:Saving checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch40.pth ...
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)

tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
Working on epoch num: 1...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch1.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.44s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:14<00:00,  7.45s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -102263711.315, Bias: 11293142.121
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['49351.777', '-39839.349', '28711.343', '175500.311', '351852.549', '507737.848', '635599.656', '692774.734', '719600.729', '700090.476', '651693.256', '636994.947', '538083.98
3', '455292.139', '415924.783', '324052.689', '246965.730', '192759.715', '149530.824', '100237.150', '56125.850', '32235.850', '-3852.609', '-26295.801', '-35478.371', '-38901.541', '-332
49.254', '-18.670', '7672.282', '54286.818', '37227.525', '4883.396', '25490.837', '9381.494', '2741.351', '-14210.902', '16771.020', '4693.882', '8809.826', '11090.572', '10002.421', '737
8.674', '-704.744', '9188.782', '857.191', '2098.888', '5354.852', '-11896.697']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 7674598.212120019, target N: 8841303.0
Mean E: 3.973812631142346, target E: 4.2914232732437725
INFO:test:{'loss': 32380.96083015267, 'bias_avg': 37.10893070133588, 'bias_std': 175.879401240458}
Working on epoch num: 10...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch10.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.60s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.53s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113316225.862, Bias: 240627.574
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15950.371', '59874.182', '147783.099', '267995.476', '387861.798', '485483.134', '552078.319', '596084.463', '616154.123', '613030.539', '595097.126', '565084.584', '527580.91
5', '484763.027', '435479.053', '392522.930', '345152.900', '300567.463', '259544.517', '220022.193', '185839.117', '155605.813', '129230.871', '106669.104', '87424.838', '70485.735', '549
90.816', '42911.789', '32937.632', '25029.493', '19034.399', '13802.449', '9662.515', '6946.564', '5084.770', '3271.852', '2198.831', '1006.323', '874.767', '491.510', '289.095', '207.531'
, '43.752', '41.693', '-8.861', '-13.021', '-6.668', '2102.774']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8824265.696382744, target N: 8841303.0
Mean E: 4.2932925262985675, target E: 4.2914232732437725
INFO:test:{'loss': 308.6152675017146, 'bias_avg': 0.5418990040553435, 'bias_std': 17.549792760019084}
Working on epoch num: 11...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch11.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.47s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:14<00:00,  7.46s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113815008.723, Bias: -258155.287
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16419.532', '59728.348', '148984.182', '266998.242', '388874.569', '487315.913', '557967.874', '596748.665', '617893.580', '614288.722', '595815.050', '569584.921', '530665.12
4', '485089.305', '438207.537', '392716.854', '346180.061', '301750.109', '261682.158', '222168.389', '186995.848', '156721.554', '131138.004', '107065.389', '87553.419', '70620.104', '552
65.679', '43359.708', '34044.068', '25314.316', '19194.778', '14042.192', '9352.293', '6947.922', '4116.530', '2396.785', '1803.467', '986.437', '964.191', '531.259', '306.460', '348.418',
 '80.498', '34.597', '23.682', '-10.999', '0.214', '1725.941']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8860001.887653181, target N: 8841303.0
Mean E: 4.293967113745982, target E: 4.2914232732437725
INFO:test:{'loss': 309.60560922404284, 'bias_avg': -0.5947483208343273, 'bias_std': 17.576629592080153}
Working on epoch num: 12...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch12.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:15<00:15, 15.03s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.75s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113442200.589, Bias: 114652.847
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15655.269', '59404.147', '148396.939', '265913.767', '389525.485', '484664.220', '555525.940', '595474.313', '614927.578', '612298.424', '594825.655', '567050.153', '529504.92
3', '483871.123', '436531.309', '392315.308', '344014.358', '301273.335', '260354.387', '221480.637', '186626.687', '155759.319', '131096.187', '106472.786', '86471.608', '69463.378', '548
54.368', '44259.560', '33398.957', '25305.091', '19338.403', '14308.611', '10522.670', '7582.888', '5943.857', '3465.090', '1613.117', '972.991', '737.014', '274.938', '297.446', '161.343'
, '28.534', '-13.690', '-0.042', '9.173', '-0.098', '1963.889']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8833921.346693117, target N: 8841303.0
Mean E: 4.296058577924414, target E: 4.2914232732437725
INFO:test:{'loss': 307.91806878242784, 'bias_avg': 0.2347854264819895, 'bias_std': 17.53824844942748}
Working on epoch num: 13...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch13.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.80s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.62s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113120587.236, Bias: 436266.200
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15537.762', '59486.591', '147310.500', '266102.902', '388358.549', '485852.596', '554931.777', '596342.686', '611866.421', '611376.625', '595518.081', '563973.260', '526404.49
3', '481007.580', '437930.140', '390491.119', '343093.754', '299590.074', '259850.617', '221773.892', '186246.984', '156095.395', '129097.712', '106098.759', '86368.856', '69447.173', '540
47.187', '42785.805', '32494.034', '24965.508', '19397.197', '13999.949', '10643.094', '6223.573', '4081.335', '2835.319', '2412.897', '1336.484', '946.019', '429.994', '188.695', '134.661
', '47.298', '15.672', '-32.320', '13.268', '12.172', '2506.341']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8809638.479298338, target N: 8841303.0
Mean E: 4.29191055099623, target E: 4.2914232732437725
INFO:test:{'loss': 311.6824586358689, 'bias_avg': 1.0071412064646947, 'bias_std': 17.619988967080154}
Working on epoch num: 14...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch14.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:15<00:15, 15.08s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.77s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113374562.928, Bias: 182290.508
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15358.426', '59788.546', '148006.543', '267412.325', '389932.184', '486551.523', '552914.552', '596555.506', '613623.379', '613358.123', '596240.672', '564758.753', '528861.51
5', '482417.704', '437650.141', '391322.378', '344189.283', '299590.766', '260840.267', '220580.391', '186279.139', '154819.394', '130088.724', '106214.581', '85946.322', '69910.983', '546
90.272', '44057.164', '34186.775', '26128.352', '19203.162', '13868.655', '9961.462', '7078.893', '5602.838', '3254.286', '3019.160', '1150.307', '340.299', '637.080', '118.248', '182.520'
, '-3.836', '0.181', '-19.892', '3.581', '2.181', '2493.080']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8829166.887594692, target N: 8841303.0
Mean E: 4.294441963504412, target E: 4.2914232732437725
INFO:test:{'loss': 307.0863954966305, 'bias_avg': 0.38600869215171757, 'bias_std': 17.512109375}
Working on epoch num: 15...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch15.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.69s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.57s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113412985.476, Bias: 143867.961
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15422.843', '60155.098', '147598.071', '268790.359', '390216.405', '485511.147', '554250.830', '596817.669', '615156.131', '615495.597', '595542.523', '566332.177', '527870.57
8', '484792.705', '437837.924', '392313.071', '343683.431', '299092.267', '260356.421', '221727.561', '186256.870', '155160.397', '129509.494', '105739.915', '86184.754', '69125.428', '550
20.819', '42822.248', '32802.937', '25513.045', '18917.005', '13801.143', '9793.695', '6219.745', '4509.648', '3121.111', '2380.830', '405.740', '631.271', '314.366', '468.522', '45.308',
'-43.314', '8.130', '55.404', '5.445', '-4.574', '2092.796']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8829820.983215742, target N: 8841303.0
Mean E: 4.289773795216468, target E: 4.2914232732437725
INFO:test:{'loss': 304.9199312865279, 'bias_avg': 0.3652041136763478, 'bias_std': 17.450342915076337}
Working on epoch num: 16...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch16.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.65s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.56s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113610368.760, Bias: -53515.324
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15904.391', '60191.719', '147603.960', '267361.869', '389574.387', '488368.319', '554974.186', '596352.680', '615696.331', '614766.950', '597352.033', '567270.972', '528833.88
1', '484167.869', '438286.958', '391454.256', '344944.730', '301202.254', '259683.582', '221381.427', '187178.198', '156785.852', '130001.451', '106657.668', '86871.080', '69679.778', '550
43.933', '43223.808', '33506.997', '25472.299', '19134.543', '13816.588', '10171.021', '7088.169', '5297.584', '3253.395', '2115.442', '1371.924', '852.704', '404.601', '119.901', '161.489
', '47.069', '22.771', '16.635', '3.496', '-4.301', '2054.212']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8845721.060170025, target N: 8841303.0
Mean E: 4.293861623780345, target E: 4.2914232732437725
INFO:test:{'loss': 303.6773855427749, 'bias_avg': -0.14052354652463026, 'bias_std': 17.418099952290078}
Working on epoch num: 17...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch17.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.72s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.58s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113424478.730, Bias: 132374.706
KL dist - KL1(q=target): -9799.204, KL2(q=output): 10026.084, Symmetric: 226.880
total out: ['15475.619', '60021.082', '147827.002', '267564.699', '389768.583', '486913.918', '554698.169', '595903.305', '614961.220', '614005.465', '596367.401', '566392.400', '527664.63
5', '484018.380', '437702.249', '391077.935', '344792.966', '299934.194', '259404.269', '221599.114', '186823.905', '155997.050', '130046.156', '106441.137', '86641.359', '69301.020', '548
41.311', '42985.514', '33420.139', '24925.487', '18717.803', '13551.054', '10104.076', '6968.248', '4634.765', '3242.809', '2060.158', '1319.113', '668.753', '400.929', '200.603', '30.695'
, '28.564', '10.035', '3.263', '0.329', '3.691', '1901.752']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8831362.320585433, target N: 8841303.0
Mean E: 4.291889581029974, target E: 4.2914232732437725
INFO:test:{'loss': 303.2151554952141, 'bias_avg': 0.3161793716081226, 'bias_std': 17.40267175572519}
Working on epoch num: 18...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch18.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:15<00:15, 15.27s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.86s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113485345.464, Bias: 71507.972
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15349.325', '59993.367', '147479.192', '267422.963', '389366.523', '487001.240', '554625.764', '596106.220', '615429.339', '614866.995', '596537.500', '566844.017', '528610.31
2', '484108.200', '438182.708', '391497.875', '344872.301', '300434.442', '259588.562', '221115.523', '186829.455', '156201.049', '129764.232', '106346.109', '86652.626', '69598.015', '548
45.928', '43030.504', '33523.993', '25369.913', '19209.826', '13523.732', '9943.049', '6857.521', '5049.022', '3077.214', '1910.553', '1181.977', '718.138', '365.308', '201.817', '105.211'
, '41.076', '3.907', '6.156', '-1.816', '-0.391', '2023.712']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8835810.204652693, target N: 8841303.0
Mean E: 4.292520041023402, target E: 4.2914232732437725
INFO:test:{'loss': 303.2768644609524, 'bias_avg': 0.17470721761688932, 'bias_std': 17.4062604365458}
Working on epoch num: 19...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch19.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.83s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.65s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113643340.701, Bias: -86487.265
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15602.716', '60116.382', '147893.138', '267911.198', '390505.647', '487530.821', '555074.412', '597019.280', '615900.155', '614860.361', '596773.178', '567379.924', '528980.16
5', '484343.943', '438361.731', '391696.964', '345198.956', '301055.289', '259713.689', '221655.925', '187096.283', '156571.480', '130300.343', '106627.345', '86894.023', '69853.823', '551
06.174', '43431.855', '33538.208', '25308.859', '19073.277', '14205.124', '9927.082', '7066.252', '4881.634', '3434.979', '2051.077', '1281.522', '766.774', '333.865', '231.008', '58.262',
 '73.212', '32.915', '16.043', '-1.543', '-1.511', '2272.576']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8848004.813493103, target N: 8841303.0
Mean E: 4.293435888469514, target E: 4.2914232732437725
INFO:test:{'loss': 302.6807724348461, 'bias_avg': -0.21316199848670087, 'bias_std': 17.388795622614502}
Working on epoch num: 2...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch2.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.91s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.69s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -107123873.896, Bias: 6432979.540
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['3795.235', '45739.888', '162308.541', '279747.704', '380805.845', '476759.584', '532834.221', '564823.347', '579070.951', '569325.964', '557276.093', '519331.635', '493750.275
', '458267.122', '405546.227', '360247.855', '327079.917', '282927.827', '245296.504', '217505.716', '187147.548', '154822.124', '134952.094', '106186.074', '75575.462', '47046.494', '3556
0.208', '33992.377', '33695.992', '30979.992', '11546.315', '17916.968', '15116.677', '7642.579', '7655.480', '-2139.541', '331.720', '1227.959', '-139.699', '-5591.733', '-1408.926', '292
9.173', '-464.421', '2762.546', '-1134.987', '-269.981', '-2030.422', '4787.863']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8361136.386511791, target N: 8841303.0
Mean E: 4.2688997339210895, target E: 4.2914232732437725
INFO:test:{'loss': 2107.322853426169, 'bias_avg': 15.27247435591603, 'bias_std': 43.28857347328244}
Working on epoch num: 20...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch20.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.67s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.55s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113397691.249, Bias: 159162.187
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15505.496', '60110.995', '147569.673', '267058.030', '389276.587', '486983.274', '554227.739', '595883.145', '614985.288', '614225.420', '596157.425', '566031.721', '528572.54
0', '484080.152', '437746.408', '390894.103', '344504.660', '300265.025', '259086.294', '221242.822', '186797.643', '156196.476', '129649.915', '106178.109', '86627.649', '69371.483', '547
95.844', '42553.462', '33280.152', '25265.533', '19195.219', '13760.810', '9763.373', '6929.331', '4448.975', '3264.914', '2214.256', '1357.488', '654.540', '365.052', '239.459', '82.083',
 '51.652', '4.050', '14.215', '-4.541', '1.839', '2025.344']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8829491.117743697, target N: 8841303.0
Mean E: 4.292023337032176, target E: 4.2914232732437725
INFO:test:{'loss': 303.676904296875, 'bias_avg': 0.37569601044400047, 'bias_std': 17.414787094465648}
Working on epoch num: 21...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch21.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.74s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.59s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113537856.248, Bias: 18997.188
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15977.968', '59948.801', '147647.254', '267543.267', '389784.717', '487065.520', '554790.267', '595838.726', '615691.223', '614626.264', '596554.993', '566659.728', '528906.37
1', '484189.106', '438267.994', '391591.804', '344898.609', '300497.462', '259356.574', '221292.234', '186744.995', '156362.704', '129906.066', '106347.639', '86585.647', '69609.129', '552
35.473', '43231.538', '33632.367', '25324.208', '19082.521', '13750.825', '10114.497', '7453.182', '5369.595', '3487.144', '2314.795', '1155.962', '756.382', '520.148', '218.483', '74.645'
, '69.451', '12.579', '2.956', '-10.454', '-0.271', '2147.838']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8840628.925981257, target N: 8841303.0
Mean E: 4.293890665532253, target E: 4.2914232732437725
INFO:test:{'loss': 303.0264777030654, 'bias_avg': 0.021440021136334836, 'bias_std': 17.40000298187023}
Working on epoch num: 22...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch22.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.80s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.64s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113342361.147, Bias: 214492.289
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15594.626', '60126.043', '147543.426', '267525.315', '389053.098', '486769.154', '554135.188', '595833.298', '614715.368', '613802.673', '595487.061', '565765.662', '527450.25
2', '483273.377', '437468.454', '390910.818', '344323.482', '300035.333', '259161.235', '221191.518', '186680.343', '156249.465', '129900.496', '106397.161', '86470.366', '69420.178', '547
49.473', '43200.760', '33308.661', '24866.901', '19023.009', '13575.058', '10277.493', '6923.788', '4792.618', '3183.191', '1966.954', '1018.632', '739.273', '442.099', '196.518', '73.291'
, '12.370', '10.915', '-3.524', '-2.016', '2.792', '1902.063']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8825543.708520098, target N: 8841303.0
Mean E: 4.292087031982914, target E: 4.2914232732437725
INFO:test:{'loss': 303.9235796047531, 'bias_avg': 0.5012497297680105, 'bias_std': 17.418909530057253}
Working on epoch num: 23...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch23.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:15<00:15, 15.09s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.78s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113449517.624, Bias: 107335.812
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15859.222', '60033.772', '147741.037', '267181.534', '389639.814', '487030.294', '554571.563', '596031.623', '615256.062', '614190.715', '596193.991', '566555.202', '528586.10
0', '484061.783', '438050.831', '390990.463', '344567.819', '300250.421', '259186.411', '221182.532', '186615.706', '156129.739', '129935.729', '106328.404', '86492.363', '69308.396', '551
03.687', '42935.196', '33549.632', '25066.912', '19112.976', '13883.619', '9844.548', '7041.143', '4891.645', '3331.320', '2216.407', '1132.902', '777.336', '322.295', '167.619', '73.296',
 '58.475', '-0.307', '-1.904', '2.902', '-1.844', '2026.444']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8833505.826555828, target N: 8841303.0
Mean E: 4.29231946489761, target E: 4.2914232732437725
INFO:test:{'loss': 302.88108133796516, 'bias_avg': 0.24800172762106393, 'bias_std': 17.394179389312978}
Working on epoch num: 24...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch24.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.73s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.60s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113537935.933, Bias: 18917.503
KL dist - KL1(q=target): -901.036, KL2(q=output): 1140.097, Symmetric: 239.061
total out: ['16097.395', '60062.147', '147682.804', '267644.862', '389978.939', '487208.712', '554656.819', '596008.459', '615289.655', '614683.130', '596783.954', '566405.693', '528778.40
7', '483901.297', '438215.979', '391603.226', '345174.351', '300672.733', '259514.916', '221637.029', '186997.408', '156385.691', '129998.378', '106412.828', '86512.706', '69653.618', '547
85.906', '43158.681', '33422.773', '25729.638', '18981.997', '13573.345', '10415.830', '7174.151', '5335.634', '3055.048', '1938.601', '1163.524', '731.362', '407.408', '207.379', '80.854'
, '49.406', '12.452', '10.916', '2.574', '0.534', '2058.130']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8840257.277427714, target N: 8841303.0
Mean E: 4.293096570731067, target E: 4.2914232732437725
INFO:test:{'loss': 302.934248317107, 'bias_avg': 0.03326091038361761, 'bias_std': 17.39752057490458}
Working on epoch num: 25...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch25.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.67s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.56s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113578037.874, Bias: -21184.438
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15997.096', '60103.160', '147964.229', '267732.597', '389813.731', '487607.179', '555459.472', '596747.245', '615922.569', '614916.167', '596622.401', '567300.636', '528513.26
0', '484409.856', '438099.234', '391866.898', '345012.244', '300614.480', '259846.748', '221223.305', '186991.222', '156161.401', '130140.483', '106835.524', '86663.027', '69508.548', '550
77.905', '43087.867', '33516.863', '24955.497', '19029.257', '13519.337', '10193.352', '6727.175', '4721.154', '3198.218', '1925.129', '1160.591', '618.690', '354.969', '294.932', '41.879'
, '48.443', '19.403', '10.031', '-2.776', '5.799', '1968.943']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8842545.368569, target N: 8841303.0
Mean E: 4.291740872410032, target E: 4.2914232732437725
INFO:test:{'loss': 302.51510680686425, 'bias_avg': -0.039515534612058686, 'bias_std': 17.385087666984735}
Working on epoch num: 26...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch26.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.80s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.63s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113065182.405, Bias: 491671.031
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15425.565', '59794.685', '147146.983', '266979.033', '388613.673', '485959.445', '552639.944', '593914.188', '613178.867', '612499.594', '594648.885', '564609.691', '526238.47
8', '482522.875', '436789.278', '389971.806', '343469.902', '299434.954', '258295.009', '220588.964', '186285.441', '155915.221', '129432.889', '105793.606', '86452.228', '69197.501', '545
30.589', '42913.346', '33267.437', '25360.047', '18638.288', '13450.517', '9545.931', '7162.547', '4698.341', '3288.442', '2179.239', '1195.523', '774.161', '422.410', '281.489', '75.622',
 '31.492', '2.435', '3.943', '-1.181', '6.098', '1874.437']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8805499.855560593, target N: 8841303.0
Mean E: 4.292074058110959, target E: 4.2914232732437725
INFO:test:{'loss': 310.4082766467378, 'bias_avg': 1.1387767995586833, 'bias_std': 17.57427838740458}
Working on epoch num: 27...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch27.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.78s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.62s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113725197.505, Bias: -168344.069
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15865.576', '60205.184', '147991.553', '267803.638', '390316.695', '488083.057', '555748.677', '597004.696', '616229.156', '615391.234', '597875.309', '567415.509', '529584.14
0', '485186.910', '439150.353', '391935.751', '345369.029', '301076.798', '260071.735', '221883.222', '187179.659', '156604.524', '130262.404', '106754.078', '86929.668', '69676.081', '552
29.165', '43334.484', '33113.690', '25271.139', '19130.552', '13710.955', '10376.756', '7179.271', '4753.137', '3180.295', '2012.648', '1055.967', '765.216', '288.177', '254.744', '49.259'
, '52.721', '21.059', '2.314', '-5.153', '-4.885', '2129.429']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8853495.573780987, target N: 8841303.0
Mean E: 4.292722207961434, target E: 4.2914232732437725
INFO:test:{'loss': 303.45463881165017, 'bias_avg': -0.3878045234971374, 'bias_std': 17.407940720419848}
Working on epoch num: 28...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch28.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.76s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.61s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113400497.976, Bias: 156355.460
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15672.780', '60154.637', '147688.725', '267426.430', '389491.171', '487625.134', '554067.969', '595910.494', '614838.929', '614170.490', '595446.890', '566189.891', '528227.90
4', '483958.066', '437883.230', '390852.258', '344503.278', '300182.959', '259318.141', '220956.795', '186782.756', '156111.131', '129774.851', '106384.776', '86557.208', '69159.997', '547
31.767', '43001.664', '33559.637', '24848.010', '19404.507', '13922.054', '9856.769', '6466.264', '4565.886', '3311.631', '2131.187', '1293.701', '651.161', '410.282', '164.452', '64.583',
 '-6.293', '10.602', '1.929', '-2.318', '0.278', '1921.019']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8829645.66391166, target N: 8841303.0
Mean E: 4.29168868731506, target E: 4.2914232732437725
INFO:test:{'loss': 303.17171677451097, 'bias_avg': 0.3707803973714814, 'bias_std': 17.400500954198474}
Working on epoch num: 29...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch29.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.81s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.64s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113404879.074, Bias: 151974.362
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15770.165', '59854.924', '147447.636', '267546.055', '389244.080', '486531.430', '554440.446', '595896.839', '614459.211', '613719.214', '596216.375', '565815.329', '528929.78
1', '483612.512', '437843.182', '391084.406', '344598.089', '300299.583', '259041.620', '221289.057', '186640.769', '156125.827', '129904.302', '106428.252', '86472.394', '69621.042', '550
35.681', '42675.883', '33677.444', '25842.859', '19416.301', '14297.372', '9166.587', '6964.645', '4722.695', '3325.230', '1748.353', '1282.477', '565.185', '499.552', '115.191', '62.607',
 '-14.981', '18.444', '2.678', '-4.736', '3.897', '1900.927']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8830136.81132562, target N: 8841303.0
Mean E: 4.292731352362233, target E: 4.2914232732437725
INFO:test:{'loss': 303.48190279662157, 'bias_avg': 0.3551586820879055, 'bias_std': 17.409880427003817}
Working on epoch num: 3...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch3.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:15<00:15, 15.19s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.83s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -108526529.365, Bias: 5030324.071
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['17713.685', '68763.773', '151201.535', '269027.127', '388642.478', '478655.101', '537782.982', '575632.000', '593334.527', '590622.544', '566402.265', '535345.892', '497730.70
5', '455854.951', '409792.395', '368499.951', '324091.734', '282927.354', '244731.212', '206323.457', '172091.584', '147690.916', '121769.667', '103480.517', '88499.321', '71150.279', '530
18.570', '38048.407', '32360.191', '21042.770', '21669.193', '11461.343', '12278.412', '8266.876', '3704.223', '1850.011', '240.896', '444.382', '1489.223', '1334.539', '1722.657', '-527.7
61', '-862.783', '88.436', '-12.423', '-837.755', '439.913', '4167.609']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8479144.881861214, target N: 8841303.0
Mean E: 4.2672933778319, target E: 4.2914232732437725
INFO:test:{'loss': 1352.0635975146113, 'bias_avg': 11.519024332061068, 'bias_std': 34.91656130725191}
Working on epoch num: 30...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch30.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.80s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.62s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113530470.260, Bias: 26383.176
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15526.757', '60085.677', '147669.213', '267598.168', '389809.003', '487402.454', '554521.879', '596596.714', '616025.803', '614623.511', '596783.776', '566913.426', '528617.02
2', '484381.424', '438135.647', '391169.973', '344913.818', '300639.214', '259435.871', '221352.297', '186908.344', '156326.906', '129963.179', '106380.027', '86839.890', '69325.665', '549
43.819', '42810.499', '33302.504', '25295.062', '19136.606', '13567.464', '9819.294', '7121.507', '5410.432', '3046.707', '1955.011', '1267.316', '794.636', '265.744', '228.885', '97.535',
 '-8.164', '4.553', '5.935', '-1.122', '-2.597', '2277.112']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8839284.394306188, target N: 8841303.0
Mean E: 4.292197458162265, target E: 4.2914232732437725
INFO:test:{'loss': 302.23907852755246, 'bias_avg': 0.06420501825463681, 'bias_std': 17.37697996183206}
Working on epoch num: 31...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch31.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.67s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.57s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113440637.044, Bias: 116216.392
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15750.809', '60050.868', '147630.533', '267180.563', '389115.549', '486852.376', '554560.023', '596204.374', '615365.118', '614301.684', '596236.679', '566572.739', '528376.14
0', '483922.370', '438020.125', '391063.182', '344702.969', '300322.255', '259299.033', '221003.357', '186649.784', '156099.963', '129867.114', '106358.800', '86624.258', '69424.546', '548
84.693', '42923.880', '33417.902', '25301.361', '19002.241', '14001.123', '10005.864', '6980.681', '4751.824', '3224.920', '2011.335', '1246.040', '726.522', '395.997', '217.499', '100.393
', '21.806', '12.644', '-1.463', '-0.061', '1.019', '2028.668']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8832810.095841985, target N: 8841303.0
Mean E: 4.2924381425370095, target E: 4.2914232732437725
INFO:test:{'loss': 302.6152506355111, 'bias_avg': 0.2701305593243082, 'bias_std': 17.386174558683205}
Working on epoch num: 32...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch32.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.76s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.59s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113548928.869, Bias: 7924.567
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15700.978', '60097.300', '147706.141', '267707.962', '389887.468', '487399.908', '554815.531', '596494.583', '615635.371', '614677.782', '596691.813', '567064.444', '528828.70
4', '484281.465', '438336.926', '391323.542', '344952.760', '300673.275', '259609.336', '221440.751', '186978.970', '156272.651', '130049.831', '106573.001', '86715.685', '69564.685', '550
40.785', '43126.789', '33419.218', '25288.471', '19014.593', '13805.457', '9753.730', '6889.365', '4724.919', '3217.355', '2073.966', '1205.032', '760.207', '398.302', '218.053', '124.798'
, '48.225', '14.154', '4.399', '-0.816', '0.418', '2016.645']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8840624.927144907, target N: 8841303.0
Mean E: 4.292426200034039, target E: 4.2914232732437725
INFO:test:{'loss': 302.1474573499374, 'bias_avg': 0.02156721217031697, 'bias_std': 17.374742068225192}
Working on epoch num: 33...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch33.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.94s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.71s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113487367.829, Bias: 69485.607
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15760.545', '60121.436', '147736.746', '267489.767', '389711.177', '487192.769', '554609.812', '595954.342', '615270.694', '614454.673', '596407.994', '566670.245', '528332.38
3', '483999.006', '437998.604', '391395.899', '344774.695', '300311.441', '259457.392', '221325.151', '186854.650', '156265.378', '129929.529', '106475.635', '86707.139', '69471.635', '549
05.039', '43018.021', '33391.065', '25237.218', '19030.060', '13861.088', '10176.380', '7073.740', '4997.009', '3233.056', '2040.612', '1295.293', '697.162', '398.274', '202.379', '94.350'
, '41.350', '13.823', '-1.015', '1.115', '1.512', '2031.050']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8836417.316356678, target N: 8841303.0
Mean E: 4.292774269426652, target E: 4.2914232732437725
INFO:test:{'loss': 302.4232508069686, 'bias_avg': 0.155397068635198, 'bias_std': 17.382052123091604}
Working on epoch num: 34...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch34.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.88s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.67s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113521421.579, Bias: 35431.857
KL dist - KL1(q=target): -2537.099, KL2(q=output): 2671.588, Symmetric: 134.489
total out: ['15739.140', '60109.954', '147804.887', '267537.953', '389810.402', '487205.906', '554892.983', '596195.884', '615397.612', '614734.683', '596542.164', '566751.414', '528859.16
1', '484212.696', '438029.377', '391427.376', '344964.477', '300473.695', '259536.116', '221448.291', '186953.321', '156303.206', '129881.987', '106483.421', '86645.773', '69462.215', '548
91.454', '43040.058', '33407.130', '25290.388', '19094.694', '13895.854', '9814.344', '6996.024', '4851.444', '3303.318', '2019.954', '1231.453', '695.473', '387.518', '198.196', '111.321'
, '30.569', '17.805', '4.736', '1.036', '1.156', '1994.396']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8838682.41579535, target N: 8841303.0
Mean E: 4.292462905295725, target E: 4.2914232732437725
INFO:test:{'loss': 302.3154336012047, 'bias_avg': 0.08335193896111641, 'bias_std': 17.379398258587788}
Working on epoch num: 35...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch35.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.78s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.60s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113530376.603, Bias: 26476.833
KL dist - KL1(q=target): -1675.606, KL2(q=output): 1865.414, Symmetric: 189.808
total out: ['15689.332', '60038.353', '147784.848', '267576.839', '389773.091', '487460.207', '554742.919', '596426.476', '615542.869', '614721.242', '596737.693', '566804.279', '528821.15
7', '484340.126', '437933.502', '391311.364', '344864.399', '300557.628', '259347.152', '221355.974', '186986.030', '156389.199', '129946.176', '106405.700', '86625.929', '69552.949', '549
18.739', '43070.389', '33405.506', '25181.437', '18933.316', '13797.368', '10007.234', '7028.955', '5077.456', '3230.870', '2120.132', '1412.510', '789.376', '407.097', '225.576', '111.038
', '39.121', '5.620', '2.074', '1.403', '2.309', '2001.798']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8839504.757475726, target N: 8841303.0
Mean E: 4.292778207854389, target E: 4.2914232732437725
INFO:test:{'loss': 302.2765106900048, 'bias_avg': 0.05719600997808325, 'bias_std': 17.378281548187022}
Working on epoch num: 36...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch36.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.74s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.61s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113458193.104, Bias: 98660.332
KL dist - KL1(q=target): -6936.115, KL2(q=output): 7061.428, Symmetric: 125.313
total out: ['15749.390', '60072.360', '147640.405', '267584.996', '389627.374', '487322.576', '554550.578', '595807.315', '615129.365', '614422.732', '596359.270', '566266.228', '528170.79
2', '483940.078', '437905.491', '391164.393', '344695.144', '300404.082', '259319.686', '221304.426', '186710.240', '156229.588', '129752.656', '106295.589', '86638.151', '69430.540', '548
72.689', '42993.794', '33407.386', '25325.023', '19119.772', '13940.097', '10104.285', '7212.209', '4838.746', '3143.764', '2043.147', '1241.698', '722.821', '420.725', '262.587', '82.644'
, '52.509', '15.776', '2.023', '1.316', '1.668', '1984.229']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8834282.350537283, target N: 8841303.0
Mean E: 4.292660473809934, target E: 4.2914232732437725
INFO:test:{'loss': 302.6051725664212, 'bias_avg': 0.22330312947280534, 'bias_std': 17.386660603530533}
Working on epoch num: 37...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch37.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.66s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.57s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113520006.808, Bias: 36846.628
KL dist - KL1(q=target): -2612.824, KL2(q=output): 2751.939, Symmetric: 139.115
total out: ['15710.757', '60053.256', '147811.068', '267515.539', '389841.484', '487191.306', '554742.127', '596234.390', '615619.503', '614439.536', '596603.890', '566919.410', '528705.86
2', '484285.034', '438267.867', '391498.156', '344814.051', '300446.733', '259439.399', '221370.750', '186846.816', '156234.125', '129984.079', '106467.957', '86704.680', '69486.723', '550
03.043', '43069.639', '33406.982', '25238.836', '19006.315', '13884.092', '9936.518', '6942.038', '4793.300', '3282.368', '1995.943', '1293.036', '783.780', '394.177', '232.202', '90.391',
 '51.073', '13.784', '1.741', '1.778', '1.570', '1938.724']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8838595.828924662, target N: 8841303.0
Mean E: 4.292597850523728, target E: 4.2914232732437725
INFO:test:{'loss': 302.09153801139075, 'bias_avg': 0.08610595237207777, 'bias_std': 17.372921636450382}
Working on epoch num: 38...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch38.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.95s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.70s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113401085.065, Bias: 155768.371
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15689.829', '59960.703', '147619.788', '267181.235', '389527.213', '486814.154', '554236.189', '595624.653', '614821.403', '614144.816', '596099.274', '566321.096', '528072.15
3', '483789.153', '437566.099', '391234.726', '344536.100', '300201.766', '259192.940', '221145.838', '186622.083', '155973.649', '129847.919', '106337.672', '86510.315', '69346.666', '548
56.875', '42975.872', '33264.058', '25228.185', '19088.310', '13885.502', '10106.154', '7107.556', '4951.375', '3237.465', '2151.960', '1342.151', '760.008', '365.236', '178.169', '91.300'
, '50.011', '4.362', '-0.554', '2.459', '2.239', '2093.774']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8830159.900539419, target N: 8841303.0
Mean E: 4.292710460966226, target E: 4.2914232732437725
INFO:test:{'loss': 303.1520845602487, 'bias_avg': 0.3544242800647066, 'bias_std': 17.400128220419848}
Working on epoch num: 39...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch39.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:15<00:15, 15.14s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.78s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113500925.496, Bias: 55927.940
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15666.153', '60124.101', '147685.042', '267565.170', '389669.897', '487300.562', '554568.136', '596240.515', '615321.785', '614530.403', '596686.714', '566714.279', '528695.17
8', '484021.945', '438175.460', '391214.985', '344782.977', '300484.728', '259291.364', '221400.719', '186946.159', '156362.710', '129966.591', '106433.929', '86718.915', '69510.049', '549
20.804', '43058.013', '33464.277', '25290.555', '19037.264', '13711.540', '9958.793', '6950.945', '4755.067', '3192.823', '2080.687', '1202.253', '666.976', '395.111', '174.854', '85.953',
 '40.873', '14.502', '-0.699', '1.161', '-0.214', '2030.224']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8837110.228447508, target N: 8841303.0
Mean E: 4.292334673743576, target E: 4.2914232732437725
INFO:test:{'loss': 302.3012242906876, 'bias_avg': 0.13335787940571325, 'bias_std': 17.378804866412214}
Working on epoch num: 4...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch4.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.72s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.59s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -108823892.050, Bias: 4732961.386
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16208.497', '62018.353', '145783.023', '265634.917', '388905.723', '485002.930', '547836.156', '589630.553', '603682.100', '601525.798', '577751.953', '548071.612', '504343.95
4', '458994.751', '416066.129', '368200.227', '322138.019', '280041.501', '238772.969', '202477.804', '170424.018', '140195.381', '116044.483', '94900.771', '78954.584', '65060.427', '5139
4.802', '38684.580', '31624.857', '22212.460', '15120.309', '12433.919', '11346.156', '6098.760', '4913.787', '2718.130', '2370.817', '1071.459', '481.726', '364.255', '-295.704', '-462.78
2', '-291.478', '-484.082', '81.143', '-116.133', '-135.717', '2362.290']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8490160.184241697, target N: 8841303.0
Mean E: 4.245513183655895, target E: 4.2914232732437725
INFO:test:{'loss': 1076.1823216096136, 'bias_avg': 11.168664271230917, 'bias_std': 30.842831583969467}
Working on epoch num: 40...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch40.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.78s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.63s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113525430.097, Bias: 31423.339
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15746.316', '60000.597', '147691.462', '267581.436', '389705.660', '487176.657', '554940.552', '596293.681', '615557.427', '614392.041', '596781.810', '566710.406', '528496.49
8', '484256.891', '438416.407', '391310.302', '344964.238', '300719.181', '259487.650', '221416.090', '187036.749', '156390.263', '129964.887', '106517.937', '86641.820', '69570.011', '549
21.368', '43018.081', '33411.345', '25278.291', '19031.364', '13849.741', '9954.370', '7132.127', '4630.974', '3227.207', '2042.717', '1227.972', '691.656', '410.637', '213.493', '88.939',
 '33.204', '11.635', '2.978', '-1.629', '-0.546', '2005.252']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8838948.145874081, target N: 8841303.0
Mean E: 4.292597006383403, target E: 4.2914232732437725
INFO:test:{'loss': 302.06595193411556, 'bias_avg': 0.07489994427630009, 'bias_std': 17.37240875477099}
Working on epoch num: 5...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch5.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in multiply
  y = A*np.exp(-1*B*x**2)
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.92s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.69s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -110473061.419, Bias: 3083792.017
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['16106.414', '61473.238', '152020.361', '273409.795', '395636.903', '490390.951', '556046.182', '592375.739', '610045.910', '605026.720', '584579.854', '552696.234', '512297.33
0', '466154.371', '418718.429', '372208.731', '327082.441', '282714.679', '243674.254', '208774.536', '175996.317', '146214.220', '121266.975', '98081.515', '78824.541', '63880.089', '5171
8.957', '39497.757', '31161.092', '23254.345', '18166.560', '12833.228', '9749.901', '6674.559', '4411.613', '3153.897', '2020.092', '1118.652', '660.678', '716.316', '-90.785', '-48.517',
 '-138.545', '4.481', '-82.952', '-71.967', '68.134', '2023.180']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8612497.405069707, target N: 8841303.0
Mean E: 4.250523118259254, target E: 4.2914232732437725
INFO:test:{'loss': 872.6343271968929, 'bias_avg': 7.277531607824428, 'bias_std': 28.626252385496183}
Working on epoch num: 6...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch6.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.69s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.58s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -111393246.990, Bias: 2163606.446
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15590.266', '61814.166', '152914.599', '274440.896', '398584.985', '494785.154', '561814.526', '597327.536', '614595.177', '608686.749', '586558.798', '556577.064', '516181.96
8', '469980.385', '423041.560', '376428.105', '330974.228', '286327.564', '246700.041', '209103.105', '176719.438', '147450.523', '121863.856', '100348.513', '80467.404', '64402.274', '512
92.590', '39849.193', '30782.753', '23836.007', '17973.799', '12601.797', '8566.078', '6947.420', '3663.465', '2784.101', '1803.556', '868.779', '668.675', '310.542', '160.382', '147.492',
 '22.074', '94.670', '9.229', '-56.539', '9.439', '2542.268']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8678556.650416732, target N: 8841303.0
Mean E: 4.249708301669742, target E: 4.2914232732437725
INFO:test:{'loss': 716.3987799491591, 'bias_avg': 5.176410424618321, 'bias_std': 26.258212070610686}
Working on epoch num: 7...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch7.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.77s/it]
/home/student1/anaconda3/lib/python3.9/site-packages/scipy/optimize/minpack.py:833: OptimizeWarning: Covariance of the parameters could not be estimated
  warnings.warn('Covariance of the parameters could not be estimated',
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.62s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -112436829.215, Bias: 1120024.221
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15749.363', '62037.864', '150912.665', '275625.828', '398414.781', '495127.780', '564400.926', '599182.716', '616405.061', '616922.027', '591269.548', '559856.378', '521026.78
7', '473865.160', '428043.952', '380615.382', '334161.978', '291023.834', '248773.408', '211688.807', '178919.879', '149692.628', '124485.562', '101855.396', '83201.004', '66590.801', '532
82.100', '41958.738', '31984.306', '23850.676', '18591.492', '13221.938', '10075.520', '8722.199', '4334.774', '2976.614', '2504.375', '1626.563', '1012.407', '538.038', '330.469', '-355.6
83', '60.609', '-13.078', '219.753', '-13.648', '188.494', '2528.218']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8757474.386973413, target N: 8841303.0
Mean E: 4.263181738413256, target E: 4.2914232732437725
INFO:test:{'loss': 571.819224862834, 'bias_avg': 2.6663044936784353, 'bias_std': 23.763081464694658}
Working on epoch num: 8...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch8.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.88s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.68s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -114339553.913, Bias: -782700.477
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15712.151', '58620.412', '144540.940', '270559.237', '395341.104', '490631.819', '559649.874', '598733.339', '616215.901', '618245.369', '598785.577', '571988.166', '531638.54
3', '485230.202', '440136.897', '392019.517', '345752.213', '301699.403', '259666.942', '223290.320', '188702.208', '158890.938', '131332.320', '110708.359', '90036.259', '72509.625', '569
24.901', '45366.981', '35578.979', '26585.787', '19757.838', '13512.521', '9114.014', '7356.153', '3934.819', '3714.725', '1880.081', '1443.958', '493.311', '574.188', '79.717', '335.192',
 '140.885', '55.888', '-159.361', '4.433', '0.681', '1951.665']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8899284.989680879, target N: 8841303.0
Mean E: 4.299323384633396, target E: 4.2914232732437725
INFO:test:{'loss': 354.6671627597954, 'bias_avg': -1.844210885317271, 'bias_std': 18.73866889312977}
Working on epoch num: 9...
==================================================
Warning: logging configuration file is not found in logger/logger_config.json.
Dataset len:  655
INFO:test:Model(
  (fc1): Linear(in_features=2688, out_features=256, bias=True)
  (fc2): Linear(in_features=256, out_features=48, bias=True)
  (conv1): Conv2d(1, 8, kernel_size=(2, 2), stride=(2, 2), padding=(1, 1))
  (conv2): Conv2d(8, 16, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1))
  (global1): AvgPool2d(kernel_size=3, stride=1, padding=1)
  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))
)
INFO:test:Loading checkpoint: saved/models/new_model/0130_065920/checkpoint-epoch9.pth ...
  0%|                                                                                                                                                                 | 0/2 [00:00<?, ?it/s]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in multiply
  y = A*np.exp(-1*B*x**2)
 50%|████████████████████████████████████████████████████████████████████████████▌                                                                            | 1/2 [00:14<00:14, 14.79s/it]
/home/student1/nir_folder/particles_repo/./test.py:21: RuntimeWarning: overflow encountered in exp
  y = A*np.exp(-1*B*x**2)
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.60s/it]
Entopies: True distribution: -113556853.436, Predicted distribution: -113285093.744, Bias: 271759.692
/home/student1/nir_folder/particles_repo/utils/my_utils.py:92: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_target[i] + 0.0000001)) for i, f in enumerate(total_out)])
/home/student1/nir_folder/particles_repo/utils/my_utils.py:94: RuntimeWarning: invalid value encountered in log
  [f * np.log((f + 0.0000001) / (total_out[i] + 0.0000001)) for i, f in enumerate(total_target)])
KL dist - KL1(q=target): nan, KL2(q=output): nan, Symmetric: nan
total out: ['15434.209', '59617.287', '148222.839', '265586.090', '387764.803', '485610.658', '550655.147', '593657.609', '613573.186', '614051.824', '596154.417', '565938.295', '529292.39
0', '485174.145', '439215.445', '392053.172', '345421.565', '301402.372', '259448.161', '221333.854', '187374.005', '155767.582', '128583.157', '105036.958', '85588.193', '68814.753', '545
20.632', '42482.058', '33116.277', '25465.290', '18715.722', '13360.825', '10941.476', '7433.608', '4767.572', '2839.935', '1872.961', '1918.341', '362.929', '416.536', '413.930', '-83.872
', '63.694', '46.109', '-37.597', '31.327', '22.964', '1720.600']
total target: ['15666.000', '60364.000', '148640.000', '269030.000', '390160.000', '487037.000', '555060.000', '597485.000', '616317.000', '612733.000', '596362.000', '566728.000', '528405
.000', '484819.000', '438737.000', '391352.000', '345192.000', '300198.000', '259545.000', '220954.000', '186694.000', '156655.000', '129706.000', '106468.000', '86795.000', '68969.000', '
54597.000', '43437.000', '33158.000', '25146.000', '18869.000', '14044.000', '10063.000', '6961.000', '4947.000', '3217.000', '2065.000', '1208.000', '711.000', '424.000', '251.000', '69.0
00', '37.000', '16.000', '2.000', '0.000', '0.000', '2010.000']
total N: 8821163.432034312, target N: 8841303.0
Mean E: 4.293902566178767, target E: 4.2914232732437725
INFO:test:{'loss': 315.9011195524958, 'bias_avg': 0.6405715592944895, 'bias_std': 17.755014014790078}
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)

tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)
tmux: /home/student1/anaconda3/lib/libtinfo.so.6: no version information available (required by tmux)










